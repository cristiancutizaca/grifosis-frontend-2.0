--
-- PostgreSQL database dump
--

\restrict zRf0ejhvhm92zEgwh5VWba3JEmlCRGB8hU9aM1cBJuXoCngChqBjukrUvbtQ0qY

-- Dumped from database version 14.19 (Ubuntu 14.19-0ubuntu0.22.04.1)
-- Dumped by pg_dump version 18.0

-- Started on 2025-11-11 12:05:15 -05

SET statement_timeout = 0;
SET lock_timeout = 0;
SET idle_in_transaction_session_timeout = 0;
SET transaction_timeout = 0;
SET client_encoding = 'UTF8';
SET standard_conforming_strings = on;
SELECT pg_catalog.set_config('search_path', '', false);
SET check_function_bodies = false;
SET xmloption = content;
SET client_min_messages = warning;
SET row_security = off;

--
-- TOC entry 6 (class 2615 OID 2200)
-- Name: public; Type: SCHEMA; Schema: -; Owner: postgres
--

-- *not* creating schema, since initdb creates it


ALTER SCHEMA public OWNER TO postgres;

--
-- TOC entry 2 (class 3079 OID 17702)
-- Name: citext; Type: EXTENSION; Schema: -; Owner: -
--

CREATE EXTENSION IF NOT EXISTS citext WITH SCHEMA public;


--
-- TOC entry 4540 (class 0 OID 0)
-- Dependencies: 2
-- Name: EXTENSION citext; Type: COMMENT; Schema: -; Owner: 
--

COMMENT ON EXTENSION citext IS 'data type for case-insensitive character strings';


--
-- TOC entry 3 (class 3079 OID 17807)
-- Name: pgcrypto; Type: EXTENSION; Schema: -; Owner: -
--

CREATE EXTENSION IF NOT EXISTS pgcrypto WITH SCHEMA public;


--
-- TOC entry 4541 (class 0 OID 0)
-- Dependencies: 3
-- Name: EXTENSION pgcrypto; Type: COMMENT; Schema: -; Owner: 
--

COMMENT ON EXTENSION pgcrypto IS 'cryptographic functions';


--
-- TOC entry 1065 (class 1247 OID 17845)
-- Name: limit_period; Type: TYPE; Schema: public; Owner: postgres
--

CREATE TYPE public.limit_period AS ENUM (
    'day',
    'week',
    'month',
    'custom'
);


ALTER TYPE public.limit_period OWNER TO postgres;

--
-- TOC entry 1068 (class 1247 OID 17854)
-- Name: payment_status; Type: TYPE; Schema: public; Owner: postgres
--

CREATE TYPE public.payment_status AS ENUM (
    'PENDING',
    'PAID',
    'PARTIAL',
    'CANCELLED'
);


ALTER TYPE public.payment_status OWNER TO postgres;

--
-- TOC entry 1071 (class 1247 OID 17864)
-- Name: purchase_line_type; Type: TYPE; Schema: public; Owner: postgres
--

CREATE TYPE public.purchase_line_type AS ENUM (
    'HEADER',
    'ITEM'
);


ALTER TYPE public.purchase_line_type OWNER TO postgres;

--
-- TOC entry 1074 (class 1247 OID 17870)
-- Name: sale_payment_mode; Type: TYPE; Schema: public; Owner: postgres
--

CREATE TYPE public.sale_payment_mode AS ENUM (
    'contado',
    'credito'
);


ALTER TYPE public.sale_payment_mode OWNER TO postgres;

--
-- TOC entry 408 (class 1255 OID 17875)
-- Name: _period_bounds(text, timestamp without time zone); Type: FUNCTION; Schema: public; Owner: postgres
--

CREATE FUNCTION public._period_bounds(period_kind text, ref_ts timestamp without time zone) RETURNS TABLE(start_ts timestamp without time zone, end_ts timestamp without time zone)
    LANGUAGE sql
    AS $$
  SELECT
    CASE
      WHEN lower(period_kind)='day'         THEN date_trunc('day',   ref_ts)
      WHEN lower(period_kind)='week'        THEN date_trunc('week',  ref_ts)
      WHEN lower(period_kind)='month'       THEN date_trunc('month', ref_ts)
      WHEN lower(period_kind)='rolling_30d' THEN ref_ts - INTERVAL '30 days'
      ELSE date_trunc('month', ref_ts)
    END AS start_ts,
    CASE
      WHEN lower(period_kind)='day'         THEN date_trunc('day',   ref_ts) + INTERVAL '1 day'
      WHEN lower(period_kind)='week'        THEN date_trunc('week',  ref_ts) + INTERVAL '1 week'
      WHEN lower(period_kind)='month'       THEN date_trunc('month', ref_ts) + INTERVAL '1 month'
      WHEN lower(period_kind)='rolling_30d' THEN ref_ts
      ELSE date_trunc('month', ref_ts) + INTERVAL '1 month'
    END AS end_ts;
$$;


ALTER FUNCTION public._period_bounds(period_kind text, ref_ts timestamp without time zone) OWNER TO postgres;

--
-- TOC entry 409 (class 1255 OID 17876)
-- Name: _ping(); Type: FUNCTION; Schema: public; Owner: postgres
--

CREATE FUNCTION public._ping() RETURNS integer
    LANGUAGE plpgsql
    AS $$
BEGIN
  RETURN 1;
END
$$;


ALTER FUNCTION public._ping() OWNER TO postgres;

--
-- TOC entry 410 (class 1255 OID 17877)
-- Name: allocate_landed_cost(bigint, numeric, text); Type: FUNCTION; Schema: public; Owner: postgres
--

CREATE FUNCTION public.allocate_landed_cost(p_purchase_id bigint, p_total_cost numeric, p_method text) RETURNS bigint
    LANGUAGE plpgsql
    AS $$
DECLARE
  v_allocation_id BIGINT;
  v_sum_weight NUMERIC(18,6);
  v_last_line BIGINT;
  v_left NUMERIC(14,4);
BEGIN
  IF p_total_cost <= 0 THEN
    RAISE EXCEPTION 'El total de landed cost debe ser > 0';
  END IF;

  -- 1) Crear cabecera
  INSERT INTO landed_cost_allocations (purchase_id, total_cost, method)
  VALUES (p_purchase_id, p_total_cost, UPPER(p_method))
  RETURNING allocation_id INTO v_allocation_id;

  -- 2) Calcular pesos según método
  IF UPPER(p_method) = 'BY_VALUE' THEN
    SELECT COALESCE(SUM(
             COALESCE(subtotal_item, (COALESCE(quantity,0)*COALESCE(unit_cost,0) - COALESCE(line_discount,0)))
           ),0)
      INTO v_sum_weight
    FROM purchase_lines
    WHERE purchase_id = p_purchase_id AND line_type='ITEM';

  ELSIF UPPER(p_method) IN ('BY_QTY','BY_VOLUME') THEN
    SELECT COALESCE(SUM(COALESCE(quantity,0)),0)
      INTO v_sum_weight
    FROM purchase_lines
    WHERE purchase_id = p_purchase_id AND line_type='ITEM';

  ELSE
    RAISE EXCEPTION 'Método inválido: %. Use BY_VALUE, BY_QTY o BY_VOLUME', p_method;
  END IF;

  IF v_sum_weight <= 0 THEN
    RAISE EXCEPTION 'No hay base para prorratear (suma de pesos = 0)';
  END IF;

  v_left := p_total_cost;

  -- 3) Insertar líneas con redondeo y actualizar landed_cost
  FOR v_last_line IN
    SELECT line_id
    FROM purchase_lines
    WHERE purchase_id = p_purchase_id AND line_type='ITEM'
    ORDER BY line_id
  LOOP
    DECLARE
      v_weight NUMERIC(18,6);
      v_alloc  NUMERIC(14,4);
    BEGIN
      IF UPPER(p_method) = 'BY_VALUE' THEN
        SELECT COALESCE(subtotal_item,(COALESCE(quantity,0)*COALESCE(unit_cost,0) - COALESCE(line_discount,0)))
          INTO v_weight
        FROM purchase_lines WHERE line_id = v_last_line;
      ELSE
        SELECT COALESCE(quantity,0) INTO v_weight
        FROM purchase_lines WHERE line_id = v_last_line;
      END IF;

      IF v_weight IS NULL OR v_weight = 0 THEN
        v_alloc := 0;
      ELSE
        v_alloc := ROUND( (p_total_cost * (v_weight / v_sum_weight))::numeric, 4);
      END IF;

      -- Ajuste en el último ítem para cuadrar con p_total_cost
      IF (SELECT COUNT(*) FROM landed_cost_allocation_lines WHERE allocation_id = v_allocation_id) =
         (SELECT GREATEST(COUNT(*) - 1, 0)
          FROM purchase_lines WHERE purchase_id = p_purchase_id AND line_type='ITEM') THEN
        v_alloc := ROUND(v_left, 4);
      END IF;

      INSERT INTO landed_cost_allocation_lines (allocation_id, line_id, allocated_amount)
      VALUES (v_allocation_id, v_last_line, v_alloc);

      UPDATE purchase_lines
         SET landed_cost = COALESCE(landed_cost,0) + v_alloc
       WHERE line_id = v_last_line;

      v_left := v_left - v_alloc;
    END;
  END LOOP;

  RETURN v_allocation_id;
END $$;


ALTER FUNCTION public.allocate_landed_cost(p_purchase_id bigint, p_total_cost numeric, p_method text) OWNER TO postgres;

--
-- TOC entry 411 (class 1255 OID 17878)
-- Name: auth_login(text, text); Type: FUNCTION; Schema: public; Owner: postgres
--

CREATE FUNCTION public.auth_login(p_username text, p_password text) RETURNS TABLE(user_id integer, username text, role text, employee_id integer, token_version integer)
    LANGUAGE plpgsql
    AS $$
DECLARE
  u public.users%ROWTYPE;
BEGIN
  -- 1️⃣ Buscar usuario (ignorando mayúsculas)
  SELECT * INTO u
  FROM public.users
  WHERE lower(username) = lower(p_username);

  IF NOT FOUND THEN
    RAISE EXCEPTION 'INVALID_CREDENTIALS' USING ERRCODE='P0001';
  END IF;

  -- 2️⃣ Verificar si está activo
  IF u.is_active IS DISTINCT FROM true THEN
    RAISE EXCEPTION 'ACCOUNT_INACTIVE' USING ERRCODE='P0002';
  END IF;

  -- 3️⃣ Verificar contraseña (usa bcrypt del pgcrypto)
  IF crypt(p_password, u.password_hash) <> u.password_hash THEN
    RAISE EXCEPTION 'INVALID_CREDENTIALS' USING ERRCODE='P0001';
  END IF;

  -- 4️⃣ Retornar los datos mínimos
  RETURN QUERY
  SELECT u.user_id, u.username, u.role, u.employee_id, u.token_version;
END
$$;


ALTER FUNCTION public.auth_login(p_username text, p_password text) OWNER TO postgres;

--
-- TOC entry 412 (class 1255 OID 17879)
-- Name: can_create_user_role(character varying, character varying); Type: FUNCTION; Schema: public; Owner: postgres
--

CREATE FUNCTION public.can_create_user_role(creator_role character varying, target_role character varying) RETURNS boolean
    LANGUAGE plpgsql
    AS $$
BEGIN
    -- Superadmin puede crear cualquier rol
    IF creator_role = 'superadmin' THEN
        RETURN TRUE;
    END IF;
    
    -- Admin puede crear admin y seller, pero no superadmin
    IF creator_role = 'admin' THEN
        RETURN target_role IN ('admin', 'seller');
    END IF;
    
    -- Seller no puede crear usuarios
    IF creator_role = 'seller' THEN
        RETURN FALSE;
    END IF;
    
    RETURN FALSE;
END;
$$;


ALTER FUNCTION public.can_create_user_role(creator_role character varying, target_role character varying) OWNER TO postgres;

--
-- TOC entry 413 (class 1255 OID 17880)
-- Name: can_manage_user(character varying, integer, character varying, integer); Type: FUNCTION; Schema: public; Owner: postgres
--

CREATE FUNCTION public.can_manage_user(manager_role character varying, manager_id integer, target_role character varying, target_id integer) RETURNS boolean
    LANGUAGE plpgsql
    AS $$
BEGIN
    -- Un usuario no puede gestionarse a sí mismo para cambios de rol
    IF manager_id = target_id THEN
        RETURN FALSE;
    END IF;
    
    -- Superadmin puede gestionar cualquier usuario
    IF manager_role = 'superadmin' THEN
        RETURN TRUE;
    END IF;
    
    -- Admin puede gestionar admin y seller, pero no superadmin
    IF manager_role = 'admin' THEN
        RETURN target_role IN ('admin', 'seller');
    END IF;
    
    -- Seller no puede gestionar usuarios
    RETURN FALSE;
END;
$$;


ALTER FUNCTION public.can_manage_user(manager_role character varying, manager_id integer, target_role character varying, target_id integer) OWNER TO postgres;

--
-- TOC entry 414 (class 1255 OID 17881)
-- Name: enforce_client_product_gallon_limit(); Type: FUNCTION; Schema: public; Owner: postgres
--

CREATE FUNCTION public.enforce_client_product_gallon_limit() RETURNS trigger
    LANGUAGE plpgsql
    AS $$
DECLARE
  v_client_id   INT;
  v_sale_ts     TIMESTAMP;
  v_period      TEXT;
  v_max_gal     NUMERIC(12,3);
  v_all_pmts    BOOLEAN;
  v_start       TIMESTAMP;
  v_end         TIMESTAMP;
  v_total_gal   NUMERIC(20,3);
BEGIN
  -- Traer cabecera de la venta
  SELECT s.client_id, s.sale_timestamp
    INTO v_client_id, v_sale_ts
  FROM public.sales s
  WHERE s.sale_id = NEW.sale_id;

  IF v_client_id IS NULL THEN
    RETURN NEW;
  END IF;

  -- ¿Existe un límite activo para este cliente y ESTE producto?
  SELECT period_kind, max_gallons, apply_to_all_payments
    INTO v_period, v_max_gal, v_all_pmts
  FROM public.client_product_gallon_limits
  WHERE client_id = v_client_id
    AND product_id = NEW.product_id
    AND is_active = TRUE
  ORDER BY created_at DESC
  LIMIT 1;

  -- Si no hay límite configurado para este cliente+producto, no bloqueamos
  IF v_max_gal IS NULL THEN
    RETURN NEW;
  END IF;

  -- Rango del periodo (mes por defecto)
  SELECT start_ts, end_ts INTO v_start, v_end
  FROM public._period_bounds(v_period, v_sale_ts);

  -- Sumar galones del periodo (incluyendo esta fila)
  IF v_all_pmts THEN
    -- Aplica a TODAS las formas de pago
    SELECT COALESCE(SUM(sd.quantity), 0)
      INTO v_total_gal
    FROM public.sale_details sd
    JOIN public.sales s ON s.sale_id = sd.sale_id
    WHERE s.client_id = v_client_id
      AND sd.product_id = NEW.product_id
      AND s.sale_timestamp >= v_start
      AND s.sale_timestamp <  v_end;
  ELSE
    -- Solo a ventas a CRÉDITO (requiere pm.is_credit = TRUE)
    SELECT COALESCE(SUM(sd.quantity), 0)
      INTO v_total_gal
    FROM public.sale_details sd
    JOIN public.sales s ON s.sale_id = sd.sale_id
    JOIN public.payment_methods pm ON pm.payment_method_id = s.payment_method_id
    WHERE s.client_id = v_client_id
      AND sd.product_id = NEW.product_id
      AND s.sale_timestamp >= v_start
      AND s.sale_timestamp <  v_end
      AND pm.is_credit = TRUE;
  END IF;

  -- Validación (permite llegar al tope; bloquea si lo EXCEDE)
  IF v_total_gal > v_max_gal THEN
    RAISE EXCEPTION
      'Límite de %.3f gal excedido para cliente % en % (producto %, %.3f gal consumidos).',
      v_max_gal, v_client_id, v_period, NEW.product_id, v_total_gal
      USING ERRCODE = 'check_violation';
  END IF;

  RETURN NEW;
END
$$;


ALTER FUNCTION public.enforce_client_product_gallon_limit() OWNER TO postgres;

--
-- TOC entry 415 (class 1255 OID 17882)
-- Name: enforce_company_is_empresa(); Type: FUNCTION; Schema: public; Owner: postgres
--

CREATE FUNCTION public.enforce_company_is_empresa() RETURNS trigger
    LANGUAGE plpgsql
    AS $$
DECLARE
  v_type text;
BEGIN
  -- lee solo client_type y pásalo a minúsculas
  SELECT lower(c.client_type::text)
    INTO v_type
  FROM public.clients c
  WHERE c.client_id = NEW.company_id;

  IF v_type IS NULL THEN
    RAISE EXCEPTION 'company_id % no existe en clients', NEW.company_id
      USING ERRCODE = 'foreign_key_violation';
  END IF;

  IF v_type <> 'empresa' THEN
    RAISE EXCEPTION 'company_id % no es de tipo empresa (client_type=%)', NEW.company_id, v_type
      USING ERRCODE = 'check_violation';
  END IF;

  RETURN NEW;
END
$$;


ALTER FUNCTION public.enforce_company_is_empresa() OWNER TO postgres;

--
-- TOC entry 417 (class 1255 OID 17883)
-- Name: enforce_credit_driver_company(); Type: FUNCTION; Schema: public; Owner: postgres
--

CREATE FUNCTION public.enforce_credit_driver_company() RETURNS trigger
    LANGUAGE plpgsql
    AS $$
DECLARE v_company_id int;
BEGIN
  IF NEW.driver_id IS NULL THEN
    RETURN NEW;
  END IF;

  SELECT company_id INTO v_company_id
  FROM public.client_drivers
  WHERE driver_id = NEW.driver_id;

  IF v_company_id IS NULL THEN
    RAISE EXCEPTION 'driver_id % no existe', NEW.driver_id
      USING ERRCODE='foreign_key_violation';
  END IF;

  -- Si no viene client_id, lo completamos con la empresa del driver
  IF NEW.client_id IS NULL THEN
    NEW.client_id := v_company_id;
  ELSIF NEW.client_id <> v_company_id THEN
    RAISE EXCEPTION 'El driver % pertenece a empresa %, pero el crédito está asignado a empresa %',
      NEW.driver_id, v_company_id, NEW.client_id
      USING ERRCODE='check_violation';
  END IF;

  RETURN NEW;
END $$;


ALTER FUNCTION public.enforce_credit_driver_company() OWNER TO postgres;

--
-- TOC entry 418 (class 1255 OID 17884)
-- Name: enforce_credit_gallon_limit(); Type: FUNCTION; Schema: public; Owner: postgres
--

CREATE FUNCTION public.enforce_credit_gallon_limit() RETURNS trigger
    LANGUAGE plpgsql
    AS $$
DECLARE
  v_client_id   INT;
  v_sale_ts     TIMESTAMP;
  v_period      TEXT;
  v_max_gal     NUMERIC(12,3);
  v_start       TIMESTAMP;
  v_end         TIMESTAMP;
  v_total_gal   NUMERIC(20,3);
  v_is_credit   BOOLEAN := FALSE;
BEGIN
  SELECT s.client_id, s.sale_timestamp
    INTO v_client_id, v_sale_ts
  FROM public.sales s
  WHERE s.sale_id = NEW.sale_id;

  IF v_client_id IS NULL THEN
    RETURN NEW;
  END IF;

  -- Detectar crédito por flag
  SELECT EXISTS(
           SELECT 1
           FROM public.sales s
           JOIN public.payment_methods pm ON pm.payment_method_id = s.payment_method_id
           WHERE s.sale_id = NEW.sale_id
             AND pm.is_credit = TRUE
         )
    INTO v_is_credit;

  IF NOT v_is_credit THEN
    RETURN NEW;
  END IF;

  SELECT period_kind, max_gallons
    INTO v_period, v_max_gal
  FROM public.client_credit_limits
  WHERE client_id = v_client_id AND is_active = TRUE
  ORDER BY created_at DESC
  LIMIT 1;

  IF v_max_gal IS NULL THEN
    RETURN NEW;
  END IF;

  SELECT start_ts, end_ts INTO v_start, v_end
  FROM public._period_bounds(v_period, v_sale_ts);

  SELECT COALESCE(SUM(sd.quantity), 0)
    INTO v_total_gal
  FROM public.sale_details sd
  JOIN public.sales s  ON s.sale_id = sd.sale_id
  JOIN public.payment_methods pm ON pm.payment_method_id = s.payment_method_id
  WHERE s.client_id = v_client_id
    AND s.sale_timestamp >= v_start
    AND s.sale_timestamp <  v_end
    AND pm.is_credit = TRUE;

  IF v_total_gal > v_max_gal THEN
    RAISE EXCEPTION
      'Límite de %.3f gal excedido para cliente % en % (%.3f gal).',
      v_max_gal, v_client_id, v_period, v_total_gal
      USING ERRCODE = 'check_violation';
  END IF;

  RETURN NEW;
END
$$;


ALTER FUNCTION public.enforce_credit_gallon_limit() OWNER TO postgres;

--
-- TOC entry 419 (class 1255 OID 17885)
-- Name: enforce_credit_payment_limits(); Type: FUNCTION; Schema: public; Owner: postgres
--

CREATE FUNCTION public.enforce_credit_payment_limits() RETURNS trigger
    LANGUAGE plpgsql
    AS $$
DECLARE v_remaining numeric(10,2);
BEGIN
  IF NEW.credit_id IS NOT NULL THEN
    SELECT credit_amount - amount_paid
      INTO v_remaining
      FROM credits
     WHERE credit_id = NEW.credit_id
     FOR UPDATE;

    IF NEW.amount > v_remaining THEN
      RAISE EXCEPTION 'El pago (%.2f) excede la deuda restante (%.2f) del crédito %',
        NEW.amount, v_remaining, NEW.credit_id;
    END IF;

    UPDATE credits
       SET amount_paid = amount_paid + NEW.amount,
           status = CASE
             WHEN amount_paid + NEW.amount >= credit_amount THEN 'paid'
             WHEN due_date < CURRENT_DATE THEN 'overdue'
             ELSE 'pending'
           END,
           updated_at = now()
     WHERE credit_id = NEW.credit_id;
  END IF;
  RETURN NEW;
END; $$;


ALTER FUNCTION public.enforce_credit_payment_limits() OWNER TO postgres;

--
-- TOC entry 420 (class 1255 OID 17886)
-- Name: enforce_sale_driver_company(); Type: FUNCTION; Schema: public; Owner: postgres
--

CREATE FUNCTION public.enforce_sale_driver_company() RETURNS trigger
    LANGUAGE plpgsql
    AS $$
DECLARE
  v_driver_client integer;
BEGIN
  IF NEW.driver_id IS NULL THEN
    RETURN NEW;
  END IF;

  SELECT company_id INTO v_driver_client
  FROM public.client_drivers
  WHERE driver_id = NEW.driver_id;

  IF v_driver_client IS NULL OR v_driver_client <> NEW.client_id THEN
    RAISE EXCEPTION 'El driver % no pertenece al cliente % de la venta',
      NEW.driver_id, NEW.client_id;
  END IF;

  RETURN NEW;
END;
$$;


ALTER FUNCTION public.enforce_sale_driver_company() OWNER TO postgres;

--
-- TOC entry 421 (class 1255 OID 17887)
-- Name: enforce_username_lower(); Type: FUNCTION; Schema: public; Owner: postgres
--

CREATE FUNCTION public.enforce_username_lower() RETURNS trigger
    LANGUAGE plpgsql
    AS $$
BEGIN
  IF NEW.username IS NOT NULL THEN
    NEW.username := lower(NEW.username);
  END IF;
  RETURN NEW;
END$$;


ALTER FUNCTION public.enforce_username_lower() OWNER TO postgres;

--
-- TOC entry 422 (class 1255 OID 17888)
-- Name: ensure_sector_driver_company_match(); Type: FUNCTION; Schema: public; Owner: postgres
--

CREATE FUNCTION public.ensure_sector_driver_company_match() RETURNS trigger
    LANGUAGE plpgsql
    AS $$
DECLARE
  v_sector_client  integer;
  v_driver_client  integer;
  v_exists         boolean;
BEGIN
  -- Solo aplicar si hay sector_id
  IF NEW.sector_id IS NULL THEN
    RETURN NEW;
  END IF;

  -- Cliente del sector
  SELECT client_id INTO v_sector_client
  FROM public.sectors
  WHERE sector_id = NEW.sector_id;

  -- Cliente del driver (empresa/municipio dueña del conductor)
  v_driver_client := NEW.company_id;

  IF v_sector_client IS NULL THEN
    RAISE EXCEPTION 'Sector % no existe', NEW.sector_id;
  END IF;

  IF v_sector_client <> v_driver_client THEN
    RAISE EXCEPTION 'El sector (%) pertenece al cliente %, pero el driver pertenece al cliente %',
      NEW.sector_id, v_sector_client, v_driver_client;
  END IF;

  -- Auto-asociar al sector si no existe vínculo activo
  SELECT TRUE INTO v_exists
  FROM public.sector_drivers sd
  WHERE sd.sector_id = NEW.sector_id
    AND sd.driver_id = NEW.driver_id
    AND sd.end_date IS NULL
  LIMIT 1;

  IF NOT v_exists THEN
    INSERT INTO public.sector_drivers (sector_id, driver_id, start_date, end_date)
    VALUES (NEW.sector_id, NEW.driver_id, CURRENT_DATE, NULL);
  END IF;

  RETURN NEW;
END;
$$;


ALTER FUNCTION public.ensure_sector_driver_company_match() OWNER TO postgres;

--
-- TOC entry 423 (class 1255 OID 17889)
-- Name: ensure_sector_matches_sale_client(); Type: FUNCTION; Schema: public; Owner: postgres
--

CREATE FUNCTION public.ensure_sector_matches_sale_client() RETURNS trigger
    LANGUAGE plpgsql
    AS $$
DECLARE
  v_sector_client integer;
BEGIN
  IF NEW.sector_id IS NULL THEN
    RETURN NEW;
  END IF;

  SELECT client_id INTO v_sector_client
  FROM public.sectors
  WHERE sector_id = NEW.sector_id;

  IF v_sector_client IS NULL OR v_sector_client <> NEW.client_id THEN
    RAISE EXCEPTION 'El sector % no pertenece al cliente % de la venta',
      NEW.sector_id, NEW.client_id;
  END IF;

  RETURN NEW;
END;
$$;


ALTER FUNCTION public.ensure_sector_matches_sale_client() OWNER TO postgres;

--
-- TOC entry 424 (class 1255 OID 17890)
-- Name: fn_effective_product_rule(integer, integer, integer, integer); Type: FUNCTION; Schema: public; Owner: postgres
--

CREATE FUNCTION public.fn_effective_product_rule(p_client_id integer, p_sector_id integer, p_driver_id integer, p_product_id integer) RETURNS TABLE(level_text text, has_whitelist boolean, is_allowed boolean, qty_limit numeric, period public.limit_period, window_days integer)
    LANGUAGE plpgsql
    AS $$
DECLARE
  v_has_rules boolean;
BEGIN
  -- DRIVER
  IF p_driver_id IS NOT NULL THEN
    SELECT EXISTS(
      SELECT 1 FROM public.driver_product_rules
      WHERE driver_id = p_driver_id AND is_active = true
    ) INTO v_has_rules;

    IF v_has_rules THEN
      RETURN QUERY
      SELECT 'driver'::text, true,
             COALESCE( (SELECT is_allowed FROM public.driver_product_rules
                        WHERE driver_id=p_driver_id AND product_id=p_product_id AND is_active=true
                        ORDER BY rule_id DESC LIMIT 1), false) AS is_allowed,
             (SELECT qty_limit FROM public.driver_product_rules
               WHERE driver_id=p_driver_id AND product_id=p_product_id AND is_active=true
               ORDER BY rule_id DESC LIMIT 1) AS qty_limit,
             (SELECT period FROM public.driver_product_rules
               WHERE driver_id=p_driver_id AND product_id=p_product_id AND is_active=true
               ORDER BY rule_id DESC LIMIT 1) AS period,
             (SELECT window_days FROM public.driver_product_rules
               WHERE driver_id=p_driver_id AND product_id=p_product_id AND is_active=true
               ORDER BY rule_id DESC LIMIT 1) AS window_days;
      RETURN;
    END IF;
  END IF;

  -- SECTOR
  IF p_sector_id IS NOT NULL THEN
    SELECT EXISTS(
      SELECT 1 FROM public.sector_product_rules
      WHERE sector_id = p_sector_id AND is_active = true
    ) INTO v_has_rules;

    IF v_has_rules THEN
      RETURN QUERY
      SELECT 'sector'::text, true,
             COALESCE( (SELECT is_allowed FROM public.sector_product_rules
                        WHERE sector_id=p_sector_id AND product_id=p_product_id AND is_active=true
                        ORDER BY rule_id DESC LIMIT 1), false),
             (SELECT qty_limit FROM public.sector_product_rules
               WHERE sector_id=p_sector_id AND product_id=p_product_id AND is_active=true
               ORDER BY rule_id DESC LIMIT 1),
             (SELECT period FROM public.sector_product_rules
               WHERE sector_id=p_sector_id AND product_id=p_product_id AND is_active=true
               ORDER BY rule_id DESC LIMIT 1),
             (SELECT window_days FROM public.sector_product_rules
               WHERE sector_id=p_sector_id AND product_id=p_product_id AND is_active=true
               ORDER BY rule_id DESC LIMIT 1);
      RETURN;
    END IF;
  END IF;

  -- CLIENTE
  SELECT EXISTS(
    SELECT 1 FROM public.client_product_rules
    WHERE client_id = p_client_id AND is_active = true
  ) INTO v_has_rules;

  IF v_has_rules THEN
    RETURN QUERY
    SELECT 'client'::text, true,
           COALESCE( (SELECT is_allowed FROM public.client_product_rules
                      WHERE client_id=p_client_id AND product_id=p_product_id AND is_active=true
                      ORDER BY rule_id DESC LIMIT 1), false),
           (SELECT qty_limit FROM public.client_product_rules
             WHERE client_id=p_client_id AND product_id=p_product_id AND is_active=true
             ORDER BY rule_id DESC LIMIT 1),
           (SELECT period FROM public.client_product_rules
             WHERE client_id=p_client_id AND product_id=p_product_id AND is_active=true
             ORDER BY rule_id DESC LIMIT 1),
           (SELECT window_days FROM public.client_product_rules
             WHERE client_id=p_client_id AND product_id=p_product_id AND is_active=true
             ORDER BY rule_id DESC LIMIT 1);
    RETURN;
  END IF;

  -- Sin reglas en ningún nivel → permitido, sin tope
  RETURN QUERY SELECT 'none'::text, false, true, NULL::numeric, NULL::limit_period, NULL::integer;
END $$;


ALTER FUNCTION public.fn_effective_product_rule(p_client_id integer, p_sector_id integer, p_driver_id integer, p_product_id integer) OWNER TO postgres;

--
-- TOC entry 425 (class 1255 OID 17891)
-- Name: fn_enforce_product_rules_on_sale_details(); Type: FUNCTION; Schema: public; Owner: postgres
--

CREATE FUNCTION public.fn_enforce_product_rules_on_sale_details() RETURNS trigger
    LANGUAGE plpgsql
    AS $$
DECLARE
  v_client_id  integer;
  v_sector_id  integer;
  v_driver_id  integer;
  v_sale_ts    timestamptz;

  v_level      text;
  v_whitelist  boolean;
  v_allowed    boolean;
  v_qty_limit  numeric(14,3);
  v_period     limit_period;
  v_days       integer;

  v_from       timestamptz;
  v_to         timestamptz;
  v_consumed   numeric(14,3);
  v_in_this_sale numeric(14,3);
BEGIN
  -- Traer cabecera de la venta
  SELECT client_id, sector_id, driver_id, sale_timestamp
    INTO v_client_id, v_sector_id, v_driver_id, v_sale_ts
  FROM public.sales WHERE sale_id = NEW.sale_id;

  IF v_client_id IS NULL THEN
    RAISE EXCEPTION 'La venta % no tiene client_id', NEW.sale_id;
  END IF;

  -- Regla efectiva
  SELECT level_text, has_whitelist, is_allowed, qty_limit, period, window_days
    INTO v_level, v_whitelist, v_allowed, v_qty_limit, v_period, v_days
  FROM public.fn_effective_product_rule(v_client_id, v_sector_id, v_driver_id, NEW.product_id);

  -- Si hay whitelist y no está permitido → bloqueo
  IF v_whitelist AND NOT v_allowed THEN
    RAISE EXCEPTION 'Producto % no permitido por reglas de % (venta %, cliente %, sector %, driver %)',
      NEW.product_id, v_level, NEW.sale_id, v_client_id, COALESCE(v_sector_id,0), COALESCE(v_driver_id,0);
  END IF;

  -- Si hay límite, calculemos ventana y consumos
  IF v_qty_limit IS NOT NULL THEN
    v_from := public.fn_limit_window_start(v_sale_ts, COALESCE(v_period,'month'), COALESCE(v_days,0));
    v_to   := CASE WHEN v_period='day'   THEN v_from + interval '1 day'
                   WHEN v_period='week'  THEN v_from + interval '1 week'
                   WHEN v_period='month' THEN v_from + interval '1 month'
                   WHEN v_period='custom' THEN v_sale_ts -- ventana deslizante de N días hasta ahora
                   ELSE v_from + interval '1 month'
             END;

    -- consumo histórico en ventana
    v_consumed := public.fn_qty_consumed_in_window(v_client_id, v_sector_id, v_driver_id, NEW.product_id, v_from, v_to);

    -- consumo en esta misma venta (otras líneas ya insertadas del mismo sale/producto)
    SELECT COALESCE(SUM(quantity),0)
      INTO v_in_this_sale
    FROM public.sale_details
    WHERE sale_id = NEW.sale_id
      AND product_id = NEW.product_id
      AND (TG_OP='UPDATE' AND sale_detail_id <> NEW.sale_detail_id OR TG_OP<>'UPDATE');

    -- total si aceptamos este row
    IF (v_consumed + v_in_this_sale + NEW.quantity) > v_qty_limit THEN
      RAISE EXCEPTION 'Cupo excedido: producto %, límite %, consumido %, intento agregar % (venta %, scope %/%/%)',
        NEW.product_id, v_qty_limit, v_consumed + v_in_this_sale, NEW.quantity, NEW.sale_id,
        v_client_id, COALESCE(v_sector_id,0), COALESCE(v_driver_id,0);
    END IF;
  END IF;

  RETURN NEW;
END $$;


ALTER FUNCTION public.fn_enforce_product_rules_on_sale_details() OWNER TO postgres;

--
-- TOC entry 426 (class 1255 OID 17892)
-- Name: fn_limit_window_start(timestamp with time zone, public.limit_period, integer); Type: FUNCTION; Schema: public; Owner: postgres
--

CREATE FUNCTION public.fn_limit_window_start(ts timestamp with time zone, p_period public.limit_period, p_window_days integer) RETURNS timestamp with time zone
    LANGUAGE sql IMMUTABLE
    AS $$
  SELECT CASE
    WHEN p_period = 'day'   THEN date_trunc('day',   ts)
    WHEN p_period = 'week'  THEN date_trunc('week',  ts)     -- semana ISO (lunes)
    WHEN p_period = 'month' THEN date_trunc('month', ts)
    WHEN p_period = 'custom' THEN ts - make_interval(days => GREATEST(p_window_days,1))
    ELSE date_trunc('month', ts)
  END
$$;


ALTER FUNCTION public.fn_limit_window_start(ts timestamp with time zone, p_period public.limit_period, p_window_days integer) OWNER TO postgres;

--
-- TOC entry 427 (class 1255 OID 17893)
-- Name: fn_payments_apply_to_credit(); Type: FUNCTION; Schema: public; Owner: postgres
--

CREATE FUNCTION public.fn_payments_apply_to_credit() RETURNS trigger
    LANGUAGE plpgsql
    AS $$
DECLARE
  v_balance numeric(14,2);
BEGIN
  SELECT balance INTO v_balance FROM public.credits WHERE credit_id = NEW.credit_id FOR UPDATE;

  IF v_balance IS NULL THEN
    RAISE EXCEPTION 'Crédito % no existe', NEW.credit_id;
  END IF;

  IF NEW.amount > v_balance THEN
    RAISE EXCEPTION 'Pago % excede el saldo % del crédito %', NEW.amount, v_balance, NEW.credit_id;
  END IF;

  UPDATE public.credits
  SET balance = balance - NEW.amount,
      status  = CASE WHEN balance - NEW.amount > 0 THEN status ELSE 'closed' END
  WHERE credit_id = NEW.credit_id;

  RETURN NEW;
END $$;


ALTER FUNCTION public.fn_payments_apply_to_credit() OWNER TO postgres;

--
-- TOC entry 428 (class 1255 OID 17894)
-- Name: fn_qty_consumed_in_window(integer, integer, integer, integer, timestamp with time zone, timestamp with time zone); Type: FUNCTION; Schema: public; Owner: postgres
--

CREATE FUNCTION public.fn_qty_consumed_in_window(p_client_id integer, p_sector_id integer, p_driver_id integer, p_product_id integer, p_from timestamp with time zone, p_to timestamp with time zone) RETURNS numeric
    LANGUAGE sql STABLE
    AS $$
  WITH base AS (
    SELECT s.sale_id, s.client_id, s.sector_id, s.driver_id, s.sale_timestamp
    FROM public.sales s
    WHERE s.sale_timestamp >= p_from
      AND s.sale_timestamp <  p_to
      AND s.client_id = p_client_id
      AND ( (p_sector_id IS NULL AND s.sector_id IS NULL) OR s.sector_id = p_sector_id )
      AND ( (p_driver_id IS NULL AND s.driver_id IS NULL) OR s.driver_id = p_driver_id )
  )
  SELECT COALESCE(SUM(d.quantity), 0)
  FROM base b
  JOIN public.sale_details d ON d.sale_id = b.sale_id
  WHERE d.product_id = p_product_id;
$$;


ALTER FUNCTION public.fn_qty_consumed_in_window(p_client_id integer, p_sector_id integer, p_driver_id integer, p_product_id integer, p_from timestamp with time zone, p_to timestamp with time zone) OWNER TO postgres;

--
-- TOC entry 429 (class 1255 OID 17895)
-- Name: fn_sales_auto_create_credit(); Type: FUNCTION; Schema: public; Owner: postgres
--

CREATE FUNCTION public.fn_sales_auto_create_credit() RETURNS trigger
    LANGUAGE plpgsql
    AS $$
DECLARE
  v_credit_id bigint;
  v_total numeric(14,2);
  v_exists bigint;
BEGIN
  IF NEW.payment_mode <> 'credito' THEN
    RETURN NEW;
  END IF;

  -- ¿Ya existe crédito para esta venta? (sale_id único en credits)
  SELECT credit_id INTO v_exists FROM public.credits WHERE sale_id = NEW.sale_id;
  IF v_exists IS NOT NULL THEN
    RETURN NEW;
  END IF;

  -- Sumar total de la venta (si ya tienes sales.total_amount, úsalo)
  IF NEW.total_amount IS NOT NULL THEN
    v_total := NEW.total_amount;
  ELSE
    SELECT COALESCE(SUM(sd.quantity * sd.unit_price), 0)
    INTO v_total
    FROM public.sale_details sd
    WHERE sd.sale_id = NEW.sale_id;
  END IF;

  INSERT INTO public.credits (sale_id, client_id, sector_id, driver_id, created_by_user_id, amount_total, balance, status, created_at)
  VALUES (NEW.sale_id, NEW.client_id, NEW.sector_id, NEW.driver_id, NEW.user_id, v_total, v_total, 'open', NOW())
  RETURNING credit_id INTO v_credit_id;

  RETURN NEW;
END $$;


ALTER FUNCTION public.fn_sales_auto_create_credit() OWNER TO postgres;

--
-- TOC entry 432 (class 1255 OID 17896)
-- Name: fn_sales_require_sector_when_client_has_sectors(); Type: FUNCTION; Schema: public; Owner: postgres
--

CREATE FUNCTION public.fn_sales_require_sector_when_client_has_sectors() RETURNS trigger
    LANGUAGE plpgsql
    AS $$
BEGIN
  -- Versión temporal: no exigir sector_id, pase lo que pase.
  -- Si quieres, aquí podrías hacer NEW.sector_id := NULL;
  RETURN NEW;
END
$$;


ALTER FUNCTION public.fn_sales_require_sector_when_client_has_sectors() OWNER TO postgres;

--
-- TOC entry 4542 (class 0 OID 0)
-- Dependencies: 432
-- Name: FUNCTION fn_sales_require_sector_when_client_has_sectors(); Type: COMMENT; Schema: public; Owner: postgres
--

COMMENT ON FUNCTION public.fn_sales_require_sector_when_client_has_sectors() IS 'Temporal: no exigir sector para ventas mientras el front/back no soportan sectores.';


--
-- TOC entry 430 (class 1255 OID 17897)
-- Name: fn_sales_validate_relations(); Type: FUNCTION; Schema: public; Owner: postgres
--

CREATE FUNCTION public.fn_sales_validate_relations() RETURNS trigger
    LANGUAGE plpgsql
    AS $$
DECLARE
  v_sector_client integer;
  v_driver_client integer;
  v_driver_sector integer;
BEGIN
  -- sector → mismo client
  IF NEW.sector_id IS NOT NULL THEN
    SELECT client_id INTO v_sector_client FROM public.sectors WHERE sector_id = NEW.sector_id;
    IF v_sector_client IS NULL OR v_sector_client <> NEW.client_id THEN
      RAISE EXCEPTION 'sector_id % no pertenece al client_id %', NEW.sector_id, NEW.client_id;
    END IF;
  END IF;

  -- driver → mismo client (y si aplica, mismo sector)
  IF NEW.driver_id IS NOT NULL THEN
    SELECT client_id, COALESCE(sector_id, NULL) INTO v_driver_client, v_driver_sector
    FROM public.client_drivers WHERE driver_id = NEW.driver_id;

    IF v_driver_client IS NULL OR v_driver_client <> NEW.client_id THEN
      RAISE EXCEPTION 'driver_id % no pertenece al client_id %', NEW.driver_id, NEW.client_id;
    END IF;

    IF NEW.sector_id IS NOT NULL AND v_driver_sector IS NOT NULL AND v_driver_sector <> NEW.sector_id THEN
      RAISE EXCEPTION 'driver_id % pertenece al sector_id % y no a %', NEW.driver_id, v_driver_sector, NEW.sector_id;
    END IF;
  END IF;

  RETURN NEW;
END $$;


ALTER FUNCTION public.fn_sales_validate_relations() OWNER TO postgres;

--
-- TOC entry 460 (class 1255 OID 19893)
-- Name: fn_validate_credit_payment(); Type: FUNCTION; Schema: public; Owner: postgres
--

CREATE FUNCTION public.fn_validate_credit_payment() RETURNS trigger
    LANGUAGE plpgsql
    AS $$
BEGIN
  -- Si es pago contado (no hay crédito asociado), no validar nada
  IF NEW.credit_id IS NULL THEN
    RETURN NEW;
  END IF;

  -- Si hay credit_id, validar que exista
  PERFORM 1 FROM public.credits c WHERE c.credit_id = NEW.credit_id;
  IF NOT FOUND THEN
    RAISE EXCEPTION 'Crédito % no existe', NEW.credit_id;
  END IF;

  RETURN NEW;
END;
$$;


ALTER FUNCTION public.fn_validate_credit_payment() OWNER TO postgres;

--
-- TOC entry 431 (class 1255 OID 17898)
-- Name: get_default_permissions(character varying); Type: FUNCTION; Schema: public; Owner: postgres
--

CREATE FUNCTION public.get_default_permissions(user_role character varying) RETURNS jsonb
    LANGUAGE plpgsql
    AS $$
BEGIN
    CASE user_role
        WHEN 'superadmin' THEN
            RETURN '{
                "modules": [
                    {"module": "users", "actions": ["create", "read", "update", "delete"]},
                    {"module": "clients", "actions": ["create", "read", "update", "delete"]},
                    {"module": "sales", "actions": ["create", "read", "update", "delete", "cancel"]},
                    {"module": "payments", "actions": ["create", "read", "update", "delete"]},
                    {"module": "products", "actions": ["create", "read", "update", "delete"]},
                    {"module": "reports", "actions": ["read", "export"]},
                    {"module": "settings", "actions": ["read", "update", "backup", "restore"]},
                    {"module": "credits", "actions": ["create", "read", "update", "delete"]},
                    {"module": "expenses", "actions": ["create", "read", "update", "delete"]},
                    {"module": "suppliers", "actions": ["create", "read", "update", "delete"]},
                    {"module": "employees", "actions": ["create", "read", "update", "delete"]},
                    {"module": "tanks", "actions": ["create", "read", "update", "delete"]},
                    {"module": "pumps", "actions": ["create", "read", "update", "delete"]},
                    {"module": "nozzles", "actions": ["create", "read", "update", "delete"]}
                ],
                "isAdmin": true
            }'::JSONB;
        WHEN 'admin' THEN
            RETURN '{
                "modules": [
                    {"module": "users", "actions": ["create", "read", "update"]},
                    {"module": "clients", "actions": ["create", "read", "update"]},
                    {"module": "sales", "actions": ["create", "read", "update"]},
                    {"module": "payments", "actions": ["create", "read", "update"]},
                    {"module": "products", "actions": ["create", "read", "update"]},
                    {"module": "reports", "actions": ["read", "export"]},
                    {"module": "credits", "actions": ["create", "read", "update"]},
                    {"module": "expenses", "actions": ["create", "read", "update"]},
                    {"module": "employees", "actions": ["create", "read", "update"]},
                    {"module": "suppliers", "actions": ["create", "read", "update"]},
                    {"module": "tanks", "actions": ["read", "update"]},
                    {"module": "pumps", "actions": ["read", "update"]},
                    {"module": "nozzles", "actions": ["read", "update"]}
                ],
                "isAdmin": false
            }'::JSONB;
        WHEN 'seller' THEN
            RETURN '{
                "modules": [
                    {"module": "clients", "actions": ["read", "update"]},
                    {"module": "sales", "actions": ["create", "read"]},
                    {"module": "payments", "actions": ["create", "read"]},
                    {"module": "products", "actions": ["read"]},
                    {"module": "reports", "actions": ["read"]},
                    {"module": "credits", "actions": ["read"]}
                ],
                "isAdmin": false
            }'::JSONB;
        ELSE
            RETURN '{
                "modules": [],
                "isAdmin": false
            }'::JSONB;
    END CASE;
END;
$$;


ALTER FUNCTION public.get_default_permissions(user_role character varying) OWNER TO postgres;

--
-- TOC entry 433 (class 1255 OID 17899)
-- Name: guard_last_active_admin(); Type: FUNCTION; Schema: public; Owner: postgres
--

CREATE FUNCTION public.guard_last_active_admin() RETURNS trigger
    LANGUAGE plpgsql
    AS $$
DECLARE
  remaining_admins int;
BEGIN
  -- Admins activos excluyendo el afectado
  SELECT COUNT(*) INTO remaining_admins
  FROM public.users
  WHERE role = 'admin' AND is_active = true
    AND user_id <> COALESCE(NEW.user_id, OLD.user_id);

  IF TG_OP = 'DELETE' THEN
    IF OLD.role='admin' AND OLD.is_active AND remaining_admins=0 THEN
      RAISE EXCEPTION 'No puedes eliminar al último administrador activo' USING ERRCODE='P0001';
    END IF;
    RETURN OLD;
  END IF;

  IF TG_OP = 'UPDATE' THEN
    -- Desactivar admin
    IF OLD.role='admin' AND OLD.is_active AND NEW.is_active=false AND remaining_admins=0 THEN
      RAISE EXCEPTION 'No puedes desactivar al último administrador activo' USING ERRCODE='P0001';
    END IF;
    -- Cambiar rol de admin -> otro
    IF OLD.role='admin' AND NEW.role<>'admin' AND OLD.is_active AND remaining_admins=0 THEN
      RAISE EXCEPTION 'No puedes cambiar el rol del último administrador activo' USING ERRCODE='P0001';
    END IF;
  END IF;

  RETURN COALESCE(NEW, OLD);
END$$;


ALTER FUNCTION public.guard_last_active_admin() OWNER TO postgres;

--
-- TOC entry 434 (class 1255 OID 17900)
-- Name: log_user_audit(character varying, integer, integer, jsonb, jsonb); Type: FUNCTION; Schema: public; Owner: postgres
--

CREATE FUNCTION public.log_user_audit(p_action character varying, p_performed_by integer, p_target_user integer, p_details jsonb DEFAULT NULL::jsonb, p_previous_data jsonb DEFAULT NULL::jsonb) RETURNS void
    LANGUAGE plpgsql
    AS $$
BEGIN
    INSERT INTO public.user_audit_logs (
        action,
        performed_by,
        target_user,
        details,
        previous_data
    ) VALUES (
        p_action,
        p_performed_by,
        p_target_user,
        p_details,
        p_previous_data
    );
END;
$$;


ALTER FUNCTION public.log_user_audit(p_action character varying, p_performed_by integer, p_target_user integer, p_details jsonb, p_previous_data jsonb) OWNER TO postgres;

--
-- TOC entry 435 (class 1255 OID 17901)
-- Name: recalc_ap_bill(bigint); Type: FUNCTION; Schema: public; Owner: postgres
--

CREATE FUNCTION public.recalc_ap_bill(p_bill_id bigint) RETURNS void
    LANGUAGE plpgsql
    AS $$
DECLARE
  v_paid   NUMERIC(14,2);
  v_orig   NUMERIC(14,2);
  v_bal    NUMERIC(14,2);
  v_pid    BIGINT;
  v_status TEXT;
BEGIN
  SELECT COALESCE(SUM(paid_amount),0) INTO v_paid
  FROM ap_payments WHERE bill_id = p_bill_id;

  SELECT original_amount, purchase_id INTO v_orig, v_pid
  FROM ap_bills WHERE bill_id = p_bill_id;

  v_bal := ROUND(v_orig - v_paid, 2);

  IF v_bal <= 0 THEN
    v_status := 'CLOSED';
  ELSIF v_paid > 0 THEN
    v_status := 'PARTIAL';
  ELSE
    v_status := 'OPEN';
  END IF;

  UPDATE ap_bills
     SET balance_amount = v_bal,
         status = v_status
   WHERE bill_id = p_bill_id;

  -- Reflejar en HEADER (purchases)
  UPDATE purchase_lines
     SET amount_paid = v_paid,
         payment_status = CASE
           WHEN v_status = 'CLOSED'  THEN 'PAID'::payment_status
           WHEN v_status = 'PARTIAL' THEN 'PARTIAL'::payment_status
           ELSE 'PENDING'::payment_status
         END
   WHERE purchase_id = v_pid AND line_type = 'HEADER';
END $$;


ALTER FUNCTION public.recalc_ap_bill(p_bill_id bigint) OWNER TO postgres;

--
-- TOC entry 436 (class 1255 OID 17902)
-- Name: recalc_purchase_totals(bigint); Type: FUNCTION; Schema: public; Owner: postgres
--

CREATE FUNCTION public.recalc_purchase_totals(p_id bigint) RETURNS void
    LANGUAGE plpgsql
    AS $$
DECLARE
  v_sub NUMERIC(14,2);
  v_tax NUMERIC(14,2);
  v_disc NUMERIC(14,2);
BEGIN
  -- Subtotal de ítems (quantity*unit_cost - line_discount) si no hay subtotal_item
  SELECT COALESCE(SUM(
           COALESCE(subtotal_item,
                    (COALESCE(quantity,0)*COALESCE(unit_cost,0) - COALESCE(line_discount,0))
           )
         ),0)
    INTO v_sub
  FROM purchase_lines
  WHERE purchase_id = p_id AND line_type='ITEM';

  -- IGV calculado por ítem (usa tax_rate si viene, 18% por defecto; 0 si exonerado)
  SELECT COALESCE(SUM(
           CASE
             WHEN is_tax_exempt THEN 0
             ELSE ROUND(
                    COALESCE(subtotal_item,
                             (COALESCE(quantity,0)*COALESCE(unit_cost,0) - COALESCE(line_discount,0))
                    ) * (COALESCE(tax_rate,18)/100.0)
                  , 2)
           END
         ),0)
    INTO v_tax
  FROM purchase_lines
  WHERE purchase_id = p_id AND line_type='ITEM';

  SELECT COALESCE(discount_header,0)
    INTO v_disc
  FROM purchase_lines
  WHERE purchase_id = p_id AND line_type='HEADER'
  LIMIT 1;

  UPDATE purchase_lines
     SET subtotal_header = v_sub,
         tax_header      = v_tax,
         total_amount    = ROUND(v_sub - v_disc + v_tax, 2)
   WHERE purchase_id = p_id AND line_type='HEADER';
END $$;


ALTER FUNCTION public.recalc_purchase_totals(p_id bigint) OWNER TO postgres;

--
-- TOC entry 437 (class 1255 OID 17903)
-- Name: recalc_received_for_purchase(bigint); Type: FUNCTION; Schema: public; Owner: postgres
--

CREATE FUNCTION public.recalc_received_for_purchase(p_purchase_id bigint) RETURNS void
    LANGUAGE plpgsql
    AS $$
BEGIN
  -- Actualiza received_qty por cada ITEM de la compra
  UPDATE purchase_lines i
     SET received_qty = COALESCE((
           SELECT SUM(prl.received_qty)
           FROM purchase_receipt_lines prl
           JOIN purchase_receipts pr ON pr.receipt_id = prl.receipt_id
           WHERE pr.purchase_id = p_purchase_id
             AND prl.line_id = i.line_id
         ), 0),
         is_fully_received = (
           COALESCE((
             SELECT SUM(prl.received_qty)
             FROM purchase_receipt_lines prl
             JOIN purchase_receipts pr ON pr.receipt_id = prl.receipt_id
             WHERE pr.purchase_id = p_purchase_id
               AND prl.line_id = i.line_id
           ), 0) >= COALESCE(i.quantity, 0)
         )
  WHERE i.purchase_id = p_purchase_id
    AND i.line_type = 'ITEM';
END $$;


ALTER FUNCTION public.recalc_received_for_purchase(p_purchase_id bigint) OWNER TO postgres;

--
-- TOC entry 438 (class 1255 OID 17904)
-- Name: report_client_sales_detail(integer, timestamp without time zone, timestamp without time zone); Type: FUNCTION; Schema: public; Owner: postgres
--

CREATE FUNCTION public.report_client_sales_detail(p_client_id integer, p_from timestamp without time zone, p_to timestamp without time zone) RETURNS TABLE(sale_id integer, sale_timestamp timestamp without time zone, client_id integer, client_label text, product_id integer, product_name text, gallons numeric, unit_price numeric, discount_amount numeric, tax_rate numeric, tax_amount numeric, subtotal numeric, payment_method text, is_credit boolean)
    LANGUAGE sql
    AS $$
  SELECT
    s.sale_id,
    s.sale_timestamp,
    s.client_id,
    c.document_number                   AS client_label,   -- <--- AQUÍ EL CAMBIO
    sd.product_id,
    p.name                              AS product_name,
    sd.quantity                         AS gallons,
    sd.unit_price_at_sale               AS unit_price,
    sd.discount_amount,
    sd.tax_rate,
    sd.tax_amount,
    sd.subtotal,
    pm.name                             AS payment_method,
    COALESCE(pm.is_credit, FALSE)       AS is_credit
  FROM public.sale_details sd
  JOIN public.sales s              ON s.sale_id = sd.sale_id
  JOIN public.clients c            ON c.client_id = s.client_id
  JOIN public.products p           ON p.product_id = sd.product_id
  LEFT JOIN public.payment_methods pm ON pm.payment_method_id = s.payment_method_id
  WHERE s.client_id = p_client_id
    AND s.sale_timestamp >= p_from
    AND s.sale_timestamp <  p_to
  ORDER BY s.sale_timestamp DESC, s.sale_id, sd.product_id;
$$;


ALTER FUNCTION public.report_client_sales_detail(p_client_id integer, p_from timestamp without time zone, p_to timestamp without time zone) OWNER TO postgres;

--
-- TOC entry 439 (class 1255 OID 17905)
-- Name: report_client_sales_summary(integer, timestamp without time zone, timestamp without time zone, text); Type: FUNCTION; Schema: public; Owner: postgres
--

CREATE FUNCTION public.report_client_sales_summary(p_client_id integer, p_from timestamp without time zone, p_to timestamp without time zone, p_group text DEFAULT 'day'::text) RETURNS TABLE(period timestamp without time zone, client_id integer, client_label text, sales integer, gallons numeric, revenue numeric, discount_total numeric, tax_total numeric, revenue_credit numeric, revenue_cash numeric)
    LANGUAGE sql
    AS $$
  -- Base: importes por venta desde SALES
  WITH base AS (
    SELECT
      s.sale_id,
      s.client_id,
      date_trunc(p_group, s.sale_timestamp)                           AS period,
      COALESCE(c.document_number::text, s.client_id::text)            AS client_label,
      COALESCE(s.final_amount, s.total_amount, 0)                     AS sale_amount,
      COALESCE(pm.is_credit, FALSE)                                   AS is_credit
    FROM public.sales s
    LEFT JOIN public.clients c         ON c.client_id = s.client_id
    LEFT JOIN public.payment_methods pm ON pm.payment_method_id = s.payment_method_id
    WHERE s.client_id = p_client_id
      AND s.sale_timestamp >= p_from
      AND s.sale_timestamp <  p_to
  ),
  -- Galones por venta (si hay detalles)
  gals AS (
    SELECT s.sale_id, SUM(sd.quantity) AS gallons
    FROM public.sale_details sd
    JOIN public.sales s ON s.sale_id = sd.sale_id
    WHERE s.client_id = p_client_id
      AND s.sale_timestamp >= p_from
      AND s.sale_timestamp <  p_to
    GROUP BY s.sale_id
  ),
  -- Descuentos e impuestos por venta (si hay detalles)
  dt AS (
    SELECT s.sale_id,
           SUM(sd.discount_amount) AS discount_total,
           SUM(sd.tax_amount)      AS tax_total
    FROM public.sale_details sd
    JOIN public.sales s ON s.sale_id = sd.sale_id
    WHERE s.client_id = p_client_id
      AND s.sale_timestamp >= p_from
      AND s.sale_timestamp <  p_to
    GROUP BY s.sale_id
  )
  SELECT
    b.period,
    b.client_id,
    b.client_label,
    COUNT(DISTINCT b.sale_id)                                         AS sales,
    COALESCE(SUM(g.gallons), 0)                                       AS gallons,
    SUM(b.sale_amount)                                                AS revenue,
    COALESCE(SUM(d.discount_total), 0)                                AS discount_total,
    COALESCE(SUM(d.tax_total), 0)                                     AS tax_total,
    SUM(CASE WHEN b.is_credit THEN b.sale_amount ELSE 0 END)          AS revenue_credit,
    SUM(CASE WHEN NOT b.is_credit THEN b.sale_amount ELSE 0 END)      AS revenue_cash
  FROM base b
  LEFT JOIN gals g ON g.sale_id = b.sale_id
  LEFT JOIN dt   d ON d.sale_id = b.sale_id
  GROUP BY b.period, b.client_id, b.client_label
  ORDER BY b.period DESC;
$$;


ALTER FUNCTION public.report_client_sales_summary(p_client_id integer, p_from timestamp without time zone, p_to timestamp without time zone, p_group text) OWNER TO postgres;

--
-- TOC entry 440 (class 1255 OID 17906)
-- Name: report_municipal_sales(timestamp with time zone, timestamp with time zone, integer, integer, integer); Type: FUNCTION; Schema: public; Owner: postgres
--

CREATE FUNCTION public.report_municipal_sales(p_start timestamp with time zone DEFAULT NULL::timestamp with time zone, p_end timestamp with time zone DEFAULT NULL::timestamp with time zone, p_client_id integer DEFAULT NULL::integer, p_sector_id integer DEFAULT NULL::integer, p_driver_id integer DEFAULT NULL::integer) RETURNS TABLE(client_id integer, client_name text, sector_id integer, sector_name text, driver_id integer, driver_name text, sale_count bigint, sum_total_amount numeric, sum_final_amount numeric, first_sale_at timestamp with time zone, last_sale_at timestamp with time zone)
    LANGUAGE sql STABLE
    AS $$
  SELECT
    s.client_id,
    c.company_name                         AS client_name,
    s.sector_id,
    sec.name                               AS sector_name,
    s.driver_id,
    d.full_name                            AS driver_name,
    COUNT(*)                               AS sale_count,
    COALESCE(SUM(s.total_amount), 0)::numeric AS sum_total_amount,
    COALESCE(SUM(s.final_amount), 0)::numeric AS sum_final_amount,
    MIN(s.sale_timestamp)                  AS first_sale_at,
    MAX(s.sale_timestamp)                  AS last_sale_at
  FROM public.sales s
  LEFT JOIN public.clients        c   ON c.client_id   = s.client_id
  LEFT JOIN public.sectors        sec ON sec.sector_id = s.sector_id
  LEFT JOIN public.client_drivers d   ON d.driver_id   = s.driver_id
  WHERE
    (p_start     IS NULL OR s.sale_timestamp >= p_start) AND
    (p_end       IS NULL OR s.sale_timestamp <  p_end)   AND
    (p_client_id IS NULL OR s.client_id     = p_client_id) AND
    (p_sector_id IS NULL OR s.sector_id     = p_sector_id) AND
    (p_driver_id IS NULL OR s.driver_id     = p_driver_id)
  GROUP BY
    s.client_id, c.company_name,
    s.sector_id, sec.name,
    s.driver_id, d.full_name
  ORDER BY
    client_name, sector_name, driver_name
$$;


ALTER FUNCTION public.report_municipal_sales(p_start timestamp with time zone, p_end timestamp with time zone, p_client_id integer, p_sector_id integer, p_driver_id integer) OWNER TO postgres;

--
-- TOC entry 441 (class 1255 OID 17907)
-- Name: sales_set_employee_from_user(); Type: FUNCTION; Schema: public; Owner: postgres
--

CREATE FUNCTION public.sales_set_employee_from_user() RETURNS trigger
    LANGUAGE plpgsql
    AS $$
BEGIN
  IF NEW.employee_id IS NULL THEN
    SELECT employee_id INTO NEW.employee_id
    FROM users
    WHERE user_id = NEW.user_id;
  END IF;
  RETURN NEW;
END;
$$;


ALTER FUNCTION public.sales_set_employee_from_user() OWNER TO postgres;

--
-- TOC entry 442 (class 1255 OID 17908)
-- Name: set_updated_at(); Type: FUNCTION; Schema: public; Owner: postgres
--

CREATE FUNCTION public.set_updated_at() RETURNS trigger
    LANGUAGE plpgsql
    AS $$
BEGIN
  NEW.updated_at = NOW();
  RETURN NEW;
END $$;


ALTER FUNCTION public.set_updated_at() OWNER TO postgres;

--
-- TOC entry 443 (class 1255 OID 17909)
-- Name: sync_ap_bill_from_header(bigint); Type: FUNCTION; Schema: public; Owner: postgres
--

CREATE FUNCTION public.sync_ap_bill_from_header(p_purchase_id bigint) RETURNS void
    LANGUAGE plpgsql
    AS $$
DECLARE
  v_total NUMERIC(14,2);
  v_bill  BIGINT;
BEGIN
  SELECT total_amount INTO v_total
  FROM purchase_lines
  WHERE purchase_id = p_purchase_id AND line_type='HEADER'
  LIMIT 1;

  SELECT bill_id INTO v_bill FROM ap_bills WHERE purchase_id = p_purchase_id;

  IF v_bill IS NOT NULL THEN
    UPDATE ap_bills
       SET original_amount = COALESCE(v_total, 0),
           balance_amount  = GREATEST(COALESCE(v_total,0) - (SELECT COALESCE(SUM(paid_amount),0) FROM ap_payments WHERE bill_id = v_bill), 0)
     WHERE bill_id = v_bill;

    PERFORM recalc_ap_bill(v_bill);
  END IF;
END $$;


ALTER FUNCTION public.sync_ap_bill_from_header(p_purchase_id bigint) OWNER TO postgres;

--
-- TOC entry 444 (class 1255 OID 17910)
-- Name: sync_sales_user_employee(); Type: FUNCTION; Schema: public; Owner: postgres
--

CREATE FUNCTION public.sync_sales_user_employee() RETURNS trigger
    LANGUAGE plpgsql
    AS $$
DECLARE v_role text; v_emp_id int; v_user_id int;
BEGIN
  IF NEW.user_id IS NOT NULL THEN
    SELECT role, employee_id INTO v_role, v_emp_id
    FROM users WHERE user_id = NEW.user_id;
  END IF;

  IF NEW.employee_id IS NULL AND v_emp_id IS NOT NULL THEN
    NEW.employee_id := v_emp_id;
  END IF;

  IF NEW.user_id IS NULL AND NEW.employee_id IS NOT NULL THEN
    SELECT user_id INTO v_user_id FROM users WHERE employee_id = NEW.employee_id;
    IF v_user_id IS NOT NULL THEN NEW.user_id := v_user_id; END IF;
  END IF;

  IF v_role = 'seller' AND NEW.employee_id IS NULL THEN
    RAISE EXCEPTION 'Seller must have employee_id to create a sale';
  END IF;

  RETURN NEW;
END $$;


ALTER FUNCTION public.sync_sales_user_employee() OWNER TO postgres;

--
-- TOC entry 445 (class 1255 OID 17911)
-- Name: touch_updated_at(); Type: FUNCTION; Schema: public; Owner: postgres
--

CREATE FUNCTION public.touch_updated_at() RETURNS trigger
    LANGUAGE plpgsql
    AS $$
BEGIN
  NEW.updated_at := now();
  RETURN NEW;
END $$;


ALTER FUNCTION public.touch_updated_at() OWNER TO postgres;

--
-- TOC entry 446 (class 1255 OID 17912)
-- Name: trg_bump_attachment_count(); Type: FUNCTION; Schema: public; Owner: postgres
--

CREATE FUNCTION public.trg_bump_attachment_count() RETURNS trigger
    LANGUAGE plpgsql
    AS $$
BEGIN
  IF TG_OP = 'INSERT' THEN
    UPDATE purchase_lines
       SET attachment_count = attachment_count + 1
     WHERE purchase_id = NEW.purchase_id AND line_type='HEADER';

  ELSIF TG_OP = 'DELETE' THEN
    UPDATE purchase_lines
       SET attachment_count = GREATEST(attachment_count - 1, 0)
     WHERE purchase_id = OLD.purchase_id AND line_type='HEADER';
  END IF;

  RETURN COALESCE(NEW, OLD);
END $$;


ALTER FUNCTION public.trg_bump_attachment_count() OWNER TO postgres;

--
-- TOC entry 447 (class 1255 OID 17913)
-- Name: trg_copy_driver_to_credit(); Type: FUNCTION; Schema: public; Owner: postgres
--

CREATE FUNCTION public.trg_copy_driver_to_credit() RETURNS trigger
    LANGUAGE plpgsql
    AS $$
BEGIN
  IF NEW.driver_id IS NULL THEN
    SELECT s.driver_id INTO NEW.driver_id
    FROM public.sales s
    WHERE s.sale_id = NEW.sale_id;
  END IF;
  RETURN NEW;
END;
$$;


ALTER FUNCTION public.trg_copy_driver_to_credit() OWNER TO postgres;

--
-- TOC entry 448 (class 1255 OID 17914)
-- Name: trg_create_ap_bill_after_header(); Type: FUNCTION; Schema: public; Owner: postgres
--

CREATE FUNCTION public.trg_create_ap_bill_after_header() RETURNS trigger
    LANGUAGE plpgsql
    AS $$
DECLARE
  v_exists INT;
BEGIN
  IF NEW.line_type = 'HEADER' THEN
    SELECT COUNT(*) INTO v_exists FROM ap_bills WHERE purchase_id = NEW.purchase_id;
    IF v_exists = 0 THEN
      INSERT INTO ap_bills(
        purchase_id, supplier_id, currency_code,
        original_amount, balance_amount, issue_date, due_date, created_at
      ) VALUES (
        NEW.purchase_id,
        COALESCE(NEW.supplier_id, 0),
        COALESCE(NEW.currency_code, 'PEN'),
        COALESCE(NEW.total_amount, 0),
        COALESCE(NEW.total_amount, 0),
        NEW.issue_date,
        NEW.due_date,
        now()
      );
    END IF;
  END IF;
  RETURN NEW;
END $$;


ALTER FUNCTION public.trg_create_ap_bill_after_header() OWNER TO postgres;

--
-- TOC entry 449 (class 1255 OID 17915)
-- Name: trg_credits_set_driver_from_sale(); Type: FUNCTION; Schema: public; Owner: postgres
--

CREATE FUNCTION public.trg_credits_set_driver_from_sale() RETURNS trigger
    LANGUAGE plpgsql
    AS $$
BEGIN
  IF NEW.driver_id IS NULL AND NEW.sale_id IS NOT NULL THEN
    SELECT s.driver_id INTO NEW.driver_id
    FROM public.sales s
    WHERE s.sale_id = NEW.sale_id;
  END IF;
  RETURN NEW;
END;
$$;


ALTER FUNCTION public.trg_credits_set_driver_from_sale() OWNER TO postgres;

--
-- TOC entry 416 (class 1255 OID 17916)
-- Name: trg_recalc_ap_after_change(); Type: FUNCTION; Schema: public; Owner: postgres
--

CREATE FUNCTION public.trg_recalc_ap_after_change() RETURNS trigger
    LANGUAGE plpgsql
    AS $$
BEGIN
  PERFORM recalc_ap_bill(CASE WHEN TG_OP='DELETE' THEN OLD.bill_id ELSE NEW.bill_id END);
  RETURN COALESCE(NEW, OLD);
END $$;


ALTER FUNCTION public.trg_recalc_ap_after_change() OWNER TO postgres;

--
-- TOC entry 450 (class 1255 OID 17917)
-- Name: trg_recalc_purchase_items_aiud(); Type: FUNCTION; Schema: public; Owner: postgres
--

CREATE FUNCTION public.trg_recalc_purchase_items_aiud() RETURNS trigger
    LANGUAGE plpgsql
    AS $$
BEGIN
  IF TG_OP = 'INSERT' THEN
    IF NEW.line_type = 'ITEM' THEN
      PERFORM recalc_purchase_totals(NEW.purchase_id);
    END IF;

  ELSIF TG_OP = 'UPDATE' THEN
    IF (OLD.line_type IS NOT NULL AND OLD.line_type = 'ITEM')
       OR (NEW.line_type IS NOT NULL AND NEW.line_type = 'ITEM') THEN
      PERFORM recalc_purchase_totals(NEW.purchase_id);
      IF OLD.purchase_id IS DISTINCT FROM NEW.purchase_id THEN
        PERFORM recalc_purchase_totals(OLD.purchase_id);
      END IF;
    END IF;

  ELSIF TG_OP = 'DELETE' THEN
    IF OLD.line_type = 'ITEM' THEN
      PERFORM recalc_purchase_totals(OLD.purchase_id);
    END IF;
  END IF;

  RETURN COALESCE(NEW, OLD);
END $$;


ALTER FUNCTION public.trg_recalc_purchase_items_aiud() OWNER TO postgres;

--
-- TOC entry 451 (class 1255 OID 17918)
-- Name: trg_recalc_received_after_aiud(); Type: FUNCTION; Schema: public; Owner: postgres
--

CREATE FUNCTION public.trg_recalc_received_after_aiud() RETURNS trigger
    LANGUAGE plpgsql
    AS $$
DECLARE v_pid BIGINT;
BEGIN
  SELECT purchase_id INTO v_pid
  FROM purchase_receipts
  WHERE receipt_id = (CASE WHEN TG_OP='DELETE' THEN OLD.receipt_id ELSE NEW.receipt_id END);

  IF v_pid IS NOT NULL THEN
    PERFORM recalc_received_for_purchase(v_pid);
  END IF;

  RETURN COALESCE(NEW, OLD);
END $$;


ALTER FUNCTION public.trg_recalc_received_after_aiud() OWNER TO postgres;

--
-- TOC entry 452 (class 1255 OID 17919)
-- Name: trg_sectors_touch_updated_at(); Type: FUNCTION; Schema: public; Owner: postgres
--

CREATE FUNCTION public.trg_sectors_touch_updated_at() RETURNS trigger
    LANGUAGE plpgsql
    AS $$
BEGIN
  NEW.updated_at := now();
  RETURN NEW;
END
$$;


ALTER FUNCTION public.trg_sectors_touch_updated_at() OWNER TO postgres;

--
-- TOC entry 453 (class 1255 OID 17920)
-- Name: trg_set_updated_at(); Type: FUNCTION; Schema: public; Owner: postgres
--

CREATE FUNCTION public.trg_set_updated_at() RETURNS trigger
    LANGUAGE plpgsql
    AS $$
BEGIN
  NEW.updated_at := now();
  RETURN NEW;
END $$;


ALTER FUNCTION public.trg_set_updated_at() OWNER TO postgres;

--
-- TOC entry 454 (class 1255 OID 17921)
-- Name: trg_validate_receipt_qty(); Type: FUNCTION; Schema: public; Owner: postgres
--

CREATE FUNCTION public.trg_validate_receipt_qty() RETURNS trigger
    LANGUAGE plpgsql
    AS $$
DECLARE
  v_item_qty NUMERIC(14,3);
  v_current  NUMERIC(14,3);
  v_newsum   NUMERIC(14,3);
  v_pid      BIGINT;
BEGIN
  -- cantidad ordenada del ítem
  SELECT quantity, purchase_id INTO v_item_qty, v_pid
  FROM purchase_lines
  WHERE line_id = (CASE WHEN TG_OP='DELETE' THEN OLD.line_id ELSE NEW.line_id END)
    AND line_type='ITEM'
  LIMIT 1;

  IF v_item_qty IS NULL THEN
    RAISE EXCEPTION 'No existe ITEM % en purchase_lines', (CASE WHEN TG_OP='DELETE' THEN OLD.line_id ELSE NEW.line_id END);
  END IF;

  -- suma actual (sin considerar el registro en edición)
  SELECT COALESCE(SUM(received_qty),0) INTO v_current
  FROM purchase_receipt_lines
  WHERE line_id = (CASE WHEN TG_OP='DELETE' THEN OLD.line_id ELSE NEW.line_id END)
    AND (TG_OP='DELETE' OR receipt_line_id <> NEW.receipt_line_id);

  -- nueva suma (“propuesta”)
  v_newsum := v_current + (CASE WHEN TG_OP='DELETE' THEN 0 ELSE NEW.received_qty END);

  IF v_newsum > v_item_qty + 1e-9 THEN
    RAISE EXCEPTION 'Recepción excede lo ordenado. Ordenado=%, Actual=%, Nuevo=%',
      v_item_qty, v_current, v_newsum;
  END IF;

  RETURN COALESCE(NEW, OLD);
END $$;


ALTER FUNCTION public.trg_validate_receipt_qty() OWNER TO postgres;

--
-- TOC entry 455 (class 1255 OID 17922)
-- Name: user_delete(integer, boolean); Type: FUNCTION; Schema: public; Owner: postgres
--

CREATE FUNCTION public.user_delete(p_user_id integer, p_hard boolean DEFAULT false) RETURNS text
    LANGUAGE plpgsql
    AS $$
DECLARE
  u RECORD;
  has_refs BOOLEAN := FALSE;
BEGIN
  -- Buscar usuario
  SELECT * INTO u FROM public.users WHERE user_id = p_user_id;
  IF NOT FOUND THEN
    RAISE EXCEPTION 'Usuario % no existe', p_user_id USING ERRCODE='P0002';
  END IF;

  -- Bloquear eliminación del último admin activo
  IF u.role = 'admin' AND u.is_active THEN
    PERFORM COUNT(*) FROM public.users WHERE role='admin' AND is_active=true AND user_id <> p_user_id;
    IF NOT FOUND THEN
      RAISE EXCEPTION 'No se puede eliminar al último administrador activo' USING ERRCODE='P0001';
    END IF;
  END IF;

  -- Si es eliminación física, revisar dependencias
  IF p_hard THEN
    -- 🔧 Cambia estas tablas según tu proyecto (ejemplo: sales, payments, credits, etc.)
    IF EXISTS (SELECT 1 FROM public.sales WHERE user_id = p_user_id)
       OR EXISTS (SELECT 1 FROM public.payments WHERE user_id = p_user_id)
       OR EXISTS (SELECT 1 FROM public.credits WHERE user_id = p_user_id)
    THEN
      RAISE EXCEPTION 'No se puede eliminar definitivamente: existen registros asociados (ventas/pagos/créditos)' USING ERRCODE='P0003';
    END IF;

    DELETE FROM public.users WHERE user_id = p_user_id;
    RETURN 'Usuario eliminado permanentemente';
  ELSE
    -- Soft delete
    UPDATE public.users
    SET is_active = false,
        token_version = token_version + 1
    WHERE user_id = p_user_id;

    RETURN 'Usuario desactivado (soft delete)';
  END IF;
END;
$$;


ALTER FUNCTION public.user_delete(p_user_id integer, p_hard boolean) OWNER TO postgres;

--
-- TOC entry 456 (class 1255 OID 17923)
-- Name: user_hard_delete(integer); Type: FUNCTION; Schema: public; Owner: postgres
--

CREATE FUNCTION public.user_hard_delete(p_user_id integer) RETURNS void
    LANGUAGE plpgsql
    AS $$
DECLARE
  has_refs boolean := false;
BEGIN
  -- Chequeos de referencias (cambia por tus tablas reales)
  IF EXISTS (SELECT 1 FROM public.sales   WHERE user_id = p_user_id) THEN has_refs := true; END IF;
  IF EXISTS (SELECT 1 FROM public.payments WHERE user_id = p_user_id) THEN has_refs := true; END IF;
  IF EXISTS (SELECT 1 FROM public.audits   WHERE user_id = p_user_id) THEN has_refs := true; END IF;

  IF has_refs THEN
    RAISE EXCEPTION 'No se puede eliminar definitivamente: existen referencias (ventas/pagos/auditorías...)'
      USING ERRCODE='P0003'; -- 409
  END IF;

  -- Triggers protegen "último admin activo"
  DELETE FROM public.users WHERE user_id = p_user_id;
END$$;


ALTER FUNCTION public.user_hard_delete(p_user_id integer) OWNER TO postgres;

--
-- TOC entry 457 (class 1255 OID 17924)
-- Name: user_set_password(integer, text); Type: FUNCTION; Schema: public; Owner: postgres
--

CREATE FUNCTION public.user_set_password(p_user_id integer, p_new_plain text) RETURNS void
    LANGUAGE plpgsql
    AS $$
BEGIN
  UPDATE public.users
  SET password_hash = crypt(p_new_plain, gen_salt('bf', 10)),
      token_version = token_version + 1    -- invalida tokens
  WHERE user_id = p_user_id;

  IF NOT FOUND THEN
    RAISE EXCEPTION 'Usuario % no existe', p_user_id USING ERRCODE='P0002';
  END IF;
END$$;


ALTER FUNCTION public.user_set_password(p_user_id integer, p_new_plain text) OWNER TO postgres;

--
-- TOC entry 458 (class 1255 OID 17925)
-- Name: user_soft_delete(integer); Type: FUNCTION; Schema: public; Owner: postgres
--

CREATE FUNCTION public.user_soft_delete(p_user_id integer) RETURNS void
    LANGUAGE plpgsql
    AS $$
DECLARE
  u public.users%ROWTYPE;
BEGIN
  SELECT * INTO u FROM public.users WHERE user_id = p_user_id;
  IF NOT FOUND THEN
    RAISE EXCEPTION 'Usuario % no existe', p_user_id USING ERRCODE='P0002';
  END IF;

  UPDATE public.users
  SET is_active=false, token_version=token_version+1
  WHERE user_id = p_user_id;
END$$;


ALTER FUNCTION public.user_soft_delete(p_user_id integer) OWNER TO postgres;

--
-- TOC entry 459 (class 1255 OID 17926)
-- Name: validate_role_hierarchy(); Type: FUNCTION; Schema: public; Owner: postgres
--

CREATE FUNCTION public.validate_role_hierarchy() RETURNS trigger
    LANGUAGE plpgsql
    AS $$
BEGIN
  -- Solo vendedores deben tener employee_id
  IF lower(NEW.role) IN ('seller','vendedor') AND NEW.employee_id IS NULL THEN
    RAISE EXCEPTION 'Los usuarios con rol % deben tener un employee_id', NEW.role;
  END IF;

  RETURN NEW;
END;
$$;


ALTER FUNCTION public.validate_role_hierarchy() OWNER TO postgres;

SET default_tablespace = '';

SET default_table_access_method = heap;

--
-- TOC entry 211 (class 1259 OID 17927)
-- Name: ap_bills; Type: TABLE; Schema: public; Owner: postgres
--

CREATE TABLE public.ap_bills (
    bill_id bigint NOT NULL,
    purchase_id bigint NOT NULL,
    supplier_id bigint NOT NULL,
    currency_code character(3) DEFAULT 'PEN'::bpchar NOT NULL,
    original_amount numeric(14,2) NOT NULL,
    balance_amount numeric(14,2) NOT NULL,
    status text DEFAULT 'OPEN'::text NOT NULL,
    issue_date date,
    due_date date,
    created_at timestamp without time zone DEFAULT now() NOT NULL
);


ALTER TABLE public.ap_bills OWNER TO postgres;

--
-- TOC entry 212 (class 1259 OID 17935)
-- Name: ap_bills_bill_id_seq; Type: SEQUENCE; Schema: public; Owner: postgres
--

CREATE SEQUENCE public.ap_bills_bill_id_seq
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1;


ALTER SEQUENCE public.ap_bills_bill_id_seq OWNER TO postgres;

--
-- TOC entry 4543 (class 0 OID 0)
-- Dependencies: 212
-- Name: ap_bills_bill_id_seq; Type: SEQUENCE OWNED BY; Schema: public; Owner: postgres
--

ALTER SEQUENCE public.ap_bills_bill_id_seq OWNED BY public.ap_bills.bill_id;


--
-- TOC entry 213 (class 1259 OID 17936)
-- Name: ap_payments; Type: TABLE; Schema: public; Owner: postgres
--

CREATE TABLE public.ap_payments (
    ap_payment_id bigint NOT NULL,
    bill_id bigint NOT NULL,
    paid_amount numeric(14,2) NOT NULL,
    payment_method_id bigint,
    paid_at timestamp without time zone DEFAULT now() NOT NULL,
    notes text,
    created_by bigint
);


ALTER TABLE public.ap_payments OWNER TO postgres;

--
-- TOC entry 214 (class 1259 OID 17942)
-- Name: ap_payments_ap_payment_id_seq; Type: SEQUENCE; Schema: public; Owner: postgres
--

CREATE SEQUENCE public.ap_payments_ap_payment_id_seq
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1;


ALTER SEQUENCE public.ap_payments_ap_payment_id_seq OWNER TO postgres;

--
-- TOC entry 4544 (class 0 OID 0)
-- Dependencies: 214
-- Name: ap_payments_ap_payment_id_seq; Type: SEQUENCE OWNED BY; Schema: public; Owner: postgres
--

ALTER SEQUENCE public.ap_payments_ap_payment_id_seq OWNED BY public.ap_payments.ap_payment_id;


--
-- TOC entry 215 (class 1259 OID 17943)
-- Name: backup_config; Type: TABLE; Schema: public; Owner: postgres
--

CREATE TABLE public.backup_config (
    id integer NOT NULL,
    frequency character varying(50) NOT NULL,
    time_of_day time without time zone NOT NULL,
    day_of_week integer,
    day_of_month integer,
    specific_day integer,
    month character varying(50),
    storage_type character varying(50) NOT NULL,
    is_active boolean DEFAULT true,
    is_default boolean DEFAULT false,
    created_at timestamp without time zone DEFAULT CURRENT_TIMESTAMP
);


ALTER TABLE public.backup_config OWNER TO postgres;

--
-- TOC entry 216 (class 1259 OID 17949)
-- Name: backup_config_id_seq; Type: SEQUENCE; Schema: public; Owner: postgres
--

CREATE SEQUENCE public.backup_config_id_seq
    AS integer
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1;


ALTER SEQUENCE public.backup_config_id_seq OWNER TO postgres;

--
-- TOC entry 4545 (class 0 OID 0)
-- Dependencies: 216
-- Name: backup_config_id_seq; Type: SEQUENCE OWNED BY; Schema: public; Owner: postgres
--

ALTER SEQUENCE public.backup_config_id_seq OWNED BY public.backup_config.id;


--
-- TOC entry 217 (class 1259 OID 17950)
-- Name: backup_history; Type: TABLE; Schema: public; Owner: postgres
--

CREATE TABLE public.backup_history (
    id integer NOT NULL,
    filename character varying(255) NOT NULL,
    path text NOT NULL,
    created_at timestamp without time zone DEFAULT CURRENT_TIMESTAMP,
    status character varying(50) NOT NULL,
    type character varying(50) NOT NULL,
    action character varying(50) NOT NULL,
    user_id integer,
    error text
);


ALTER TABLE public.backup_history OWNER TO postgres;

--
-- TOC entry 218 (class 1259 OID 17956)
-- Name: backup_history_id_seq; Type: SEQUENCE; Schema: public; Owner: postgres
--

CREATE SEQUENCE public.backup_history_id_seq
    AS integer
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1;


ALTER SEQUENCE public.backup_history_id_seq OWNER TO postgres;

--
-- TOC entry 4546 (class 0 OID 0)
-- Dependencies: 218
-- Name: backup_history_id_seq; Type: SEQUENCE OWNED BY; Schema: public; Owner: postgres
--

ALTER SEQUENCE public.backup_history_id_seq OWNED BY public.backup_history.id;


--
-- TOC entry 219 (class 1259 OID 17957)
-- Name: cash_box_sessions; Type: TABLE; Schema: public; Owner: postgres
--

CREATE TABLE public.cash_box_sessions (
    id bigint NOT NULL,
    day_date date DEFAULT CURRENT_DATE NOT NULL,
    shift_name text NOT NULL,
    opened_at timestamp with time zone DEFAULT now() NOT NULL,
    opened_by integer NOT NULL,
    opening_amount numeric(12,2) NOT NULL,
    closed_at timestamp with time zone,
    closed_by integer,
    closing_amount numeric(12,2),
    sales_amount numeric(12,2),
    notes text,
    is_closed boolean DEFAULT false NOT NULL,
    opened_by_name text,
    closed_by_name text,
    CONSTRAINT cash_box_sessions_opening_amount_check CHECK ((opening_amount >= (0)::numeric))
);


ALTER TABLE public.cash_box_sessions OWNER TO postgres;

--
-- TOC entry 220 (class 1259 OID 17966)
-- Name: cash_box_sessions_id_seq; Type: SEQUENCE; Schema: public; Owner: postgres
--

CREATE SEQUENCE public.cash_box_sessions_id_seq
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1;


ALTER SEQUENCE public.cash_box_sessions_id_seq OWNER TO postgres;

--
-- TOC entry 4547 (class 0 OID 0)
-- Dependencies: 220
-- Name: cash_box_sessions_id_seq; Type: SEQUENCE OWNED BY; Schema: public; Owner: postgres
--

ALTER SEQUENCE public.cash_box_sessions_id_seq OWNED BY public.cash_box_sessions.id;


--
-- TOC entry 221 (class 1259 OID 17967)
-- Name: cash_registers; Type: TABLE; Schema: public; Owner: postgres
--

CREATE TABLE public.cash_registers (
    id integer NOT NULL,
    shift_id integer,
    opened_by integer,
    closed_by integer,
    opening_amount numeric(10,2) NOT NULL,
    closing_amount numeric(10,2),
    created_at timestamp without time zone DEFAULT now()
);


ALTER TABLE public.cash_registers OWNER TO postgres;

--
-- TOC entry 222 (class 1259 OID 17971)
-- Name: cash_registers_id_seq; Type: SEQUENCE; Schema: public; Owner: postgres
--

CREATE SEQUENCE public.cash_registers_id_seq
    AS integer
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1;


ALTER SEQUENCE public.cash_registers_id_seq OWNER TO postgres;

--
-- TOC entry 4548 (class 0 OID 0)
-- Dependencies: 222
-- Name: cash_registers_id_seq; Type: SEQUENCE OWNED BY; Schema: public; Owner: postgres
--

ALTER SEQUENCE public.cash_registers_id_seq OWNED BY public.cash_registers.id;


--
-- TOC entry 223 (class 1259 OID 17972)
-- Name: client_credit_limits; Type: TABLE; Schema: public; Owner: postgres
--

CREATE TABLE public.client_credit_limits (
    id bigint NOT NULL,
    client_id integer NOT NULL,
    period_kind text DEFAULT 'month'::text NOT NULL,
    max_gallons numeric(12,3) NOT NULL,
    is_active boolean DEFAULT true NOT NULL,
    created_at timestamp without time zone DEFAULT now() NOT NULL
);


ALTER TABLE public.client_credit_limits OWNER TO postgres;

--
-- TOC entry 224 (class 1259 OID 17980)
-- Name: client_credit_limits_id_seq; Type: SEQUENCE; Schema: public; Owner: postgres
--

CREATE SEQUENCE public.client_credit_limits_id_seq
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1;


ALTER SEQUENCE public.client_credit_limits_id_seq OWNER TO postgres;

--
-- TOC entry 4549 (class 0 OID 0)
-- Dependencies: 224
-- Name: client_credit_limits_id_seq; Type: SEQUENCE OWNED BY; Schema: public; Owner: postgres
--

ALTER SEQUENCE public.client_credit_limits_id_seq OWNED BY public.client_credit_limits.id;


--
-- TOC entry 225 (class 1259 OID 17981)
-- Name: client_drivers; Type: TABLE; Schema: public; Owner: postgres
--

CREATE TABLE public.client_drivers (
    driver_id integer NOT NULL,
    company_id integer NOT NULL,
    dni public.citext,
    full_name character varying(120) NOT NULL,
    driver_license public.citext,
    plate public.citext,
    phone character varying(32),
    vehicle_brand character varying(40),
    vehicle_model character varying(40),
    vehicle_color character varying(24),
    is_active boolean DEFAULT true NOT NULL,
    notes text,
    created_at timestamp with time zone DEFAULT now() NOT NULL,
    updated_at timestamp with time zone DEFAULT now() NOT NULL,
    sector_id integer
);


ALTER TABLE public.client_drivers OWNER TO postgres;

--
-- TOC entry 226 (class 1259 OID 17989)
-- Name: client_drivers_driver_id_seq; Type: SEQUENCE; Schema: public; Owner: postgres
--

CREATE SEQUENCE public.client_drivers_driver_id_seq
    AS integer
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1;


ALTER SEQUENCE public.client_drivers_driver_id_seq OWNER TO postgres;

--
-- TOC entry 4550 (class 0 OID 0)
-- Dependencies: 226
-- Name: client_drivers_driver_id_seq; Type: SEQUENCE OWNED BY; Schema: public; Owner: postgres
--

ALTER SEQUENCE public.client_drivers_driver_id_seq OWNED BY public.client_drivers.driver_id;


--
-- TOC entry 227 (class 1259 OID 17990)
-- Name: client_product_gallon_limits; Type: TABLE; Schema: public; Owner: postgres
--

CREATE TABLE public.client_product_gallon_limits (
    id bigint NOT NULL,
    client_id integer NOT NULL,
    product_id integer NOT NULL,
    period_kind text DEFAULT 'month'::text NOT NULL,
    max_gallons numeric(12,3) NOT NULL,
    apply_to_all_payments boolean DEFAULT true NOT NULL,
    is_active boolean DEFAULT true NOT NULL,
    created_at timestamp without time zone DEFAULT now() NOT NULL,
    updated_at timestamp with time zone DEFAULT now()
);


ALTER TABLE public.client_product_gallon_limits OWNER TO postgres;

--
-- TOC entry 228 (class 1259 OID 18000)
-- Name: client_product_gallon_limits_id_seq; Type: SEQUENCE; Schema: public; Owner: postgres
--

CREATE SEQUENCE public.client_product_gallon_limits_id_seq
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1;


ALTER SEQUENCE public.client_product_gallon_limits_id_seq OWNER TO postgres;

--
-- TOC entry 4551 (class 0 OID 0)
-- Dependencies: 228
-- Name: client_product_gallon_limits_id_seq; Type: SEQUENCE OWNED BY; Schema: public; Owner: postgres
--

ALTER SEQUENCE public.client_product_gallon_limits_id_seq OWNED BY public.client_product_gallon_limits.id;


--
-- TOC entry 315 (class 1259 OID 19895)
-- Name: client_product_rules; Type: TABLE; Schema: public; Owner: postgres
--

CREATE TABLE public.client_product_rules (
    rule_id integer NOT NULL,
    client_id integer NOT NULL,
    product_id integer NOT NULL,
    max_gallons numeric(12,3),
    credit_limit numeric(12,2),
    active boolean DEFAULT true
);


ALTER TABLE public.client_product_rules OWNER TO postgres;

--
-- TOC entry 314 (class 1259 OID 19894)
-- Name: client_product_rules_rule_id_seq; Type: SEQUENCE; Schema: public; Owner: postgres
--

CREATE SEQUENCE public.client_product_rules_rule_id_seq
    AS integer
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1;


ALTER SEQUENCE public.client_product_rules_rule_id_seq OWNER TO postgres;

--
-- TOC entry 4552 (class 0 OID 0)
-- Dependencies: 314
-- Name: client_product_rules_rule_id_seq; Type: SEQUENCE OWNED BY; Schema: public; Owner: postgres
--

ALTER SEQUENCE public.client_product_rules_rule_id_seq OWNED BY public.client_product_rules.rule_id;


--
-- TOC entry 229 (class 1259 OID 18001)
-- Name: clients; Type: TABLE; Schema: public; Owner: postgres
--

CREATE TABLE public.clients (
    client_id integer NOT NULL,
    client_type character varying(10) NOT NULL,
    category character varying(20) NOT NULL,
    first_name character varying(100),
    last_name character varying(100),
    company_name character varying(255),
    document_type character varying(20),
    document_number character varying(20),
    address text,
    phone character varying(50),
    email character varying(255),
    birth_date date,
    notes text,
    created_at timestamp without time zone DEFAULT now() NOT NULL,
    updated_at timestamp without time zone,
    restrict_to_limited_products boolean DEFAULT false NOT NULL,
    CONSTRAINT clients_category_check CHECK (((category)::text = ANY (ARRAY[('credito'::character varying)::text, ('contado'::character varying)::text, ('frecuente'::character varying)::text, ('moroso'::character varying)::text]))),
    CONSTRAINT clients_client_type_check CHECK (((client_type)::text = ANY (ARRAY[('persona'::character varying)::text, ('empresa'::character varying)::text])))
);


ALTER TABLE public.clients OWNER TO postgres;

--
-- TOC entry 230 (class 1259 OID 18010)
-- Name: clients_client_id_seq; Type: SEQUENCE; Schema: public; Owner: postgres
--

CREATE SEQUENCE public.clients_client_id_seq
    AS integer
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1;


ALTER SEQUENCE public.clients_client_id_seq OWNER TO postgres;

--
-- TOC entry 4553 (class 0 OID 0)
-- Dependencies: 230
-- Name: clients_client_id_seq; Type: SEQUENCE OWNED BY; Schema: public; Owner: postgres
--

ALTER SEQUENCE public.clients_client_id_seq OWNED BY public.clients.client_id;


--
-- TOC entry 231 (class 1259 OID 18011)
-- Name: credits; Type: TABLE; Schema: public; Owner: postgres
--

CREATE TABLE public.credits (
    credit_id integer NOT NULL,
    client_id integer NOT NULL,
    sale_id integer NOT NULL,
    credit_amount numeric(10,2) NOT NULL,
    amount_paid numeric(10,2) DEFAULT 0 NOT NULL,
    due_date date NOT NULL,
    status character varying(20) DEFAULT 'pending'::character varying NOT NULL,
    created_at timestamp without time zone DEFAULT now() NOT NULL,
    updated_at timestamp without time zone,
    driver_id integer,
    company_driver_id integer,
    sector_id integer,
    created_by_user_id integer,
    amount_total numeric(14,2),
    balance numeric(14,2),
    CONSTRAINT chk_credits_amount_positive CHECK ((amount_total >= (0)::numeric)),
    CONSTRAINT chk_credits_balance_range CHECK (((balance >= (0)::numeric) AND (balance <= amount_total))),
    CONSTRAINT credits_status_check CHECK (((status)::text = ANY (ARRAY[('pending'::character varying)::text, ('paid'::character varying)::text, ('overdue'::character varying)::text])))
);


ALTER TABLE public.credits OWNER TO postgres;

--
-- TOC entry 232 (class 1259 OID 18020)
-- Name: credits_credit_id_seq; Type: SEQUENCE; Schema: public; Owner: postgres
--

CREATE SEQUENCE public.credits_credit_id_seq
    AS integer
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1;


ALTER SEQUENCE public.credits_credit_id_seq OWNER TO postgres;

--
-- TOC entry 4554 (class 0 OID 0)
-- Dependencies: 232
-- Name: credits_credit_id_seq; Type: SEQUENCE OWNED BY; Schema: public; Owner: postgres
--

ALTER SEQUENCE public.credits_credit_id_seq OWNED BY public.credits.credit_id;


--
-- TOC entry 233 (class 1259 OID 18021)
-- Name: deliveries; Type: TABLE; Schema: public; Owner: postgres
--

CREATE TABLE public.deliveries (
    delivery_id integer NOT NULL,
    supplier_id integer NOT NULL,
    delivery_timestamp timestamp without time zone DEFAULT now() NOT NULL,
    invoice_number character varying(100),
    notes text,
    user_id integer NOT NULL
);


ALTER TABLE public.deliveries OWNER TO postgres;

--
-- TOC entry 234 (class 1259 OID 18027)
-- Name: deliveries_delivery_id_seq; Type: SEQUENCE; Schema: public; Owner: postgres
--

CREATE SEQUENCE public.deliveries_delivery_id_seq
    AS integer
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1;


ALTER SEQUENCE public.deliveries_delivery_id_seq OWNER TO postgres;

--
-- TOC entry 4555 (class 0 OID 0)
-- Dependencies: 234
-- Name: deliveries_delivery_id_seq; Type: SEQUENCE OWNED BY; Schema: public; Owner: postgres
--

ALTER SEQUENCE public.deliveries_delivery_id_seq OWNED BY public.deliveries.delivery_id;


--
-- TOC entry 235 (class 1259 OID 18028)
-- Name: delivery_details; Type: TABLE; Schema: public; Owner: postgres
--

CREATE TABLE public.delivery_details (
    delivery_detail_id integer NOT NULL,
    delivery_id integer NOT NULL,
    product_id integer NOT NULL,
    tank_id integer NOT NULL,
    quantity_delivered numeric(10,3) NOT NULL,
    unit_cost numeric(10,2)
);


ALTER TABLE public.delivery_details OWNER TO postgres;

--
-- TOC entry 236 (class 1259 OID 18031)
-- Name: delivery_details_delivery_detail_id_seq; Type: SEQUENCE; Schema: public; Owner: postgres
--

CREATE SEQUENCE public.delivery_details_delivery_detail_id_seq
    AS integer
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1;


ALTER SEQUENCE public.delivery_details_delivery_detail_id_seq OWNER TO postgres;

--
-- TOC entry 4556 (class 0 OID 0)
-- Dependencies: 236
-- Name: delivery_details_delivery_detail_id_seq; Type: SEQUENCE OWNED BY; Schema: public; Owner: postgres
--

ALTER SEQUENCE public.delivery_details_delivery_detail_id_seq OWNED BY public.delivery_details.delivery_detail_id;


--
-- TOC entry 237 (class 1259 OID 18032)
-- Name: discounts; Type: TABLE; Schema: public; Owner: postgres
--

CREATE TABLE public.discounts (
    id integer NOT NULL,
    name character varying(100) NOT NULL,
    active boolean DEFAULT true,
    created_at timestamp without time zone DEFAULT now(),
    gallons double precision DEFAULT 0 NOT NULL,
    amount double precision DEFAULT 0 NOT NULL
);


ALTER TABLE public.discounts OWNER TO postgres;

--
-- TOC entry 238 (class 1259 OID 18039)
-- Name: discounts_id_seq; Type: SEQUENCE; Schema: public; Owner: postgres
--

CREATE SEQUENCE public.discounts_id_seq
    AS integer
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1;


ALTER SEQUENCE public.discounts_id_seq OWNER TO postgres;

--
-- TOC entry 4557 (class 0 OID 0)
-- Dependencies: 238
-- Name: discounts_id_seq; Type: SEQUENCE OWNED BY; Schema: public; Owner: postgres
--

ALTER SEQUENCE public.discounts_id_seq OWNED BY public.discounts.id;


--
-- TOC entry 239 (class 1259 OID 18040)
-- Name: dispensers; Type: TABLE; Schema: public; Owner: postgres
--

CREATE TABLE public.dispensers (
    dispenser_id integer NOT NULL,
    dispenser_number character varying(50) NOT NULL,
    dispenser_name character varying(100) NOT NULL,
    location_description text,
    created_at timestamp without time zone DEFAULT now() NOT NULL,
    updated_at timestamp without time zone
);


ALTER TABLE public.dispensers OWNER TO postgres;

--
-- TOC entry 240 (class 1259 OID 18046)
-- Name: dispensers_dispenser_id_seq; Type: SEQUENCE; Schema: public; Owner: postgres
--

CREATE SEQUENCE public.dispensers_dispenser_id_seq
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1;


ALTER SEQUENCE public.dispensers_dispenser_id_seq OWNER TO postgres;

--
-- TOC entry 4558 (class 0 OID 0)
-- Dependencies: 240
-- Name: dispensers_dispenser_id_seq; Type: SEQUENCE OWNED BY; Schema: public; Owner: postgres
--

ALTER SEQUENCE public.dispensers_dispenser_id_seq OWNED BY public.dispensers.dispenser_id;


--
-- TOC entry 241 (class 1259 OID 18047)
-- Name: employees; Type: TABLE; Schema: public; Owner: postgres
--

CREATE TABLE public.employees (
    employee_id integer NOT NULL,
    dni character(8) NOT NULL,
    first_name character varying(100) NOT NULL,
    last_name character varying(100) NOT NULL,
    "position" character varying(100) NOT NULL,
    birth_date date,
    address text,
    phone_number character varying(50),
    email character varying(255),
    hire_date date NOT NULL,
    termination_date date,
    is_active boolean DEFAULT true NOT NULL,
    file_path text,
    created_at timestamp without time zone DEFAULT now() NOT NULL,
    updated_at timestamp without time zone
);


ALTER TABLE public.employees OWNER TO postgres;

--
-- TOC entry 242 (class 1259 OID 18054)
-- Name: employees_employee_id_seq; Type: SEQUENCE; Schema: public; Owner: postgres
--

CREATE SEQUENCE public.employees_employee_id_seq
    AS integer
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1;


ALTER SEQUENCE public.employees_employee_id_seq OWNER TO postgres;

--
-- TOC entry 4559 (class 0 OID 0)
-- Dependencies: 242
-- Name: employees_employee_id_seq; Type: SEQUENCE OWNED BY; Schema: public; Owner: postgres
--

ALTER SEQUENCE public.employees_employee_id_seq OWNED BY public.employees.employee_id;


--
-- TOC entry 243 (class 1259 OID 18055)
-- Name: expense_categories; Type: TABLE; Schema: public; Owner: postgres
--

CREATE TABLE public.expense_categories (
    category_id integer NOT NULL,
    category_name character varying(100) NOT NULL
);


ALTER TABLE public.expense_categories OWNER TO postgres;

--
-- TOC entry 244 (class 1259 OID 18058)
-- Name: expense_categories_category_id_seq; Type: SEQUENCE; Schema: public; Owner: postgres
--

CREATE SEQUENCE public.expense_categories_category_id_seq
    AS integer
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1;


ALTER SEQUENCE public.expense_categories_category_id_seq OWNER TO postgres;

--
-- TOC entry 4560 (class 0 OID 0)
-- Dependencies: 244
-- Name: expense_categories_category_id_seq; Type: SEQUENCE OWNED BY; Schema: public; Owner: postgres
--

ALTER SEQUENCE public.expense_categories_category_id_seq OWNED BY public.expense_categories.category_id;


--
-- TOC entry 245 (class 1259 OID 18059)
-- Name: expenses; Type: TABLE; Schema: public; Owner: postgres
--

CREATE TABLE public.expenses (
    expense_id integer NOT NULL,
    user_id integer NOT NULL,
    expense_timestamp timestamp without time zone DEFAULT now() NOT NULL,
    category_id integer NOT NULL,
    description text NOT NULL,
    amount numeric(10,2) NOT NULL,
    payment_method_id integer NOT NULL,
    receipt_path text,
    created_at timestamp without time zone DEFAULT now() NOT NULL,
    updated_at timestamp without time zone
);


ALTER TABLE public.expenses OWNER TO postgres;

--
-- TOC entry 246 (class 1259 OID 18066)
-- Name: expenses_expense_id_seq; Type: SEQUENCE; Schema: public; Owner: postgres
--

CREATE SEQUENCE public.expenses_expense_id_seq
    AS integer
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1;


ALTER SEQUENCE public.expenses_expense_id_seq OWNER TO postgres;

--
-- TOC entry 4561 (class 0 OID 0)
-- Dependencies: 246
-- Name: expenses_expense_id_seq; Type: SEQUENCE OWNED BY; Schema: public; Owner: postgres
--

ALTER SEQUENCE public.expenses_expense_id_seq OWNED BY public.expenses.expense_id;


--
-- TOC entry 247 (class 1259 OID 18067)
-- Name: landed_cost_allocation_lines; Type: TABLE; Schema: public; Owner: postgres
--

CREATE TABLE public.landed_cost_allocation_lines (
    allocation_line_id bigint NOT NULL,
    allocation_id bigint NOT NULL,
    line_id bigint NOT NULL,
    allocated_amount numeric(14,4) NOT NULL
);


ALTER TABLE public.landed_cost_allocation_lines OWNER TO postgres;

--
-- TOC entry 248 (class 1259 OID 18070)
-- Name: landed_cost_allocation_lines_allocation_line_id_seq; Type: SEQUENCE; Schema: public; Owner: postgres
--

CREATE SEQUENCE public.landed_cost_allocation_lines_allocation_line_id_seq
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1;


ALTER SEQUENCE public.landed_cost_allocation_lines_allocation_line_id_seq OWNER TO postgres;

--
-- TOC entry 4562 (class 0 OID 0)
-- Dependencies: 248
-- Name: landed_cost_allocation_lines_allocation_line_id_seq; Type: SEQUENCE OWNED BY; Schema: public; Owner: postgres
--

ALTER SEQUENCE public.landed_cost_allocation_lines_allocation_line_id_seq OWNED BY public.landed_cost_allocation_lines.allocation_line_id;


--
-- TOC entry 249 (class 1259 OID 18071)
-- Name: landed_cost_allocations; Type: TABLE; Schema: public; Owner: postgres
--

CREATE TABLE public.landed_cost_allocations (
    allocation_id bigint NOT NULL,
    purchase_id bigint NOT NULL,
    total_cost numeric(14,2) NOT NULL,
    method text NOT NULL,
    created_at timestamp without time zone DEFAULT now() NOT NULL
);


ALTER TABLE public.landed_cost_allocations OWNER TO postgres;

--
-- TOC entry 250 (class 1259 OID 18077)
-- Name: landed_cost_allocations_allocation_id_seq; Type: SEQUENCE; Schema: public; Owner: postgres
--

CREATE SEQUENCE public.landed_cost_allocations_allocation_id_seq
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1;


ALTER SEQUENCE public.landed_cost_allocations_allocation_id_seq OWNER TO postgres;

--
-- TOC entry 4563 (class 0 OID 0)
-- Dependencies: 250
-- Name: landed_cost_allocations_allocation_id_seq; Type: SEQUENCE OWNED BY; Schema: public; Owner: postgres
--

ALTER SEQUENCE public.landed_cost_allocations_allocation_id_seq OWNED BY public.landed_cost_allocations.allocation_id;


--
-- TOC entry 251 (class 1259 OID 18078)
-- Name: meter_readings; Type: TABLE; Schema: public; Owner: postgres
--

CREATE TABLE public.meter_readings (
    reading_id integer NOT NULL,
    nozzle_id integer NOT NULL,
    initial_reading numeric(12,2) NOT NULL,
    final_reading numeric(12,2) NOT NULL,
    total_dispensed numeric(12,2) GENERATED ALWAYS AS ((final_reading - initial_reading)) STORED,
    user_id integer NOT NULL,
    created_at timestamp without time zone DEFAULT now() NOT NULL,
    updated_at timestamp without time zone
);


ALTER TABLE public.meter_readings OWNER TO postgres;

--
-- TOC entry 252 (class 1259 OID 18083)
-- Name: meter_readings_reading_id_seq; Type: SEQUENCE; Schema: public; Owner: postgres
--

CREATE SEQUENCE public.meter_readings_reading_id_seq
    AS integer
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1;


ALTER SEQUENCE public.meter_readings_reading_id_seq OWNER TO postgres;

--
-- TOC entry 4564 (class 0 OID 0)
-- Dependencies: 252
-- Name: meter_readings_reading_id_seq; Type: SEQUENCE OWNED BY; Schema: public; Owner: postgres
--

ALTER SEQUENCE public.meter_readings_reading_id_seq OWNED BY public.meter_readings.reading_id;


--
-- TOC entry 253 (class 1259 OID 18084)
-- Name: sales; Type: TABLE; Schema: public; Owner: postgres
--

CREATE TABLE public.sales (
    sale_id integer NOT NULL,
    client_id integer,
    user_id integer,
    employee_id integer,
    nozzle_id integer NOT NULL,
    sale_timestamp timestamp without time zone DEFAULT now() NOT NULL,
    total_amount numeric(10,2) NOT NULL,
    payment_method_id integer NOT NULL,
    status character varying(20) DEFAULT 'completed'::character varying NOT NULL,
    shift character varying(50),
    notes text,
    created_at timestamp without time zone DEFAULT now() NOT NULL,
    discount_amount numeric(10,2) DEFAULT 0,
    final_amount numeric(10,2),
    updated_at timestamp without time zone,
    driver_id integer,
    sector_id integer,
    payment_mode public.sale_payment_mode DEFAULT 'contado'::public.sale_payment_mode NOT NULL,
    CONSTRAINT sales_status_check CHECK (((status)::text = ANY (ARRAY[('completed'::character varying)::text, ('cancelled'::character varying)::text])))
);


ALTER TABLE public.sales OWNER TO postgres;

--
-- TOC entry 4565 (class 0 OID 0)
-- Dependencies: 253
-- Name: COLUMN sales.discount_amount; Type: COMMENT; Schema: public; Owner: postgres
--

COMMENT ON COLUMN public.sales.discount_amount IS 'Monto de descuento aplicado a la venta';


--
-- TOC entry 4566 (class 0 OID 0)
-- Dependencies: 253
-- Name: COLUMN sales.updated_at; Type: COMMENT; Schema: public; Owner: postgres
--

COMMENT ON COLUMN public.sales.updated_at IS 'Fecha de última actualización de la venta';


--
-- TOC entry 254 (class 1259 OID 18095)
-- Name: mv_employee_sales_daily; Type: MATERIALIZED VIEW; Schema: public; Owner: postgres
--

CREATE MATERIALIZED VIEW public.mv_employee_sales_daily AS
 SELECT COALESCE(s.employee_id, '-1'::integer) AS employee_id,
    date(s.sale_timestamp) AS day,
    count(*) AS orders_count,
    sum(s.final_amount) AS total_sales
   FROM public.sales s
  WHERE ((s.status)::text = 'completed'::text)
  GROUP BY COALESCE(s.employee_id, '-1'::integer), (date(s.sale_timestamp))
  WITH NO DATA;


ALTER MATERIALIZED VIEW public.mv_employee_sales_daily OWNER TO postgres;

--
-- TOC entry 255 (class 1259 OID 18101)
-- Name: sale_details; Type: TABLE; Schema: public; Owner: postgres
--

CREATE TABLE public.sale_details (
    sale_detail_id integer NOT NULL,
    sale_id integer NOT NULL,
    product_id integer NOT NULL,
    quantity numeric(10,3) NOT NULL,
    unit_price_at_sale numeric(10,2) NOT NULL,
    discount_amount numeric(10,2) DEFAULT 0 NOT NULL,
    tax_rate numeric(4,2) DEFAULT 0.18 NOT NULL,
    tax_amount numeric(10,2) DEFAULT 0 NOT NULL,
    subtotal numeric(10,2) NOT NULL,
    created_at timestamp without time zone DEFAULT now(),
    updated_at timestamp without time zone
);


ALTER TABLE public.sale_details OWNER TO postgres;

--
-- TOC entry 256 (class 1259 OID 18108)
-- Name: mv_product_sales_by_shift; Type: MATERIALIZED VIEW; Schema: public; Owner: postgres
--

CREATE MATERIALIZED VIEW public.mv_product_sales_by_shift AS
 SELECT sd.product_id,
    s.shift,
    sum(sd.quantity) AS units_sold,
    sum(COALESCE(sd.subtotal, (((sd.quantity * sd.unit_price_at_sale) - COALESCE(sd.discount_amount, (0)::numeric)) + COALESCE(sd.tax_amount, (0)::numeric)))) AS revenue
   FROM (public.sale_details sd
     JOIN public.sales s ON ((s.sale_id = sd.sale_id)))
  WHERE ((s.status)::text = 'completed'::text)
  GROUP BY sd.product_id, s.shift
  WITH NO DATA;


ALTER MATERIALIZED VIEW public.mv_product_sales_by_shift OWNER TO postgres;

--
-- TOC entry 257 (class 1259 OID 18115)
-- Name: mv_product_sales_daily; Type: MATERIALIZED VIEW; Schema: public; Owner: postgres
--

CREATE MATERIALIZED VIEW public.mv_product_sales_daily AS
 SELECT sd.product_id,
    date(s.sale_timestamp) AS day,
    sum(sd.quantity) AS units_sold,
    sum(COALESCE(sd.subtotal, (((sd.quantity * sd.unit_price_at_sale) - COALESCE(sd.discount_amount, (0)::numeric)) + COALESCE(sd.tax_amount, (0)::numeric)))) AS revenue
   FROM (public.sale_details sd
     JOIN public.sales s ON ((s.sale_id = sd.sale_id)))
  WHERE ((s.status)::text = 'completed'::text)
  GROUP BY sd.product_id, (date(s.sale_timestamp))
  WITH NO DATA;


ALTER MATERIALIZED VIEW public.mv_product_sales_daily OWNER TO postgres;

--
-- TOC entry 258 (class 1259 OID 18122)
-- Name: mv_product_sales_monthly; Type: MATERIALIZED VIEW; Schema: public; Owner: postgres
--

CREATE MATERIALIZED VIEW public.mv_product_sales_monthly AS
 SELECT sd.product_id,
    (date_trunc('month'::text, s.sale_timestamp))::date AS month_start,
    sum(sd.quantity) AS units_sold,
    sum(COALESCE(sd.subtotal, (((sd.quantity * sd.unit_price_at_sale) - COALESCE(sd.discount_amount, (0)::numeric)) + COALESCE(sd.tax_amount, (0)::numeric)))) AS revenue
   FROM (public.sale_details sd
     JOIN public.sales s ON ((s.sale_id = sd.sale_id)))
  WHERE ((s.status)::text = 'completed'::text)
  GROUP BY sd.product_id, ((date_trunc('month'::text, s.sale_timestamp))::date)
  WITH NO DATA;


ALTER MATERIALIZED VIEW public.mv_product_sales_monthly OWNER TO postgres;

--
-- TOC entry 259 (class 1259 OID 18129)
-- Name: mv_product_sales_weekly; Type: MATERIALIZED VIEW; Schema: public; Owner: postgres
--

CREATE MATERIALIZED VIEW public.mv_product_sales_weekly AS
 SELECT sd.product_id,
    (date_trunc('week'::text, s.sale_timestamp))::date AS week_start,
    sum(sd.quantity) AS units_sold,
    sum(COALESCE(sd.subtotal, (((sd.quantity * sd.unit_price_at_sale) - COALESCE(sd.discount_amount, (0)::numeric)) + COALESCE(sd.tax_amount, (0)::numeric)))) AS revenue
   FROM (public.sale_details sd
     JOIN public.sales s ON ((s.sale_id = sd.sale_id)))
  WHERE ((s.status)::text = 'completed'::text)
  GROUP BY sd.product_id, ((date_trunc('week'::text, s.sale_timestamp))::date)
  WITH NO DATA;


ALTER MATERIALIZED VIEW public.mv_product_sales_weekly OWNER TO postgres;

--
-- TOC entry 260 (class 1259 OID 18136)
-- Name: mv_product_sales_yearly; Type: MATERIALIZED VIEW; Schema: public; Owner: postgres
--

CREATE MATERIALIZED VIEW public.mv_product_sales_yearly AS
 SELECT sd.product_id,
    (date_trunc('year'::text, s.sale_timestamp))::date AS year_start,
    sum(sd.quantity) AS units_sold,
    sum(COALESCE(sd.subtotal, (((sd.quantity * sd.unit_price_at_sale) - COALESCE(sd.discount_amount, (0)::numeric)) + COALESCE(sd.tax_amount, (0)::numeric)))) AS revenue
   FROM (public.sale_details sd
     JOIN public.sales s ON ((s.sale_id = sd.sale_id)))
  WHERE ((s.status)::text = 'completed'::text)
  GROUP BY sd.product_id, ((date_trunc('year'::text, s.sale_timestamp))::date)
  WITH NO DATA;


ALTER MATERIALIZED VIEW public.mv_product_sales_yearly OWNER TO postgres;

--
-- TOC entry 261 (class 1259 OID 18143)
-- Name: mv_user_sales_daily; Type: MATERIALIZED VIEW; Schema: public; Owner: postgres
--

CREATE MATERIALIZED VIEW public.mv_user_sales_daily AS
 SELECT s.user_id,
    date(s.sale_timestamp) AS day,
    count(*) AS orders_count,
    sum(COALESCE(s.final_amount, s.total_amount)) AS total_sales
   FROM public.sales s
  WHERE ((s.status)::text = 'completed'::text)
  GROUP BY s.user_id, (date(s.sale_timestamp))
  WITH NO DATA;


ALTER MATERIALIZED VIEW public.mv_user_sales_daily OWNER TO postgres;

--
-- TOC entry 262 (class 1259 OID 18149)
-- Name: nozzles; Type: TABLE; Schema: public; Owner: postgres
--

CREATE TABLE public.nozzles (
    nozzle_id integer NOT NULL,
    pump_id integer NOT NULL,
    product_id integer NOT NULL,
    tank_id integer NOT NULL,
    nozzle_number integer NOT NULL,
    created_at timestamp without time zone DEFAULT now() NOT NULL,
    updated_at timestamp without time zone,
    dispenser_id integer,
    estado character varying(50)
);


ALTER TABLE public.nozzles OWNER TO postgres;

--
-- TOC entry 263 (class 1259 OID 18153)
-- Name: nozzles_nozzle_id_seq; Type: SEQUENCE; Schema: public; Owner: postgres
--

CREATE SEQUENCE public.nozzles_nozzle_id_seq
    AS integer
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1;


ALTER SEQUENCE public.nozzles_nozzle_id_seq OWNER TO postgres;

--
-- TOC entry 4567 (class 0 OID 0)
-- Dependencies: 263
-- Name: nozzles_nozzle_id_seq; Type: SEQUENCE OWNED BY; Schema: public; Owner: postgres
--

ALTER SEQUENCE public.nozzles_nozzle_id_seq OWNED BY public.nozzles.nozzle_id;


--
-- TOC entry 264 (class 1259 OID 18154)
-- Name: payment_methods; Type: TABLE; Schema: public; Owner: postgres
--

CREATE TABLE public.payment_methods (
    payment_method_id integer NOT NULL,
    method_name character varying(50) NOT NULL,
    is_active boolean DEFAULT true NOT NULL,
    description text,
    created_at timestamp without time zone DEFAULT now(),
    updated_at timestamp without time zone,
    name character varying(255),
    is_credit boolean DEFAULT false NOT NULL
);


ALTER TABLE public.payment_methods OWNER TO postgres;

--
-- TOC entry 265 (class 1259 OID 18162)
-- Name: payment_methods_payment_method_id_seq; Type: SEQUENCE; Schema: public; Owner: postgres
--

CREATE SEQUENCE public.payment_methods_payment_method_id_seq
    AS integer
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1;


ALTER SEQUENCE public.payment_methods_payment_method_id_seq OWNER TO postgres;

--
-- TOC entry 4568 (class 0 OID 0)
-- Dependencies: 265
-- Name: payment_methods_payment_method_id_seq; Type: SEQUENCE OWNED BY; Schema: public; Owner: postgres
--

ALTER SEQUENCE public.payment_methods_payment_method_id_seq OWNED BY public.payment_methods.payment_method_id;


--
-- TOC entry 266 (class 1259 OID 18163)
-- Name: payments; Type: TABLE; Schema: public; Owner: postgres
--

CREATE TABLE public.payments (
    payment_id integer NOT NULL,
    user_id integer NOT NULL,
    sale_id integer,
    credit_id integer,
    payment_timestamp timestamp without time zone DEFAULT now() NOT NULL,
    amount numeric(10,2) NOT NULL,
    payment_method_id integer NOT NULL,
    notes text,
    payment_type character varying(50),
    status character varying(30) DEFAULT 'completed'::character varying,
    request_key uuid,
    CONSTRAINT chk_payments_amount_positive CHECK ((amount > (0)::numeric)),
    CONSTRAINT payments_check CHECK ((((sale_id IS NOT NULL) AND (credit_id IS NULL)) OR ((sale_id IS NULL) AND (credit_id IS NOT NULL))))
);


ALTER TABLE public.payments OWNER TO postgres;

--
-- TOC entry 267 (class 1259 OID 18172)
-- Name: payments_payment_id_seq; Type: SEQUENCE; Schema: public; Owner: postgres
--

CREATE SEQUENCE public.payments_payment_id_seq
    AS integer
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1;


ALTER SEQUENCE public.payments_payment_id_seq OWNER TO postgres;

--
-- TOC entry 4569 (class 0 OID 0)
-- Dependencies: 267
-- Name: payments_payment_id_seq; Type: SEQUENCE OWNED BY; Schema: public; Owner: postgres
--

ALTER SEQUENCE public.payments_payment_id_seq OWNED BY public.payments.payment_id;


--
-- TOC entry 268 (class 1259 OID 18173)
-- Name: products; Type: TABLE; Schema: public; Owner: postgres
--

CREATE TABLE public.products (
    product_id integer NOT NULL,
    name character varying(255) NOT NULL,
    description text,
    category character varying(20) NOT NULL,
    fuel_type character varying(20),
    unit character varying(10) DEFAULT 'Galón'::character varying NOT NULL,
    unit_price numeric(10,2) NOT NULL,
    is_active boolean DEFAULT true NOT NULL,
    created_at timestamp without time zone DEFAULT now() NOT NULL,
    updated_at timestamp without time zone,
    CONSTRAINT products_category_check CHECK (((category)::text = ANY (ARRAY[('combustible'::character varying)::text, ('aditivo'::character varying)::text, ('accesorio'::character varying)::text, ('otro'::character varying)::text]))),
    CONSTRAINT products_fuel_type_check CHECK (((fuel_type IS NULL) OR (lower((fuel_type)::text) = ANY (ARRAY['diesel'::text, 'premium'::text, 'regular'::text, 'otro'::text]))))
);


ALTER TABLE public.products OWNER TO postgres;

--
-- TOC entry 269 (class 1259 OID 18183)
-- Name: products_product_id_seq; Type: SEQUENCE; Schema: public; Owner: postgres
--

CREATE SEQUENCE public.products_product_id_seq
    AS integer
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1;


ALTER SEQUENCE public.products_product_id_seq OWNER TO postgres;

--
-- TOC entry 4570 (class 0 OID 0)
-- Dependencies: 269
-- Name: products_product_id_seq; Type: SEQUENCE OWNED BY; Schema: public; Owner: postgres
--

ALTER SEQUENCE public.products_product_id_seq OWNED BY public.products.product_id;


--
-- TOC entry 270 (class 1259 OID 18184)
-- Name: pump_tank; Type: TABLE; Schema: public; Owner: postgres
--

CREATE TABLE public.pump_tank (
    id integer NOT NULL,
    pump_id integer NOT NULL,
    tank_id integer NOT NULL,
    created_at timestamp without time zone DEFAULT now(),
    updated_at timestamp without time zone DEFAULT now()
);


ALTER TABLE public.pump_tank OWNER TO postgres;

--
-- TOC entry 271 (class 1259 OID 18189)
-- Name: pump_tank_id_seq; Type: SEQUENCE; Schema: public; Owner: postgres
--

CREATE SEQUENCE public.pump_tank_id_seq
    AS integer
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1;


ALTER SEQUENCE public.pump_tank_id_seq OWNER TO postgres;

--
-- TOC entry 4571 (class 0 OID 0)
-- Dependencies: 271
-- Name: pump_tank_id_seq; Type: SEQUENCE OWNED BY; Schema: public; Owner: postgres
--

ALTER SEQUENCE public.pump_tank_id_seq OWNED BY public.pump_tank.id;


--
-- TOC entry 272 (class 1259 OID 18190)
-- Name: pumps; Type: TABLE; Schema: public; Owner: postgres
--

CREATE TABLE public.pumps (
    pump_id integer NOT NULL,
    pump_number character varying(50) NOT NULL,
    pump_name character varying(100) NOT NULL,
    location_description text,
    created_at timestamp without time zone DEFAULT now() NOT NULL,
    updated_at timestamp without time zone
);


ALTER TABLE public.pumps OWNER TO postgres;

--
-- TOC entry 273 (class 1259 OID 18196)
-- Name: pumps_pump_id_seq; Type: SEQUENCE; Schema: public; Owner: postgres
--

CREATE SEQUENCE public.pumps_pump_id_seq
    AS integer
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1;


ALTER SEQUENCE public.pumps_pump_id_seq OWNER TO postgres;

--
-- TOC entry 4572 (class 0 OID 0)
-- Dependencies: 273
-- Name: pumps_pump_id_seq; Type: SEQUENCE OWNED BY; Schema: public; Owner: postgres
--

ALTER SEQUENCE public.pumps_pump_id_seq OWNED BY public.pumps.pump_id;


--
-- TOC entry 274 (class 1259 OID 18197)
-- Name: purchase_attachments; Type: TABLE; Schema: public; Owner: postgres
--

CREATE TABLE public.purchase_attachments (
    attachment_id bigint NOT NULL,
    purchase_id bigint NOT NULL,
    storage_path text NOT NULL,
    mime_type text NOT NULL,
    original_name text,
    uploaded_by bigint,
    uploaded_at timestamp without time zone DEFAULT now() NOT NULL
);


ALTER TABLE public.purchase_attachments OWNER TO postgres;

--
-- TOC entry 275 (class 1259 OID 18203)
-- Name: purchase_attachments_attachment_id_seq; Type: SEQUENCE; Schema: public; Owner: postgres
--

CREATE SEQUENCE public.purchase_attachments_attachment_id_seq
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1;


ALTER SEQUENCE public.purchase_attachments_attachment_id_seq OWNER TO postgres;

--
-- TOC entry 4573 (class 0 OID 0)
-- Dependencies: 275
-- Name: purchase_attachments_attachment_id_seq; Type: SEQUENCE OWNED BY; Schema: public; Owner: postgres
--

ALTER SEQUENCE public.purchase_attachments_attachment_id_seq OWNED BY public.purchase_attachments.attachment_id;


--
-- TOC entry 276 (class 1259 OID 18204)
-- Name: purchase_lines; Type: TABLE; Schema: public; Owner: postgres
--

CREATE TABLE public.purchase_lines (
    line_id bigint NOT NULL,
    purchase_id bigint NOT NULL,
    line_no integer,
    line_type public.purchase_line_type DEFAULT 'ITEM'::public.purchase_line_type NOT NULL,
    supplier_id bigint,
    invoice_number text,
    discount_header numeric(14,2),
    subtotal_header numeric(14,2),
    tax_header numeric(14,2),
    total_amount numeric(14,2),
    payment_status public.payment_status,
    amount_paid numeric(14,2),
    notes text,
    product_id bigint,
    product_name text,
    quantity numeric(14,3),
    unit_cost numeric(14,4),
    line_discount numeric(14,2),
    subtotal_item numeric(14,2),
    created_at timestamp without time zone DEFAULT now() NOT NULL,
    updated_at timestamp without time zone,
    doc_type_code text,
    series text,
    doc_number text,
    issue_date date,
    due_date date,
    currency_code character(3),
    fx_rate numeric(14,6),
    station_id bigint,
    cost_center_id bigint,
    external_ref text,
    approved_by bigint,
    responsible_received_by bigint,
    attachment_count integer DEFAULT 0 NOT NULL,
    uom text,
    tax_rate numeric(5,2),
    is_tax_exempt boolean DEFAULT false NOT NULL,
    tank_id bigint,
    nozzle_id bigint,
    landed_cost numeric(14,4),
    lot_number text,
    expiry_date date,
    is_capex boolean DEFAULT false NOT NULL,
    note text,
    received_qty numeric(14,3) DEFAULT 0 NOT NULL,
    is_fully_received boolean DEFAULT false NOT NULL,
    CONSTRAINT chk_pl_header CHECK (((line_type <> 'HEADER'::public.purchase_line_type) OR ((line_no = 0) AND (quantity IS NULL) AND (unit_cost IS NULL)))),
    CONSTRAINT chk_pl_item CHECK (((line_type <> 'ITEM'::public.purchase_line_type) OR ((line_no >= 1) AND ((product_name IS NOT NULL) OR (product_id IS NOT NULL)) AND (quantity IS NOT NULL) AND (unit_cost IS NOT NULL))))
);


ALTER TABLE public.purchase_lines OWNER TO postgres;

--
-- TOC entry 277 (class 1259 OID 18218)
-- Name: purchase_lines_line_id_seq; Type: SEQUENCE; Schema: public; Owner: postgres
--

CREATE SEQUENCE public.purchase_lines_line_id_seq
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1;


ALTER SEQUENCE public.purchase_lines_line_id_seq OWNER TO postgres;

--
-- TOC entry 4574 (class 0 OID 0)
-- Dependencies: 277
-- Name: purchase_lines_line_id_seq; Type: SEQUENCE OWNED BY; Schema: public; Owner: postgres
--

ALTER SEQUENCE public.purchase_lines_line_id_seq OWNED BY public.purchase_lines.line_id;


--
-- TOC entry 278 (class 1259 OID 18219)
-- Name: purchase_receipt_lines; Type: TABLE; Schema: public; Owner: postgres
--

CREATE TABLE public.purchase_receipt_lines (
    receipt_line_id bigint NOT NULL,
    receipt_id bigint NOT NULL,
    line_id bigint NOT NULL,
    received_qty numeric(14,3) NOT NULL,
    CONSTRAINT purchase_receipt_lines_received_qty_check CHECK ((received_qty >= (0)::numeric))
);


ALTER TABLE public.purchase_receipt_lines OWNER TO postgres;

--
-- TOC entry 279 (class 1259 OID 18223)
-- Name: purchase_receipt_lines_receipt_line_id_seq; Type: SEQUENCE; Schema: public; Owner: postgres
--

CREATE SEQUENCE public.purchase_receipt_lines_receipt_line_id_seq
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1;


ALTER SEQUENCE public.purchase_receipt_lines_receipt_line_id_seq OWNER TO postgres;

--
-- TOC entry 4575 (class 0 OID 0)
-- Dependencies: 279
-- Name: purchase_receipt_lines_receipt_line_id_seq; Type: SEQUENCE OWNED BY; Schema: public; Owner: postgres
--

ALTER SEQUENCE public.purchase_receipt_lines_receipt_line_id_seq OWNED BY public.purchase_receipt_lines.receipt_line_id;


--
-- TOC entry 280 (class 1259 OID 18224)
-- Name: purchase_receipts; Type: TABLE; Schema: public; Owner: postgres
--

CREATE TABLE public.purchase_receipts (
    receipt_id bigint NOT NULL,
    purchase_id bigint NOT NULL,
    received_at timestamp without time zone DEFAULT now() NOT NULL,
    received_by bigint,
    document_ref text
);


ALTER TABLE public.purchase_receipts OWNER TO postgres;

--
-- TOC entry 281 (class 1259 OID 18230)
-- Name: purchase_receipts_receipt_id_seq; Type: SEQUENCE; Schema: public; Owner: postgres
--

CREATE SEQUENCE public.purchase_receipts_receipt_id_seq
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1;


ALTER SEQUENCE public.purchase_receipts_receipt_id_seq OWNER TO postgres;

--
-- TOC entry 4576 (class 0 OID 0)
-- Dependencies: 281
-- Name: purchase_receipts_receipt_id_seq; Type: SEQUENCE OWNED BY; Schema: public; Owner: postgres
--

ALTER SEQUENCE public.purchase_receipts_receipt_id_seq OWNED BY public.purchase_receipts.receipt_id;


--
-- TOC entry 282 (class 1259 OID 18231)
-- Name: sale_details_sale_detail_id_seq; Type: SEQUENCE; Schema: public; Owner: postgres
--

CREATE SEQUENCE public.sale_details_sale_detail_id_seq
    AS integer
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1;


ALTER SEQUENCE public.sale_details_sale_detail_id_seq OWNER TO postgres;

--
-- TOC entry 4577 (class 0 OID 0)
-- Dependencies: 282
-- Name: sale_details_sale_detail_id_seq; Type: SEQUENCE OWNED BY; Schema: public; Owner: postgres
--

ALTER SEQUENCE public.sale_details_sale_detail_id_seq OWNED BY public.sale_details.sale_detail_id;


--
-- TOC entry 283 (class 1259 OID 18232)
-- Name: sales_sale_id_seq; Type: SEQUENCE; Schema: public; Owner: postgres
--

CREATE SEQUENCE public.sales_sale_id_seq
    AS integer
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1;


ALTER SEQUENCE public.sales_sale_id_seq OWNER TO postgres;

--
-- TOC entry 4578 (class 0 OID 0)
-- Dependencies: 283
-- Name: sales_sale_id_seq; Type: SEQUENCE OWNED BY; Schema: public; Owner: postgres
--

ALTER SEQUENCE public.sales_sale_id_seq OWNED BY public.sales.sale_id;


--
-- TOC entry 284 (class 1259 OID 18233)
-- Name: sector_drivers; Type: TABLE; Schema: public; Owner: postgres
--

CREATE TABLE public.sector_drivers (
    sector_id integer NOT NULL,
    driver_id integer NOT NULL,
    start_date date DEFAULT CURRENT_DATE NOT NULL,
    end_date date
);


ALTER TABLE public.sector_drivers OWNER TO postgres;

--
-- TOC entry 285 (class 1259 OID 18237)
-- Name: sectors; Type: TABLE; Schema: public; Owner: postgres
--

CREATE TABLE public.sectors (
    sector_id integer NOT NULL,
    client_id integer NOT NULL,
    name text NOT NULL,
    code text,
    budget_limit numeric(14,2),
    is_active boolean DEFAULT true NOT NULL,
    created_at timestamp with time zone DEFAULT now() NOT NULL,
    updated_at timestamp without time zone DEFAULT now()
);


ALTER TABLE public.sectors OWNER TO postgres;

--
-- TOC entry 286 (class 1259 OID 18245)
-- Name: sectors_sector_id_seq; Type: SEQUENCE; Schema: public; Owner: postgres
--

CREATE SEQUENCE public.sectors_sector_id_seq
    AS integer
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1;


ALTER SEQUENCE public.sectors_sector_id_seq OWNER TO postgres;

--
-- TOC entry 4579 (class 0 OID 0)
-- Dependencies: 286
-- Name: sectors_sector_id_seq; Type: SEQUENCE OWNED BY; Schema: public; Owner: postgres
--

ALTER SEQUENCE public.sectors_sector_id_seq OWNED BY public.sectors.sector_id;


--
-- TOC entry 287 (class 1259 OID 18246)
-- Name: settings; Type: TABLE; Schema: public; Owner: postgres
--

CREATE TABLE public.settings (
    setting_id integer NOT NULL,
    ruc character varying(11),
    address text,
    phone character varying(50),
    company_name character varying(255),
    email character varying(255),
    web_address character varying(255),
    social_networks jsonb,
    logo text,
    currency character varying(30),
    invoices jsonb,
    created_at timestamp without time zone DEFAULT now(),
    updated_at timestamp without time zone,
    shift_hours jsonb,
    payment_methods text,
    backup_path text
);


ALTER TABLE public.settings OWNER TO postgres;

--
-- TOC entry 288 (class 1259 OID 18252)
-- Name: settings_setting_id_seq; Type: SEQUENCE; Schema: public; Owner: postgres
--

ALTER TABLE public.settings ALTER COLUMN setting_id ADD GENERATED BY DEFAULT AS IDENTITY (
    SEQUENCE NAME public.settings_setting_id_seq
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1
);


--
-- TOC entry 289 (class 1259 OID 18253)
-- Name: shifts; Type: TABLE; Schema: public; Owner: postgres
--

CREATE TABLE public.shifts (
    id integer NOT NULL,
    start_time timestamp without time zone NOT NULL,
    end_time timestamp without time zone,
    opened_by integer,
    closed_by integer,
    initial_amount numeric(10,2) NOT NULL,
    final_amount numeric(10,2),
    created_at timestamp without time zone DEFAULT now()
);


ALTER TABLE public.shifts OWNER TO postgres;

--
-- TOC entry 290 (class 1259 OID 18257)
-- Name: shifts_id_seq; Type: SEQUENCE; Schema: public; Owner: postgres
--

CREATE SEQUENCE public.shifts_id_seq
    AS integer
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1;


ALTER SEQUENCE public.shifts_id_seq OWNER TO postgres;

--
-- TOC entry 4580 (class 0 OID 0)
-- Dependencies: 290
-- Name: shifts_id_seq; Type: SEQUENCE OWNED BY; Schema: public; Owner: postgres
--

ALTER SEQUENCE public.shifts_id_seq OWNED BY public.shifts.id;


--
-- TOC entry 291 (class 1259 OID 18258)
-- Name: stock_movements; Type: TABLE; Schema: public; Owner: postgres
--

CREATE TABLE public.stock_movements (
    stock_movement_id integer NOT NULL,
    product_id integer NOT NULL,
    tank_id integer NOT NULL,
    user_id integer NOT NULL,
    movement_timestamp timestamp without time zone DEFAULT now() NOT NULL,
    movement_type character varying(20) NOT NULL,
    quantity numeric(10,3) NOT NULL,
    sale_detail_id integer,
    delivery_detail_id integer,
    description text
);


ALTER TABLE public.stock_movements OWNER TO postgres;

--
-- TOC entry 292 (class 1259 OID 18264)
-- Name: stock_movements_stock_movement_id_seq; Type: SEQUENCE; Schema: public; Owner: postgres
--

CREATE SEQUENCE public.stock_movements_stock_movement_id_seq
    AS integer
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1;


ALTER SEQUENCE public.stock_movements_stock_movement_id_seq OWNER TO postgres;

--
-- TOC entry 4581 (class 0 OID 0)
-- Dependencies: 292
-- Name: stock_movements_stock_movement_id_seq; Type: SEQUENCE OWNED BY; Schema: public; Owner: postgres
--

ALTER SEQUENCE public.stock_movements_stock_movement_id_seq OWNED BY public.stock_movements.stock_movement_id;


--
-- TOC entry 293 (class 1259 OID 18265)
-- Name: suppliers; Type: TABLE; Schema: public; Owner: postgres
--

CREATE TABLE public.suppliers (
    supplier_id integer NOT NULL,
    supplier_name character varying(255) NOT NULL,
    ruc character varying(11),
    address text,
    phone character varying(50),
    email character varying(255),
    contact_person character varying(255),
    created_at timestamp without time zone DEFAULT now() NOT NULL,
    updated_at timestamp without time zone
);


ALTER TABLE public.suppliers OWNER TO postgres;

--
-- TOC entry 294 (class 1259 OID 18271)
-- Name: suppliers_supplier_id_seq; Type: SEQUENCE; Schema: public; Owner: postgres
--

CREATE SEQUENCE public.suppliers_supplier_id_seq
    AS integer
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1;


ALTER SEQUENCE public.suppliers_supplier_id_seq OWNER TO postgres;

--
-- TOC entry 4582 (class 0 OID 0)
-- Dependencies: 294
-- Name: suppliers_supplier_id_seq; Type: SEQUENCE OWNED BY; Schema: public; Owner: postgres
--

ALTER SEQUENCE public.suppliers_supplier_id_seq OWNED BY public.suppliers.supplier_id;


--
-- TOC entry 295 (class 1259 OID 18272)
-- Name: tanks; Type: TABLE; Schema: public; Owner: postgres
--

CREATE TABLE public.tanks (
    tank_id integer NOT NULL,
    tank_name character varying(100) NOT NULL,
    product_id integer NOT NULL,
    total_capacity numeric(10,3) NOT NULL,
    location character varying(255),
    description text,
    created_at timestamp without time zone DEFAULT now() NOT NULL,
    updated_at timestamp without time zone,
    current_stock numeric(10,3) DEFAULT 0
);


ALTER TABLE public.tanks OWNER TO postgres;

--
-- TOC entry 296 (class 1259 OID 18279)
-- Name: tanks_tank_id_seq; Type: SEQUENCE; Schema: public; Owner: postgres
--

CREATE SEQUENCE public.tanks_tank_id_seq
    AS integer
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1;


ALTER SEQUENCE public.tanks_tank_id_seq OWNER TO postgres;

--
-- TOC entry 4583 (class 0 OID 0)
-- Dependencies: 296
-- Name: tanks_tank_id_seq; Type: SEQUENCE OWNED BY; Schema: public; Owner: postgres
--

ALTER SEQUENCE public.tanks_tank_id_seq OWNED BY public.tanks.tank_id;


--
-- TOC entry 297 (class 1259 OID 18280)
-- Name: user_audit_logs; Type: TABLE; Schema: public; Owner: postgres
--

CREATE TABLE public.user_audit_logs (
    audit_id integer NOT NULL,
    action character varying(20) NOT NULL,
    performed_by integer NOT NULL,
    target_user integer NOT NULL,
    "timestamp" timestamp without time zone DEFAULT now() NOT NULL,
    details jsonb,
    previous_data jsonb,
    CONSTRAINT user_audit_logs_action_check CHECK (((action)::text = ANY (ARRAY[('create'::character varying)::text, ('update'::character varying)::text, ('delete'::character varying)::text, ('activate'::character varying)::text, ('deactivate'::character varying)::text])))
);


ALTER TABLE public.user_audit_logs OWNER TO postgres;

--
-- TOC entry 4584 (class 0 OID 0)
-- Dependencies: 297
-- Name: TABLE user_audit_logs; Type: COMMENT; Schema: public; Owner: postgres
--

COMMENT ON TABLE public.user_audit_logs IS 'Registro de auditoría para operaciones de gestión de usuarios';


--
-- TOC entry 298 (class 1259 OID 18287)
-- Name: user_audit_logs_audit_id_seq; Type: SEQUENCE; Schema: public; Owner: postgres
--

CREATE SEQUENCE public.user_audit_logs_audit_id_seq
    AS integer
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1;


ALTER SEQUENCE public.user_audit_logs_audit_id_seq OWNER TO postgres;

--
-- TOC entry 4585 (class 0 OID 0)
-- Dependencies: 298
-- Name: user_audit_logs_audit_id_seq; Type: SEQUENCE OWNED BY; Schema: public; Owner: postgres
--

ALTER SEQUENCE public.user_audit_logs_audit_id_seq OWNED BY public.user_audit_logs.audit_id;


--
-- TOC entry 299 (class 1259 OID 18288)
-- Name: users; Type: TABLE; Schema: public; Owner: postgres
--

CREATE TABLE public.users (
    user_id integer NOT NULL,
    employee_id integer,
    username character varying(50) NOT NULL,
    password_hash text NOT NULL,
    role character varying(20) NOT NULL,
    permissions jsonb,
    is_active boolean DEFAULT true NOT NULL,
    created_at timestamp without time zone DEFAULT now() NOT NULL,
    updated_at timestamp without time zone,
    full_name character varying(255),
    token_version integer DEFAULT 0 NOT NULL,
    CONSTRAINT users_employee_required_for_seller CHECK (
CASE
    WHEN (lower((role)::text) = ANY (ARRAY['seller'::text, 'vendedor'::text])) THEN (employee_id IS NOT NULL)
    ELSE true
END),
    CONSTRAINT users_role_check CHECK (((role)::text = ANY (ARRAY[('superadmin'::character varying)::text, ('admin'::character varying)::text, ('seller'::character varying)::text])))
);


ALTER TABLE public.users OWNER TO postgres;

--
-- TOC entry 4586 (class 0 OID 0)
-- Dependencies: 299
-- Name: TABLE users; Type: COMMENT; Schema: public; Owner: postgres
--

COMMENT ON TABLE public.users IS 'Tabla de usuarios del sistema con roles jerárquicos';


--
-- TOC entry 4587 (class 0 OID 0)
-- Dependencies: 299
-- Name: COLUMN users.role; Type: COMMENT; Schema: public; Owner: postgres
--

COMMENT ON COLUMN public.users.role IS 'Rol del usuario: superadmin (nivel 3), admin (nivel 2), seller (nivel 1)';


--
-- TOC entry 4588 (class 0 OID 0)
-- Dependencies: 299
-- Name: COLUMN users.permissions; Type: COMMENT; Schema: public; Owner: postgres
--

COMMENT ON COLUMN public.users.permissions IS 'Permisos específicos del usuario en formato JSON';


--
-- TOC entry 300 (class 1259 OID 18298)
-- Name: users_safe_view; Type: VIEW; Schema: public; Owner: postgres
--

CREATE VIEW public.users_safe_view AS
 SELECT users.user_id,
    users.employee_id,
    users.username,
    users.role,
    users.permissions,
    users.is_active,
    users.full_name,
    users.created_at,
    users.updated_at
   FROM public.users;


ALTER VIEW public.users_safe_view OWNER TO postgres;

--
-- TOC entry 301 (class 1259 OID 18302)
-- Name: users_user_id_seq; Type: SEQUENCE; Schema: public; Owner: postgres
--

CREATE SEQUENCE public.users_user_id_seq
    AS integer
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1;


ALTER SEQUENCE public.users_user_id_seq OWNER TO postgres;

--
-- TOC entry 4589 (class 0 OID 0)
-- Dependencies: 301
-- Name: users_user_id_seq; Type: SEQUENCE OWNED BY; Schema: public; Owner: postgres
--

ALTER SEQUENCE public.users_user_id_seq OWNED BY public.users.user_id;


--
-- TOC entry 302 (class 1259 OID 18303)
-- Name: v_credit_fuel_info; Type: VIEW; Schema: public; Owner: postgres
--

CREATE VIEW public.v_credit_fuel_info AS
 SELECT DISTINCT ON (c.credit_id) c.credit_id,
    c.client_id,
    c.sale_id,
    p.product_id,
    p.name AS product_name,
    sd.quantity AS gallons,
    sd.unit_price_at_sale AS unit_price,
    round((sd.quantity * sd.unit_price_at_sale), 2) AS total_soles
   FROM ((public.credits c
     JOIN public.sale_details sd ON ((sd.sale_id = c.sale_id)))
     JOIN public.products p ON ((p.product_id = sd.product_id)))
  WHERE ((p.fuel_type IS NOT NULL) OR ((p.unit)::text = 'Galón'::text))
  ORDER BY c.credit_id, sd.sale_detail_id;


ALTER VIEW public.v_credit_fuel_info OWNER TO postgres;

--
-- TOC entry 303 (class 1259 OID 18308)
-- Name: v_inventory_movements_ui; Type: VIEW; Schema: public; Owner: postgres
--

CREATE VIEW public.v_inventory_movements_ui AS
 SELECT im.user_id,
    (im.movement_timestamp AT TIME ZONE 'America/Lima'::text) AS fecha_hora,
    im.product_id,
    p.name AS producto,
    im.tank_id,
    t.tank_name AS tanque,
        CASE
            WHEN ((im.movement_type)::text = ANY (ARRAY[('in'::character varying)::text, ('delivery'::character varying)::text, ('recepcion'::character varying)::text])) THEN 'Entrada'::text
            WHEN ((im.movement_type)::text = ANY (ARRAY[('out'::character varying)::text, ('sale'::character varying)::text, ('venta'::character varying)::text])) THEN 'Salida'::text
            ELSE initcap((im.movement_type)::text)
        END AS tipo,
    im.quantity AS cantidad,
    COALESCE(NULLIF(TRIM(BOTH FROM im.description), ''::text),
        CASE
            WHEN (im.sale_detail_id IS NOT NULL) THEN 'Por venta'::text
            WHEN (im.delivery_detail_id IS NOT NULL) THEN 'Por recepción'::text
            ELSE 'Ajuste'::text
        END) AS motivo
   FROM ((public.stock_movements im
     LEFT JOIN public.products p ON ((p.product_id = im.product_id)))
     LEFT JOIN public.tanks t ON ((t.tank_id = im.tank_id)));


ALTER VIEW public.v_inventory_movements_ui OWNER TO postgres;

--
-- TOC entry 304 (class 1259 OID 18313)
-- Name: v_municipal_sales_summary; Type: VIEW; Schema: public; Owner: postgres
--

CREATE VIEW public.v_municipal_sales_summary AS
 SELECT s.client_id,
    c.company_name AS client_name,
    s.sector_id,
    sec.name AS sector_name,
    s.driver_id,
    d.full_name AS driver_name,
    count(*) AS sale_count,
    COALESCE(sum(s.total_amount), (0)::numeric) AS sum_total_amount,
    COALESCE(sum(s.final_amount), (0)::numeric) AS sum_final_amount,
    min(s.sale_timestamp) AS first_sale_at,
    max(s.sale_timestamp) AS last_sale_at
   FROM (((public.sales s
     LEFT JOIN public.clients c ON ((c.client_id = s.client_id)))
     LEFT JOIN public.sectors sec ON ((sec.sector_id = s.sector_id)))
     LEFT JOIN public.client_drivers d ON ((d.driver_id = s.driver_id)))
  GROUP BY s.client_id, c.company_name, s.sector_id, sec.name, s.driver_id, d.full_name;


ALTER VIEW public.v_municipal_sales_summary OWNER TO postgres;

--
-- TOC entry 305 (class 1259 OID 18318)
-- Name: v_purchase_details; Type: VIEW; Schema: public; Owner: postgres
--

CREATE VIEW public.v_purchase_details AS
 SELECT purchase_lines.line_id AS detail_line_id,
    purchase_lines.purchase_id,
    purchase_lines.line_no,
    COALESCE(purchase_lines.product_id, (0)::bigint) AS product_id,
    purchase_lines.product_name,
    purchase_lines.uom,
    purchase_lines.quantity,
    purchase_lines.unit_cost,
    COALESCE(purchase_lines.line_discount, (0)::numeric) AS line_discount,
    COALESCE(purchase_lines.subtotal_item, ((COALESCE(purchase_lines.quantity, (0)::numeric) * COALESCE(purchase_lines.unit_cost, (0)::numeric)) - COALESCE(purchase_lines.line_discount, (0)::numeric))) AS subtotal_item,
    COALESCE(purchase_lines.tax_rate, (18)::numeric) AS tax_rate,
    purchase_lines.is_tax_exempt,
    purchase_lines.landed_cost,
    purchase_lines.tank_id,
    purchase_lines.nozzle_id,
    purchase_lines.lot_number,
    purchase_lines.expiry_date,
    purchase_lines.is_capex,
    purchase_lines.note,
    purchase_lines.received_qty,
    purchase_lines.is_fully_received,
    purchase_lines.created_at,
    purchase_lines.updated_at
   FROM public.purchase_lines
  WHERE (purchase_lines.line_type = 'ITEM'::public.purchase_line_type);


ALTER VIEW public.v_purchase_details OWNER TO postgres;

--
-- TOC entry 306 (class 1259 OID 18323)
-- Name: v_purchases; Type: VIEW; Schema: public; Owner: postgres
--

CREATE VIEW public.v_purchases AS
 SELECT purchase_lines.line_id AS header_line_id,
    purchase_lines.purchase_id,
    purchase_lines.supplier_id,
    purchase_lines.invoice_number,
    purchase_lines.doc_type_code,
    purchase_lines.series,
    purchase_lines.doc_number,
    purchase_lines.issue_date,
    purchase_lines.due_date,
    purchase_lines.currency_code,
    purchase_lines.fx_rate,
    COALESCE(purchase_lines.discount_header, (0)::numeric) AS discount,
    COALESCE(purchase_lines.subtotal_header, (0)::numeric) AS subtotal,
    COALESCE(purchase_lines.tax_header, (0)::numeric) AS tax,
    COALESCE(purchase_lines.total_amount, (0)::numeric) AS total_amount,
    purchase_lines.payment_status,
    COALESCE(purchase_lines.amount_paid, (0)::numeric) AS amount_paid,
    purchase_lines.notes,
    purchase_lines.station_id,
    purchase_lines.cost_center_id,
    purchase_lines.attachment_count,
    purchase_lines.created_at,
    purchase_lines.updated_at
   FROM public.purchase_lines
  WHERE (purchase_lines.line_type = 'HEADER'::public.purchase_line_type);


ALTER VIEW public.v_purchases OWNER TO postgres;

--
-- TOC entry 307 (class 1259 OID 18328)
-- Name: v_sales_with_sector; Type: VIEW; Schema: public; Owner: postgres
--

CREATE VIEW public.v_sales_with_sector AS
 SELECT s.sale_id,
    s.sale_timestamp,
    s.client_id,
    s.driver_id,
    s.sector_id,
    sec.name AS sector_name,
    s.total_amount,
    s.final_amount
   FROM (public.sales s
     LEFT JOIN public.sectors sec ON ((sec.sector_id = s.sector_id)));


ALTER VIEW public.v_sales_with_sector OWNER TO postgres;

--
-- TOC entry 308 (class 1259 OID 18333)
-- Name: v_sector_drivers; Type: VIEW; Schema: public; Owner: postgres
--

CREATE VIEW public.v_sector_drivers AS
 SELECT d.driver_id,
    d.full_name,
    d.plate,
    d.company_id AS client_id,
    s.sector_id,
    s.name AS sector_name,
    s.is_active AS sector_active
   FROM (public.client_drivers d
     LEFT JOIN public.sectors s ON ((s.sector_id = d.sector_id)));


ALTER VIEW public.v_sector_drivers OWNER TO postgres;

--
-- TOC entry 309 (class 1259 OID 18337)
-- Name: v_unified_payments; Type: VIEW; Schema: public; Owner: postgres
--

CREATE VIEW public.v_unified_payments AS
 SELECT p.payment_id AS id,
    'AR'::text AS direction,
    p.amount,
    p.payment_timestamp AS paid_at,
    p.user_id AS performed_by,
    p.sale_id AS ref_sale_id,
    p.credit_id AS ref_credit_id,
    NULL::bigint AS ref_bill_id,
    NULL::bigint AS ref_purchase_id,
    NULL::bigint AS payment_method_id
   FROM public.payments p
UNION ALL
 SELECT ap.ap_payment_id AS id,
    'AP'::text AS direction,
    ap.paid_amount AS amount,
    ap.paid_at,
    ap.created_by AS performed_by,
    NULL::bigint AS ref_sale_id,
    NULL::bigint AS ref_credit_id,
    ap.bill_id AS ref_bill_id,
    b.purchase_id AS ref_purchase_id,
    ap.payment_method_id
   FROM (public.ap_payments ap
     JOIN public.ap_bills b ON ((b.bill_id = ap.bill_id)));


ALTER VIEW public.v_unified_payments OWNER TO postgres;

--
-- TOC entry 310 (class 1259 OID 18342)
-- Name: v_users_active; Type: VIEW; Schema: public; Owner: postgres
--

CREATE VIEW public.v_users_active AS
 SELECT users.user_id,
    users.username,
    users.role,
    users.employee_id,
    users.is_active,
    users.created_at,
    users.updated_at
   FROM public.users
  WHERE (users.is_active = true);


ALTER VIEW public.v_users_active OWNER TO postgres;

--
-- TOC entry 311 (class 1259 OID 18346)
-- Name: v_users_all; Type: VIEW; Schema: public; Owner: postgres
--

CREATE VIEW public.v_users_all AS
 SELECT users.user_id,
    users.username,
    users.role,
    users.employee_id,
    users.is_active,
    users.created_at,
    users.updated_at
   FROM public.users;


ALTER VIEW public.v_users_all OWNER TO postgres;

--
-- TOC entry 312 (class 1259 OID 18350)
-- Name: ventas_por_empleado_view; Type: VIEW; Schema: public; Owner: postgres
--

CREATE VIEW public.ventas_por_empleado_view AS
 SELECT e.employee_id,
    concat_ws(' '::text, e.first_name, e.last_name) AS employee_name,
    count(s.sale_id) AS orders_count,
    sum(s.total_amount) AS total_sales
   FROM (public.sales s
     LEFT JOIN public.employees e ON ((s.employee_id = e.employee_id)))
  GROUP BY e.employee_id, (concat_ws(' '::text, e.first_name, e.last_name));


ALTER VIEW public.ventas_por_empleado_view OWNER TO postgres;

--
-- TOC entry 313 (class 1259 OID 18355)
-- Name: ventas_por_usuario_view; Type: VIEW; Schema: public; Owner: postgres
--

CREATE VIEW public.ventas_por_usuario_view AS
 SELECT u.user_id,
    u.username,
    u.full_name,
    count(s.sale_id) AS orders_count,
    sum(s.total_amount) AS total_sales
   FROM (public.sales s
     LEFT JOIN public.users u ON ((u.employee_id = s.employee_id)))
  GROUP BY u.user_id, u.username, u.full_name;


ALTER VIEW public.ventas_por_usuario_view OWNER TO postgres;

--
-- TOC entry 3813 (class 2604 OID 18360)
-- Name: ap_bills bill_id; Type: DEFAULT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.ap_bills ALTER COLUMN bill_id SET DEFAULT nextval('public.ap_bills_bill_id_seq'::regclass);


--
-- TOC entry 3817 (class 2604 OID 18361)
-- Name: ap_payments ap_payment_id; Type: DEFAULT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.ap_payments ALTER COLUMN ap_payment_id SET DEFAULT nextval('public.ap_payments_ap_payment_id_seq'::regclass);


--
-- TOC entry 3819 (class 2604 OID 18362)
-- Name: backup_config id; Type: DEFAULT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.backup_config ALTER COLUMN id SET DEFAULT nextval('public.backup_config_id_seq'::regclass);


--
-- TOC entry 3823 (class 2604 OID 18363)
-- Name: backup_history id; Type: DEFAULT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.backup_history ALTER COLUMN id SET DEFAULT nextval('public.backup_history_id_seq'::regclass);


--
-- TOC entry 3825 (class 2604 OID 18364)
-- Name: cash_box_sessions id; Type: DEFAULT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.cash_box_sessions ALTER COLUMN id SET DEFAULT nextval('public.cash_box_sessions_id_seq'::regclass);


--
-- TOC entry 3829 (class 2604 OID 18365)
-- Name: cash_registers id; Type: DEFAULT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.cash_registers ALTER COLUMN id SET DEFAULT nextval('public.cash_registers_id_seq'::regclass);


--
-- TOC entry 3831 (class 2604 OID 18366)
-- Name: client_credit_limits id; Type: DEFAULT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.client_credit_limits ALTER COLUMN id SET DEFAULT nextval('public.client_credit_limits_id_seq'::regclass);


--
-- TOC entry 3835 (class 2604 OID 18367)
-- Name: client_drivers driver_id; Type: DEFAULT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.client_drivers ALTER COLUMN driver_id SET DEFAULT nextval('public.client_drivers_driver_id_seq'::regclass);


--
-- TOC entry 3839 (class 2604 OID 18368)
-- Name: client_product_gallon_limits id; Type: DEFAULT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.client_product_gallon_limits ALTER COLUMN id SET DEFAULT nextval('public.client_product_gallon_limits_id_seq'::regclass);


--
-- TOC entry 3938 (class 2604 OID 19898)
-- Name: client_product_rules rule_id; Type: DEFAULT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.client_product_rules ALTER COLUMN rule_id SET DEFAULT nextval('public.client_product_rules_rule_id_seq'::regclass);


--
-- TOC entry 3845 (class 2604 OID 18369)
-- Name: clients client_id; Type: DEFAULT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.clients ALTER COLUMN client_id SET DEFAULT nextval('public.clients_client_id_seq'::regclass);


--
-- TOC entry 3848 (class 2604 OID 18370)
-- Name: credits credit_id; Type: DEFAULT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.credits ALTER COLUMN credit_id SET DEFAULT nextval('public.credits_credit_id_seq'::regclass);


--
-- TOC entry 3852 (class 2604 OID 18371)
-- Name: deliveries delivery_id; Type: DEFAULT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.deliveries ALTER COLUMN delivery_id SET DEFAULT nextval('public.deliveries_delivery_id_seq'::regclass);


--
-- TOC entry 3854 (class 2604 OID 18372)
-- Name: delivery_details delivery_detail_id; Type: DEFAULT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.delivery_details ALTER COLUMN delivery_detail_id SET DEFAULT nextval('public.delivery_details_delivery_detail_id_seq'::regclass);


--
-- TOC entry 3855 (class 2604 OID 18373)
-- Name: discounts id; Type: DEFAULT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.discounts ALTER COLUMN id SET DEFAULT nextval('public.discounts_id_seq'::regclass);


--
-- TOC entry 3860 (class 2604 OID 18374)
-- Name: dispensers dispenser_id; Type: DEFAULT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.dispensers ALTER COLUMN dispenser_id SET DEFAULT nextval('public.dispensers_dispenser_id_seq'::regclass);


--
-- TOC entry 3862 (class 2604 OID 18375)
-- Name: employees employee_id; Type: DEFAULT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.employees ALTER COLUMN employee_id SET DEFAULT nextval('public.employees_employee_id_seq'::regclass);


--
-- TOC entry 3865 (class 2604 OID 18376)
-- Name: expense_categories category_id; Type: DEFAULT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.expense_categories ALTER COLUMN category_id SET DEFAULT nextval('public.expense_categories_category_id_seq'::regclass);


--
-- TOC entry 3866 (class 2604 OID 18377)
-- Name: expenses expense_id; Type: DEFAULT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.expenses ALTER COLUMN expense_id SET DEFAULT nextval('public.expenses_expense_id_seq'::regclass);


--
-- TOC entry 3869 (class 2604 OID 18378)
-- Name: landed_cost_allocation_lines allocation_line_id; Type: DEFAULT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.landed_cost_allocation_lines ALTER COLUMN allocation_line_id SET DEFAULT nextval('public.landed_cost_allocation_lines_allocation_line_id_seq'::regclass);


--
-- TOC entry 3870 (class 2604 OID 18379)
-- Name: landed_cost_allocations allocation_id; Type: DEFAULT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.landed_cost_allocations ALTER COLUMN allocation_id SET DEFAULT nextval('public.landed_cost_allocations_allocation_id_seq'::regclass);


--
-- TOC entry 3872 (class 2604 OID 18380)
-- Name: meter_readings reading_id; Type: DEFAULT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.meter_readings ALTER COLUMN reading_id SET DEFAULT nextval('public.meter_readings_reading_id_seq'::regclass);


--
-- TOC entry 3886 (class 2604 OID 18381)
-- Name: nozzles nozzle_id; Type: DEFAULT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.nozzles ALTER COLUMN nozzle_id SET DEFAULT nextval('public.nozzles_nozzle_id_seq'::regclass);


--
-- TOC entry 3888 (class 2604 OID 18382)
-- Name: payment_methods payment_method_id; Type: DEFAULT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.payment_methods ALTER COLUMN payment_method_id SET DEFAULT nextval('public.payment_methods_payment_method_id_seq'::regclass);


--
-- TOC entry 3892 (class 2604 OID 18383)
-- Name: payments payment_id; Type: DEFAULT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.payments ALTER COLUMN payment_id SET DEFAULT nextval('public.payments_payment_id_seq'::regclass);


--
-- TOC entry 3895 (class 2604 OID 18384)
-- Name: products product_id; Type: DEFAULT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.products ALTER COLUMN product_id SET DEFAULT nextval('public.products_product_id_seq'::regclass);


--
-- TOC entry 3899 (class 2604 OID 18385)
-- Name: pump_tank id; Type: DEFAULT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.pump_tank ALTER COLUMN id SET DEFAULT nextval('public.pump_tank_id_seq'::regclass);


--
-- TOC entry 3902 (class 2604 OID 18386)
-- Name: pumps pump_id; Type: DEFAULT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.pumps ALTER COLUMN pump_id SET DEFAULT nextval('public.pumps_pump_id_seq'::regclass);


--
-- TOC entry 3904 (class 2604 OID 18387)
-- Name: purchase_attachments attachment_id; Type: DEFAULT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.purchase_attachments ALTER COLUMN attachment_id SET DEFAULT nextval('public.purchase_attachments_attachment_id_seq'::regclass);


--
-- TOC entry 3906 (class 2604 OID 18388)
-- Name: purchase_lines line_id; Type: DEFAULT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.purchase_lines ALTER COLUMN line_id SET DEFAULT nextval('public.purchase_lines_line_id_seq'::regclass);


--
-- TOC entry 3914 (class 2604 OID 18389)
-- Name: purchase_receipt_lines receipt_line_id; Type: DEFAULT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.purchase_receipt_lines ALTER COLUMN receipt_line_id SET DEFAULT nextval('public.purchase_receipt_lines_receipt_line_id_seq'::regclass);


--
-- TOC entry 3915 (class 2604 OID 18390)
-- Name: purchase_receipts receipt_id; Type: DEFAULT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.purchase_receipts ALTER COLUMN receipt_id SET DEFAULT nextval('public.purchase_receipts_receipt_id_seq'::regclass);


--
-- TOC entry 3881 (class 2604 OID 18391)
-- Name: sale_details sale_detail_id; Type: DEFAULT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.sale_details ALTER COLUMN sale_detail_id SET DEFAULT nextval('public.sale_details_sale_detail_id_seq'::regclass);


--
-- TOC entry 3875 (class 2604 OID 18392)
-- Name: sales sale_id; Type: DEFAULT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.sales ALTER COLUMN sale_id SET DEFAULT nextval('public.sales_sale_id_seq'::regclass);


--
-- TOC entry 3918 (class 2604 OID 18393)
-- Name: sectors sector_id; Type: DEFAULT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.sectors ALTER COLUMN sector_id SET DEFAULT nextval('public.sectors_sector_id_seq'::regclass);


--
-- TOC entry 3923 (class 2604 OID 18394)
-- Name: shifts id; Type: DEFAULT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.shifts ALTER COLUMN id SET DEFAULT nextval('public.shifts_id_seq'::regclass);


--
-- TOC entry 3925 (class 2604 OID 18395)
-- Name: stock_movements stock_movement_id; Type: DEFAULT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.stock_movements ALTER COLUMN stock_movement_id SET DEFAULT nextval('public.stock_movements_stock_movement_id_seq'::regclass);


--
-- TOC entry 3927 (class 2604 OID 18396)
-- Name: suppliers supplier_id; Type: DEFAULT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.suppliers ALTER COLUMN supplier_id SET DEFAULT nextval('public.suppliers_supplier_id_seq'::regclass);


--
-- TOC entry 3929 (class 2604 OID 18397)
-- Name: tanks tank_id; Type: DEFAULT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.tanks ALTER COLUMN tank_id SET DEFAULT nextval('public.tanks_tank_id_seq'::regclass);


--
-- TOC entry 3932 (class 2604 OID 18398)
-- Name: user_audit_logs audit_id; Type: DEFAULT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.user_audit_logs ALTER COLUMN audit_id SET DEFAULT nextval('public.user_audit_logs_audit_id_seq'::regclass);


--
-- TOC entry 3934 (class 2604 OID 18399)
-- Name: users user_id; Type: DEFAULT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.users ALTER COLUMN user_id SET DEFAULT nextval('public.users_user_id_seq'::regclass);


--
-- TOC entry 4442 (class 0 OID 17927)
-- Dependencies: 211
-- Data for Name: ap_bills; Type: TABLE DATA; Schema: public; Owner: postgres
--

COPY public.ap_bills (bill_id, purchase_id, supplier_id, currency_code, original_amount, balance_amount, status, issue_date, due_date, created_at) FROM stdin;
1	9001	5	PEN	148.00	98.00	PARTIAL	2025-10-13	\N	2025-10-13 15:39:57.454472
\.


--
-- TOC entry 4444 (class 0 OID 17936)
-- Dependencies: 213
-- Data for Name: ap_payments; Type: TABLE DATA; Schema: public; Owner: postgres
--

COPY public.ap_payments (ap_payment_id, bill_id, paid_amount, payment_method_id, paid_at, notes, created_by) FROM stdin;
1	1	50.00	\N	2025-10-13 15:45:01.537195	Pago parcial de prueba	\N
\.


--
-- TOC entry 4446 (class 0 OID 17943)
-- Dependencies: 215
-- Data for Name: backup_config; Type: TABLE DATA; Schema: public; Owner: postgres
--

COPY public.backup_config (id, frequency, time_of_day, day_of_week, day_of_month, specific_day, month, storage_type, is_active, is_default, created_at) FROM stdin;
1	Desactivado	00:00:00	\N	\N	\N	\N	local	t	t	2025-09-16 13:45:43.042808
\.


--
-- TOC entry 4448 (class 0 OID 17950)
-- Dependencies: 217
-- Data for Name: backup_history; Type: TABLE DATA; Schema: public; Owner: postgres
--

COPY public.backup_history (id, filename, path, created_at, status, type, action, user_id, error) FROM stdin;
1	grifosis_Manual_Backup_2025-09-16T18-45-47-532Z_42370f78.dump	/var/backups/grifosis/grifosis_Manual_Backup_2025-09-16T18-45-47-532Z_42370f78.dump	2025-09-16 13:46:10.376249	✅ Exitoso	Manual	Backup	3	\N
2	grifosis_Manual_Backup_2025-09-22T21-13-55-391Z_77773e71.dump	var/backups/grifosis/grifosis_Manual_Backup_2025-09-22T21-13-55-391Z_77773e71.dump	2025-09-22 16:13:55.482836	✅ Exitoso	Manual	Backup	4	\N
3	grifosis_Manual_Backup_2025-09-22T21-15-12-994Z_8be8bd34.dump	var/backups/grifosis/grifosis_Manual_Backup_2025-09-22T21-15-12-994Z_8be8bd34.dump	2025-09-22 16:15:13.125689	✅ Exitoso	Manual	Backup	4	\N
\.


--
-- TOC entry 4450 (class 0 OID 17957)
-- Dependencies: 219
-- Data for Name: cash_box_sessions; Type: TABLE DATA; Schema: public; Owner: postgres
--

COPY public.cash_box_sessions (id, day_date, shift_name, opened_at, opened_by, opening_amount, closed_at, closed_by, closing_amount, sales_amount, notes, is_closed, opened_by_name, closed_by_name) FROM stdin;
1	2025-09-16	Lobo	2025-09-16 17:10:15.909223-05	3	10.00	\N	\N	\N	\N	\N	f	Administrador General	\N
2	2025-09-17	Leon	2025-09-17 11:56:30.048032-05	12	0.00	\N	\N	\N	\N	\N	f	Administrador General	\N
3	2025-09-18	Buho	2025-09-18 16:26:15.134965-05	4	0.00	\N	\N	\N	\N	\N	f	Jesus Gonzalo	\N
4	2025-09-19	Buho	2025-09-19 11:34:17.659891-05	4	0.00	2025-09-19 11:47:24.493126-05	4	0.00	0.00	El control de caja por el momento no tiene ninguna observación.	t	Jesus Gonzalo	Jesus Gonzalo
5	2025-09-19	Buho	2025-09-19 11:48:40.1248-05	4	0.00	2025-09-19 12:03:48.664304-05	4	0.00	20.00	El control de caja por el momento no tiene ninguna observación.	t	Jesus Gonzalo	Jesus Gonzalo
6	2025-09-19	Buho	2025-09-19 12:05:30.67388-05	4	0.00	2025-09-19 12:09:09.369968-05	4	0.00	20.00	El control de caja por el momento no tiene ninguna observación.	t	Jesus Gonzalo	Jesus Gonzalo
7	2025-09-19	Buho	2025-09-19 12:09:13.750694-05	4	0.00	2025-09-19 12:24:39.182353-05	4	0.00	20.00	El control de caja por el momento no tiene ninguna observación.	t	Jesus Gonzalo	Jesus Gonzalo
8	2025-09-19	Buho	2025-09-19 12:24:40.755457-05	4	0.00	2025-09-19 12:26:14.064143-05	4	0.00	20.00	El control de caja por el momento no tiene ninguna observación.	t	Jesus Gonzalo	Jesus Gonzalo
9	2025-09-19	Buho	2025-09-19 12:38:24.720167-05	4	0.00	2025-09-19 12:38:27.809269-05	4	0.00	0.00	El control de caja por el momento no tiene ninguna observación.	t	Jesus Gonzalo	Jesus Gonzalo
10	2025-09-19	Buho	2025-09-19 13:05:07.572573-05	4	0.00	2025-09-19 13:05:10.337759-05	4	0.00	0.00	El control de caja por el momento no tiene ninguna observación.	t	Jesus Gonzalo	Jesus Gonzalo
11	2025-09-19	Buho	2025-09-19 13:44:24.093304-05	4	0.00	2025-09-19 13:44:25.490035-05	4	0.00	0.00	El control de caja por el momento no tiene ninguna observación.	t	Jesus Gonzalo	Jesus Gonzalo
12	2025-09-19	Leon	2025-09-19 14:29:23.15229-05	4	0.00	2025-09-19 14:30:06.982723-05	4	0.00	175.00	El control de caja por el momento no tiene ninguna observación.	t	Jesus Gonzalo	Jesus Gonzalo
13	2025-09-19	Leon	2025-09-19 14:47:24.447961-05	4	0.00	2025-09-19 15:20:17.946421-05	3	0.00	20.00	El control de caja por el momento no tiene ninguna observación.	t	Jesus Gonzalo	Administrador General
14	2025-09-19	Lobo	2025-09-19 15:21:16.570375-05	12	1244.00	\N	\N	\N	\N	\N	f	Administrador General	\N
15	2025-09-22	Leon	2025-09-22 12:00:59.720587-05	4	0.00	\N	\N	\N	\N	\N	f	Jesus Gonzalo	\N
16	2025-09-23	Lobo	2025-09-23 11:41:38.725809-05	4	0.00	\N	\N	\N	\N	\N	f	Jesus Gonzalo	\N
17	2025-09-24	Lobo	2025-09-24 11:57:25.124754-05	4	0.00	2025-09-24 12:43:08.847706-05	4	0.00	0.00	El control de caja por el momento no tiene ninguna observación.	t	Jesus Gonzalo	Jesus Gonzalo
18	2025-09-24	Leon	2025-09-24 12:43:14.671264-05	4	0.00	2025-09-24 12:43:27.07985-05	4	0.00	30.00	El control de caja por el momento no tiene ninguna observación.	t	Jesus Gonzalo	Jesus Gonzalo
19	2025-09-24	Leon	2025-09-24 14:20:04.517432-05	4	0.00	2025-09-24 14:20:24.400835-05	4	0.00	150.00	El control de caja por el momento no tiene ninguna observación.	t	Jesus Gonzalo	Jesus Gonzalo
20	2025-09-25	Leon	2025-09-25 13:50:32.225827-05	4	0.00	2025-09-25 13:50:43.216698-05	4	0.00	0.00	El control de caja por el momento no tiene ninguna observación.	t	Jesus Gonzalo	Jesus Gonzalo
21	2025-09-25	Leon	2025-09-25 14:08:06.930507-05	4	0.00	2025-09-25 14:08:46.664031-05	4	0.00	1090.00	El control de caja por el momento no tiene ninguna observación.	t	Jesus Gonzalo	Jesus Gonzalo
22	2025-09-26	Lobo	2025-09-26 10:16:46.364954-05	12	1.00	2025-09-26 10:45:05.566121-05	4	0.00	283.20	El control de caja por el momento no tiene ninguna observación.	t	Administrador General	Jesus Gonzalo
23	2025-09-26	Lobo	2025-09-26 10:45:11.976041-05	4	0.00	2025-09-26 10:45:16.70717-05	4	0.00	283.20	El control de caja por el momento no tiene ninguna observación.	t	Jesus Gonzalo	Jesus Gonzalo
24	2025-09-26	Lobo	2025-09-26 11:04:50.840132-05	4	0.00	2025-09-26 11:04:53.158495-05	4	0.00	283.20	El control de caja por el momento no tiene ninguna observación.	t	Jesus Gonzalo	Jesus Gonzalo
25	2025-09-26	Leon	2025-09-26 13:19:56.508332-05	4	0.00	2025-09-26 13:19:58.102333-05	4	0.00	0.00	El control de caja por el momento no tiene ninguna observación.	t	Jesus Gonzalo	Jesus Gonzalo
26	2025-09-26	Leon	2025-09-26 13:50:50.991858-05	4	0.00	2025-09-26 13:51:33.058761-05	4	0.00	1800.00	El control de caja por el momento no tiene ninguna observación.	t	Jesus Gonzalo	Jesus Gonzalo
27	2025-09-26	Leon	2025-09-26 14:01:54.889853-05	12	123.00	2025-09-26 14:07:24.952769-05	4	0.00	1823.00	El control de caja por el momento no tiene ninguna observación.	t	Administrador General	Jesus Gonzalo
28	2025-09-26	Leon	2025-09-26 14:08:23.643826-05	4	0.00	2025-09-26 14:09:42.320911-05	4	0.00	2993.00	El control de caja por el momento no tiene ninguna observación.	t	Jesus Gonzalo	Jesus Gonzalo
29	2025-09-26	Leon	2025-09-26 15:18:56.008361-05	4	0.00	2025-09-26 15:18:59.047511-05	4	0.00	2993.00	El control de caja por el momento no tiene ninguna observación.	t	Jesus Gonzalo	Jesus Gonzalo
30	2025-09-26	Leon	2025-09-26 15:40:58.855021-05	4	0.00	2025-09-26 15:41:00.554942-05	4	0.00	2993.00	El control de caja por el momento no tiene ninguna observación.	t	Jesus Gonzalo	Jesus Gonzalo
31	2025-09-26	Leon	2025-09-26 15:53:13.520206-05	4	0.00	2025-09-26 15:53:23.407647-05	4	0.00	3293.00	El control de caja por el momento no tiene ninguna observación.	t	Jesus Gonzalo	Jesus Gonzalo
32	2025-09-26	Leon	2025-09-26 16:04:21.806357-05	4	0.00	2025-09-26 16:04:23.465823-05	4	0.00	3293.00	El control de caja por el momento no tiene ninguna observación.	t	Jesus Gonzalo	Jesus Gonzalo
33	2025-09-26	Leon	2025-09-26 16:15:57.955185-05	4	0.00	2025-09-26 16:16:14.956666-05	4	0.00	4493.00	El control de caja por el momento no tiene ninguna observación.	t	Jesus Gonzalo	Jesus Gonzalo
34	2025-09-26	Leon	2025-09-26 16:25:28.594915-05	4	0.00	2025-09-26 16:25:40.234858-05	4	0.00	5393.00	El control de caja por el momento no tiene ninguna observación.	t	Jesus Gonzalo	Jesus Gonzalo
35	2025-09-26	Leon	2025-09-26 16:47:24.295101-05	4	0.00	2025-09-26 16:47:35.981762-05	4	0.00	5588.00	El control de caja por el momento no tiene ninguna observación.	t	Jesus Gonzalo	Jesus Gonzalo
36	2025-09-29	Lobo	2025-09-29 11:33:18.214775-05	4	0.00	2025-09-29 11:34:49.161962-05	4	0.00	18540.00	El control de caja por el momento no tiene ninguna observación.	t	Jesus Gonzalo	Jesus Gonzalo
37	2025-09-29	Leon	2025-09-29 12:09:47.115062-05	4	0.00	2025-09-29 12:10:24.196892-05	4	0.00	1066.00	El control de caja por el momento no tiene ninguna observación.	t	Jesus Gonzalo	Jesus Gonzalo
38	2025-09-29	Leon	2025-09-29 12:11:25.161954-05	4	0.00	2025-09-29 12:11:44.130853-05	4	0.00	1332.00	El control de caja por el momento no tiene ninguna observación.	t	Jesus Gonzalo	Jesus Gonzalo
39	2025-09-29	Leon	2025-09-29 12:12:35.54488-05	4	0.00	2025-09-29 12:13:27.874428-05	4	0.00	2532.00	El control de caja por el momento no tiene ninguna observación.	t	Jesus Gonzalo	Jesus Gonzalo
40	2025-09-29	Leon	2025-09-29 12:16:00.79605-05	4	0.00	2025-09-29 12:16:16.295575-05	4	0.00	4334.00	El control de caja por el momento no tiene ninguna observación.	t	Jesus Gonzalo	Jesus Gonzalo
41	2025-09-29	Leon	2025-09-29 13:32:37.797116-05	4	0.00	2025-09-29 13:33:52.073861-05	4	0.00	4854.00	El control de caja por el momento no tiene ninguna observación.	t	Jesus Gonzalo	Jesus Gonzalo
42	2025-09-29	Leon	2025-09-29 14:46:28.162213-05	4	0.00	2025-09-29 14:46:50.458157-05	4	0.00	5441.00	El control de caja por el momento no tiene ninguna observación.	t	Jesus Gonzalo	Jesus Gonzalo
43	2025-09-29	Leon	2025-09-29 15:10:36.915367-05	4	0.00	2025-09-29 15:11:17.020473-05	4	0.00	6637.00	El control de caja por el momento no tiene ninguna observación.	t	Jesus Gonzalo	Jesus Gonzalo
44	2025-09-29	Leon	2025-09-29 15:21:48.744395-05	12	12.00	2025-09-29 16:17:06.184491-05	4	0.00	7796.00	El control de caja por el momento no tiene ninguna observación.	t	Administrador General	Jesus Gonzalo
45	2025-09-29	Leon	2025-09-29 16:17:15.691429-05	4	0.00	2025-09-29 16:17:48.442223-05	4	0.00	7393.00	El control de caja por el momento no tiene ninguna observación.	t	Jesus Gonzalo	Jesus Gonzalo
46	2025-09-29	Leon	2025-09-29 16:27:58.74948-05	4	0.00	2025-09-29 16:28:17.509193-05	4	0.00	7878.00	El control de caja por el momento no tiene ninguna observación.	t	Jesus Gonzalo	Jesus Gonzalo
66	2025-10-01	Leon	2025-10-01 13:41:26.694937-05	4	0.00	2025-10-01 13:41:45.857395-05	4	0.00	7051.50	El control de caja por el momento no tiene ninguna observación.	t	Jesus Gonzalo	Jesus Gonzalo
47	2025-09-30	Lobo	2025-09-30 11:44:16.750066-05	4	0.00	2025-09-30 11:44:48.687876-05	4	0.00	609.00	El control de caja por el momento no tiene ninguna observación.	t	Jesus Gonzalo	Jesus Gonzalo
67	2025-10-01	Leon	2025-10-01 13:50:37.647738-05	4	0.00	2025-10-01 13:50:56.211857-05	4	0.00	8221.50	El control de caja por el momento no tiene ninguna observación.	t	Jesus Gonzalo	Jesus Gonzalo
48	2025-09-30	Lobo	2025-09-30 11:45:00.363457-05	4	0.00	2025-09-30 11:45:12.648361-05	4	0.00	2169.00	El control de caja por el momento no tiene ninguna observación.	t	Jesus Gonzalo	Jesus Gonzalo
49	2025-09-30	Leon	2025-09-30 12:28:37.519823-05	4	0.00	2025-09-30 12:28:47.172342-05	4	0.00	35.00	El control de caja por el momento no tiene ninguna observación.	t	Jesus Gonzalo	Jesus Gonzalo
68	2025-10-01	Leon	2025-10-01 13:51:32.536814-05	4	0.00	2025-10-01 13:51:46.663281-05	4	0.00	9391.50	El control de caja por el momento no tiene ninguna observación.	t	Jesus Gonzalo	Jesus Gonzalo
50	2025-09-30	Leon	2025-09-30 12:49:05.353773-05	4	0.00	2025-09-30 12:49:31.654833-05	4	0.00	504.00	El control de caja por el momento no tiene ninguna observación.	t	Jesus Gonzalo	Jesus Gonzalo
51	2025-09-30	Leon	2025-09-30 13:07:01.614625-05	4	0.00	2025-09-30 13:08:18.395612-05	4	0.00	1011.00	El control de caja por el momento no tiene ninguna observación.	t	Jesus Gonzalo	Jesus Gonzalo
69	2025-10-01	Leon	2025-10-01 16:04:56.249928-05	4	0.00	2025-10-01 16:24:29.686669-05	4	0.00	9391.50	El control de caja por el momento no tiene ninguna observación.	t	Jesus Gonzalo	Jesus Gonzalo
52	2025-09-30	Leon	2025-09-30 13:49:02.642954-05	12	0.00	2025-09-30 13:58:57.998002-05	4	0.00	1011.00	El control de caja por el momento no tiene ninguna observación.	t	Administrador General	Jesus Gonzalo
53	2025-09-30	Leon	2025-09-30 13:59:07.226076-05	4	0.00	2025-09-30 13:59:26.708914-05	4	0.00	1148.00	El control de caja por el momento no tiene ninguna observación.	t	Jesus Gonzalo	Jesus Gonzalo
70	2025-10-01	Leon	2025-10-01 16:24:30.865764-05	4	0.00	2025-10-01 16:24:49.585799-05	4	0.00	10483.50	El control de caja por el momento no tiene ninguna observación.	t	Jesus Gonzalo	Jesus Gonzalo
54	2025-09-30	Leon	2025-09-30 13:59:49.138065-05	12	123.00	2025-09-30 14:12:02.351573-05	4	0.00	3708.50	El control de caja por el momento no tiene ninguna observación.	t	Administrador General	Jesus Gonzalo
55	2025-09-30	Leon	2025-09-30 14:17:14.399403-05	4	0.00	2025-09-30 14:17:37.630705-05	4	0.00	3791.50	El control de caja por el momento no tiene ninguna observación.	t	Jesus Gonzalo	Jesus Gonzalo
71	2025-10-03	Lobo	2025-10-03 10:59:14.549877-05	4	0.00	2025-10-03 10:59:40.416914-05	4	0.00	1170.00	El control de caja por el momento no tiene ninguna observación.	t	Jesus Gonzalo	Jesus Gonzalo
56	2025-09-30	Leon	2025-09-30 14:18:49.385022-05	4	0.00	2025-09-30 14:19:13.500742-05	4	0.00	5137.00	El control de caja por el momento no tiene ninguna observación.	t	Jesus Gonzalo	Jesus Gonzalo
57	2025-09-30	Leon	2025-09-30 14:27:24.145967-05	4	0.00	2025-09-30 14:27:44.263507-05	4	0.00	6307.00	El control de caja por el momento no tiene ninguna observación.	t	Jesus Gonzalo	Jesus Gonzalo
72	2025-10-03	Lobo	2025-10-03 10:59:54.096963-05	4	0.00	2025-10-03 11:00:15.750275-05	4	0.00	2340.00	El control de caja por el momento no tiene ninguna observación.	t	Jesus Gonzalo	Jesus Gonzalo
58	2025-09-30	Leon	2025-09-30 14:32:36.625421-05	4	0.00	2025-09-30 14:33:01.741655-05	4	0.00	7259.00	El control de caja por el momento no tiene ninguna observación.	t	Jesus Gonzalo	Jesus Gonzalo
59	2025-09-30	Leon	2025-09-30 14:39:14.510266-05	4	0.00	2025-09-30 14:39:39.368433-05	4	0.00	7948.00	El control de caja por el momento no tiene ninguna observación.	t	Jesus Gonzalo	Jesus Gonzalo
73	2025-10-03	Lobo	2025-10-03 11:00:54.425479-05	4	0.00	2025-10-03 11:01:24.031554-05	4	0.00	3900.00	El control de caja por el momento no tiene ninguna observación.	t	Jesus Gonzalo	Jesus Gonzalo
60	2025-09-30	Leon	2025-09-30 15:31:17.040468-05	4	0.00	2025-09-30 15:31:37.725724-05	4	0.00	7909.00	El control de caja por el momento no tiene ninguna observación.	t	Jesus Gonzalo	Jesus Gonzalo
61	2025-09-30	Leon	2025-09-30 15:46:14.156862-05	4	0.00	2025-09-30 15:46:37.084954-05	4	0.00	8746.61	El control de caja por el momento no tiene ninguna observación.	t	Jesus Gonzalo	Jesus Gonzalo
74	2025-10-03	Lobo	2025-10-03 11:07:32.433293-05	4	0.00	2025-10-03 11:08:08.435235-05	4	0.00	5460.00	El control de caja por el momento no tiene ninguna observación.	t	Jesus Gonzalo	Jesus Gonzalo
62	2025-10-01	Leon	2025-10-01 12:29:14.393005-05	4	0.00	2025-10-01 12:29:43.931259-05	4	0.00	1981.50	El control de caja por el momento no tiene ninguna observación.	t	Jesus Gonzalo	Jesus Gonzalo
63	2025-10-01	Leon	2025-10-01 12:32:11.844763-05	4	0.00	2025-10-01 12:32:44.582429-05	4	0.00	3541.50	El control de caja por el momento no tiene ninguna observación.	t	Jesus Gonzalo	Jesus Gonzalo
75	2025-10-03	Lobo	2025-10-03 11:57:07.893929-05	4	0.00	2025-10-03 11:57:30.351454-05	4	0.00	6629.80	El control de caja por el momento no tiene ninguna observación.	t	Jesus Gonzalo	Jesus Gonzalo
64	2025-10-01	Leon	2025-10-01 12:35:02.364837-05	4	0.00	2025-10-01 12:35:26.042285-05	4	0.00	4711.50	El control de caja por el momento no tiene ninguna observación.	t	Jesus Gonzalo	Jesus Gonzalo
65	2025-10-01	Leon	2025-10-01 12:55:36.884149-05	4	0.00	2025-10-01 12:56:00.539184-05	4	0.00	5881.50	El control de caja por el momento no tiene ninguna observación.	t	Jesus Gonzalo	Jesus Gonzalo
76	2025-10-03	Leon	2025-10-03 12:05:50.481234-05	4	0.00	2025-10-03 12:06:16.790046-05	4	0.00	780.00	El control de caja por el momento no tiene ninguna observación.	t	Jesus Gonzalo	Jesus Gonzalo
77	2025-10-03	Leon	2025-10-03 12:13:11.203172-05	4	0.00	2025-10-03 12:13:42.962802-05	4	0.00	1950.00	El control de caja por el momento no tiene ninguna observación.	t	Jesus Gonzalo	Jesus Gonzalo
78	2025-10-03	Leon	2025-10-03 12:17:08.804539-05	4	0.00	2025-10-03 12:18:05.652222-05	4	0.00	3920.00	El control de caja por el momento no tiene ninguna observación.	t	Jesus Gonzalo	Jesus Gonzalo
79	2025-10-03	Leon	2025-10-03 12:21:58.947748-05	4	0.00	2025-10-03 12:43:02.10714-05	4	0.00	6260.00	El control de caja por el momento no tiene ninguna observación.	t	Jesus Gonzalo	Jesus Gonzalo
80	2025-10-03	Leon	2025-10-03 13:59:03.207681-05	4	0.00	\N	\N	\N	\N	\N	f	Jesus Gonzalo	\N
81	2025-10-14	Leon	2025-10-14 12:33:19.607133-05	12	12.00	\N	\N	\N	\N	\N	f	Administrador General	\N
82	2025-10-15	Leon	2025-10-15 15:23:55.153789-05	12	123.00	\N	\N	\N	\N	\N	f	Administrador General	\N
83	2025-10-16	Lobo	2025-10-16 10:38:49.268393-05	12	123.00	\N	\N	\N	\N	\N	f	Administrador General	\N
84	2025-10-17	Leon	2025-10-17 15:56:21.668364-05	12	2.00	\N	\N	\N	\N	\N	f	Administrador General	\N
85	2025-10-20	Lobo	2025-10-20 11:35:07.896691-05	12	1.00	\N	\N	\N	\N	\N	f	Administrador General	\N
86	2025-10-22	Leon	2025-10-22 15:55:45.266287-05	4	0.00	\N	\N	\N	\N	\N	f	Jesus Gonzalo	\N
87	2025-11-10	Lobo	2025-11-10 11:06:52.23908-05	12	1.00	\N	\N	\N	\N	\N	f	Administrador General	\N
\.


--
-- TOC entry 4452 (class 0 OID 17967)
-- Dependencies: 221
-- Data for Name: cash_registers; Type: TABLE DATA; Schema: public; Owner: postgres
--

COPY public.cash_registers (id, shift_id, opened_by, closed_by, opening_amount, closing_amount, created_at) FROM stdin;
\.


--
-- TOC entry 4454 (class 0 OID 17972)
-- Dependencies: 223
-- Data for Name: client_credit_limits; Type: TABLE DATA; Schema: public; Owner: postgres
--

COPY public.client_credit_limits (id, client_id, period_kind, max_gallons, is_active, created_at) FROM stdin;
4	1	month	500.000	t	2025-09-17 12:02:43.931509
5	15	month	500.000	t	2025-09-17 12:08:45.415701
\.


--
-- TOC entry 4456 (class 0 OID 17981)
-- Dependencies: 225
-- Data for Name: client_drivers; Type: TABLE DATA; Schema: public; Owner: postgres
--

COPY public.client_drivers (driver_id, company_id, dni, full_name, driver_license, plate, phone, vehicle_brand, vehicle_model, vehicle_color, is_active, notes, created_at, updated_at, sector_id) FROM stdin;
3	1	14785236	cristian	\N	GJR6JHGI	147852369	\N	\N	\N	t	\N	2025-09-30 12:27:53.857605-05	2025-09-30 12:27:53.857605-05	\N
2001	999	\N	Juan Choque	\N	ABC-123	\N	\N	\N	\N	t	\N	2025-10-20 16:23:15.306178-05	2025-10-20 16:23:15.306178-05	10
4	16	87654321	Pedro Campos	Z987654	X2B-456	911223344	Toyota	Hilux	Rojo	t	\N	2025-10-21 16:43:08.752618-05	2025-10-21 16:43:08.752618-05	\N
10	16	876654322	Pedro S. Campos	Z988654	XPB-457	911224444	Toyota	Hilux	Azul	t	\N	2025-10-23 14:01:09.455383-05	2025-10-23 14:01:09.455383-05	\N
\.


--
-- TOC entry 4458 (class 0 OID 17990)
-- Dependencies: 227
-- Data for Name: client_product_gallon_limits; Type: TABLE DATA; Schema: public; Owner: postgres
--

COPY public.client_product_gallon_limits (id, client_id, product_id, period_kind, max_gallons, apply_to_all_payments, is_active, created_at, updated_at) FROM stdin;
1	15	1	month	500.000	t	t	2025-09-17 12:35:02.026405	2025-09-25 16:55:43.014217-05
3	12	2	month	10.000	t	t	2025-09-25 14:25:00.471034	2025-09-26 13:50:57.861316-05
6	12	3	month	15.000	t	t	2025-09-26 13:51:09.600191	2025-09-26 13:51:09.600191-05
\.


--
-- TOC entry 4533 (class 0 OID 19895)
-- Dependencies: 315
-- Data for Name: client_product_rules; Type: TABLE DATA; Schema: public; Owner: postgres
--

COPY public.client_product_rules (rule_id, client_id, product_id, max_gallons, credit_limit, active) FROM stdin;
\.


--
-- TOC entry 4460 (class 0 OID 18001)
-- Dependencies: 229
-- Data for Name: clients; Type: TABLE DATA; Schema: public; Owner: postgres
--

COPY public.clients (client_id, client_type, category, first_name, last_name, company_name, document_type, document_number, address, phone, email, birth_date, notes, created_at, updated_at, restrict_to_limited_products) FROM stdin;
1	empresa	contado	Rowland	Prewett	Teklist	RUC	79784394	72210 Namekagon Place	927594754	rprewett0@wired.com	\N	\N	2025-09-16 16:24:07.215593	\N	f
2	persona	moroso	Ely	Wheeler	Oyoloo	Pasaporte	20690923	786 Macpherson Hill	968960176	ewheeler1@opensource.org	\N	\N	2025-09-16 16:24:07.358696	\N	f
3	persona	credito	Madelene	Freda	Aibox	DNI	76605492	100 Crest Line Lane	935121479	mfreda2@istockphoto.com	\N	\N	2025-09-16 16:24:07.388842	\N	f
4	persona	moroso	Keeley	Keitch	Feedbug	DNI	19519975	0 Lawn Center	993751798	kkeitch3@ehow.com	\N	\N	2025-09-16 16:24:07.418036	\N	f
5	empresa	moroso	Crin	Pendered	Devcast	DNI	41799109	6867 Holy Cross Point	948731788	cpendered4@woothemes.com	\N	\N	2025-09-16 16:24:07.447827	\N	f
6	empresa	contado	Lenore	Fraschini	Zoomdog	RUC	32750065	93663 Jana Park	957665281	lfraschini5@google.pl	\N	\N	2025-09-16 16:24:07.479619	\N	f
7	empresa	moroso	Ken	Fierro	Babblestorm	DNI	23202074	88 Vera Center	989304437	kfierro6@about.com	\N	\N	2025-09-16 16:24:07.508218	\N	f
8	empresa	moroso	Jamie	Mitchelmore	Wikivu	DNI	24149791	9958 Hintze Parkway	942665478	jmitchelmore7@netvibes.com	\N	\N	2025-09-16 16:24:07.539078	\N	f
9	persona	credito	Alfie	Costall	Gigashots	Pasaporte	33258315	7876 Orin Street	975279198	acostall8@oaic.gov.au	\N	\N	2025-09-16 16:24:07.617481	\N	f
10	persona	moroso	Addi	Stickel	Meevee	Carnet de Entrajería	16221210	359 Delladonna Avenue	952258103	astickel9@businesswire.com	\N	\N	2025-09-16 16:24:07.677139	\N	f
11	persona	frecuente	Shae	Hickeringill	Yoveo	DNI	42597317	513 Loeprich Court	925414819	shickeringilla@g.co	\N	\N	2025-09-16 16:24:07.703474	\N	f
12	persona	frecuente	Amandy	Carreyette	Mycat	Pasaporte	76518992	45 Vidon Street	920998498	acarreyetteb@bizjournals.com	\N	\N	2025-09-16 16:24:07.731606	\N	f
13	empresa	contado	Aimee	Luppitt	Avamm	DNI	66442475	137 Clemons Trail	921101337	aluppittc@berkeley.edu	\N	\N	2025-09-16 16:24:07.763306	\N	f
14	persona	frecuente	Hakim	Binstead	Wikido	DNI	57673376	5607 Pennsylvania Crossing	941566409	hbinsteadd@addtoany.com	\N	\N	2025-09-16 16:24:07.796361	\N	f
15	persona	contado	Brendin	Giller	Avaveo	DNI	10711434	6265 Debs Alley	968438813	bgillere@lycos.com	\N	\N	2025-09-16 16:24:07.86638	\N	f
999	empresa	credito	\N	\N	Municipalidad de Juliaca	\N	\N	\N	\N	\N	\N	\N	2025-10-20 16:17:41.911202	\N	f
1000	empresa	credito	\N	\N	Empresa X	\N	\N	\N	\N	\N	\N	\N	2025-10-20 16:18:08.994763	\N	f
16	empresa	credito	\N	\N	Municipalidad de Ejemplo	RUC	20123456789	Plaza Principal 123	987654321	contacto@muniejemplo.gob.pe	\N	\N	2025-10-21 16:35:26.012683	\N	f
\.


--
-- TOC entry 4462 (class 0 OID 18011)
-- Dependencies: 231
-- Data for Name: credits; Type: TABLE DATA; Schema: public; Owner: postgres
--

COPY public.credits (credit_id, client_id, sale_id, credit_amount, amount_paid, due_date, status, created_at, updated_at, driver_id, company_driver_id, sector_id, created_by_user_id, amount_total, balance) FROM stdin;
1	3	27	585.00	585.00	2025-10-22	paid	2025-09-23 15:06:40.897053	\N	\N	\N	\N	\N	\N	\N
2	3	55	123.00	55.00	2025-10-25	pending	2025-09-26 14:09:36.78258	\N	\N	\N	\N	\N	\N	\N
4	1	88	125.00	125.00	2025-10-28	paid	2025-09-29 15:23:47.302301	\N	3	\N	\N	\N	\N	\N
5	1	111	123.00	123.00	2025-10-29	paid	2025-09-30 14:00:07.779879	\N	\N	\N	\N	\N	\N	\N
7	4	195	12.00	0.00	2025-11-13	pending	2025-10-15 15:31:05.356412	\N	\N	\N	\N	\N	\N	\N
6	1	194	2123.00	2123.00	2025-11-12	paid	2025-10-14 12:34:15.523794	\N	\N	\N	\N	\N	\N	\N
8	1	196	123.00	123.00	2025-11-14	paid	2025-10-16 10:40:45.769308	\N	\N	\N	\N	\N	\N	\N
9	1	198	123.00	123.00	2025-11-14	paid	2025-10-16 14:30:59.753157	\N	\N	\N	\N	\N	\N	\N
10	1	200	123.00	123.00	2025-11-14	paid	2025-10-16 14:57:09.754307	\N	\N	\N	\N	\N	\N	\N
11	1	201	123.00	123.00	2025-11-14	paid	2025-10-16 14:58:16.674897	\N	\N	\N	\N	\N	\N	\N
14	1	202	123.00	0.00	2025-10-24	pending	2025-10-17 15:14:52.980985	\N	3	\N	\N	\N	\N	\N
12	1	202	123.00	123.00	2025-11-14	paid	2025-10-16 14:59:31.532085	\N	3	\N	\N	\N	\N	\N
13	1	202	123.00	0.00	2025-10-24	pending	2025-10-17 14:31:13.324734	\N	3	\N	\N	\N	\N	\N
15	1	204	254.00	0.00	2025-11-15	pending	2025-10-17 15:56:36.929721	\N	\N	\N	\N	\N	\N	\N
16	1	205	23.00	0.00	2025-11-15	pending	2025-10-17 15:59:28.45621	\N	\N	\N	\N	\N	\N	\N
17	1	206	23.00	0.00	2025-11-15	pending	2025-10-17 16:00:38.890228	\N	\N	\N	\N	\N	\N	\N
18	1	209	26.00	0.00	2025-11-15	pending	2025-10-17 16:13:46.775621	\N	\N	\N	\N	\N	\N	\N
19	1	210	27.00	0.00	2025-11-15	pending	2025-10-17 16:48:35.912477	\N	\N	\N	\N	\N	\N	\N
20	1	211	12.00	0.00	2025-11-18	pending	2025-10-20 11:35:23.298339	\N	\N	\N	\N	\N	\N	\N
25	1	236	1.00	0.00	2025-12-09	pending	2025-11-10 13:24:52.258817	\N	\N	\N	\N	\N	\N	\N
\.


--
-- TOC entry 4464 (class 0 OID 18021)
-- Dependencies: 233
-- Data for Name: deliveries; Type: TABLE DATA; Schema: public; Owner: postgres
--

COPY public.deliveries (delivery_id, supplier_id, delivery_timestamp, invoice_number, notes, user_id) FROM stdin;
\.


--
-- TOC entry 4466 (class 0 OID 18028)
-- Dependencies: 235
-- Data for Name: delivery_details; Type: TABLE DATA; Schema: public; Owner: postgres
--

COPY public.delivery_details (delivery_detail_id, delivery_id, product_id, tank_id, quantity_delivered, unit_cost) FROM stdin;
\.


--
-- TOC entry 4468 (class 0 OID 18032)
-- Dependencies: 237
-- Data for Name: discounts; Type: TABLE DATA; Schema: public; Owner: postgres
--

COPY public.discounts (id, name, active, created_at, gallons, amount) FROM stdin;
1	Consumos mayor a 30 galones	t	2025-09-16 13:20:44.880159	30	0.3
\.


--
-- TOC entry 4470 (class 0 OID 18040)
-- Dependencies: 239
-- Data for Name: dispensers; Type: TABLE DATA; Schema: public; Owner: postgres
--

COPY public.dispensers (dispenser_id, dispenser_number, dispenser_name, location_description, created_at, updated_at) FROM stdin;
\.


--
-- TOC entry 4472 (class 0 OID 18047)
-- Dependencies: 241
-- Data for Name: employees; Type: TABLE DATA; Schema: public; Owner: postgres
--

COPY public.employees (employee_id, dni, first_name, last_name, "position", birth_date, address, phone_number, email, hire_date, termination_date, is_active, file_path, created_at, updated_at) FROM stdin;
1	70936586	Lemuel	Poplee	Vendedor	1995-04-21	6474 Fuller Parkway	942278403	lpoplee0@geocities.com	2015-01-17	\N	t	\N	2025-09-16 16:25:37.199425	\N
2	24909934	Doreen	Oleksinski	Vendedor	1998-09-07	782 Eagan Avenue	963658108	doleksinski1@cornell.edu	2017-01-29	\N	t	\N	2025-09-16 16:25:37.29204	\N
3	30718212	Caroljean	Clowley	Vendedor	1959-02-21	24687 Kensington Alley	996343414	cclowley2@etsy.com	2017-01-12	\N	t	\N	2025-09-16 16:25:37.321128	\N
4	73936044	Forester	Chastagnier	Cajero	1950-04-30	39 Atwood Circle	928692602	fchastagnier3@mashable.com	2019-04-26	\N	t	\N	2025-09-16 16:25:37.340721	\N
5	81637648	Larine	Baddoe	Administrador	1986-06-21	8 Division Point	930326283	lbaddoe4@shareasale.com	2019-11-06	\N	t	\N	2025-09-16 16:25:37.410648	\N
6	52628739	Clarisse	Tearny	Administrador	1979-07-24	12 Manufacturers Terrace	987726607	ctearny5@vk.com	2014-12-04	\N	t	\N	2025-09-16 16:25:37.432967	\N
7	58362749	Rona	Burgott	Cajero	1951-06-14	72 Sutherland Trail	953392912	rburgott6@tiny.cc	2016-05-13	\N	t	\N	2025-09-16 16:25:37.459833	\N
8	67571984	Jessalyn	Druhan	Vendedor	1993-08-24	1981 Nova Circle	958292211	jdruhan7@accuweather.com	2016-01-31	\N	t	\N	2025-09-16 16:25:37.479569	\N
9	13917896	Barny	O'Skehan	Cajero	1952-02-21	27 Crest Line Junction	926856486	boskehan8@yolasite.com	2019-07-14	\N	t	\N	2025-09-16 16:25:37.510443	\N
10	21771117	Harlene	Blakeley	Vendedor	1980-02-25	229 Kipling Circle	966876700	hblakeley9@seesaa.net	2017-08-10	\N	t	\N	2025-09-16 16:25:37.528613	\N
11	88846772	Trever	Izhak	Cajero	1955-05-31	81 Acker Park	999291090	tizhaka@de.vu	2015-08-12	\N	t	\N	2025-09-16 16:25:37.545009	\N
12	25196576	Kathrine	Feathersby	Vendedor	1958-11-01	16090 Hoffman Terrace	969457909	kfeathersbyb@icq.com	2020-10-28	\N	t	\N	2025-09-16 16:25:37.561854	\N
13	63494299	Chet	Dronsfield	Cajero	1973-10-11	7 Macpherson Street	989711485	cdronsfieldc@goo.gl	2016-06-24	\N	t	\N	2025-09-16 16:25:37.579807	\N
14	39215100	Garey	Dewitt	Administrador	1978-09-01	5029 Susan Plaza	951327465	gdewittd@de.vu	2010-07-26	\N	t	\N	2025-09-16 16:25:37.599207	\N
15	75786321	Tabbitha	Barbara	Cajero	1961-03-25	53958 Di Loreto Court	961548897	tbarbarae@economist.com	2014-11-21	\N	t	\N	2025-09-16 16:25:37.614909	\N
\.


--
-- TOC entry 4474 (class 0 OID 18055)
-- Dependencies: 243
-- Data for Name: expense_categories; Type: TABLE DATA; Schema: public; Owner: postgres
--

COPY public.expense_categories (category_id, category_name) FROM stdin;
1	COMIDA
2	PASAJE
3	VIATICO
4	UTILES
5	MANTENIMIENTO
6	OTROS
\.


--
-- TOC entry 4476 (class 0 OID 18059)
-- Dependencies: 245
-- Data for Name: expenses; Type: TABLE DATA; Schema: public; Owner: postgres
--

COPY public.expenses (expense_id, user_id, expense_timestamp, category_id, description, amount, payment_method_id, receipt_path, created_at, updated_at) FROM stdin;
4	12	2025-10-22 08:05:00	1	Taxi al grifo	25.50	1	\N	2025-10-22 14:20:15.183503	\N
5	4	2025-10-22 10:35:00	2	Fue para un viaje	2.00	1	\N	2025-10-22 15:35:51.90788	\N
6	4	2025-10-23 11:33:00	4	productos	20.00	2	\N	2025-10-23 16:33:34.571307	\N
\.


--
-- TOC entry 4478 (class 0 OID 18067)
-- Dependencies: 247
-- Data for Name: landed_cost_allocation_lines; Type: TABLE DATA; Schema: public; Owner: postgres
--

COPY public.landed_cost_allocation_lines (allocation_line_id, allocation_id, line_id, allocated_amount) FROM stdin;
1	1	7	14.2857
2	1	8	5.7143
\.


--
-- TOC entry 4480 (class 0 OID 18071)
-- Dependencies: 249
-- Data for Name: landed_cost_allocations; Type: TABLE DATA; Schema: public; Owner: postgres
--

COPY public.landed_cost_allocations (allocation_id, purchase_id, total_cost, method, created_at) FROM stdin;
1	9001	20.00	BY_VALUE	2025-10-13 16:00:03.929736
\.


--
-- TOC entry 4482 (class 0 OID 18078)
-- Dependencies: 251
-- Data for Name: meter_readings; Type: TABLE DATA; Schema: public; Owner: postgres
--

COPY public.meter_readings (reading_id, nozzle_id, initial_reading, final_reading, user_id, created_at, updated_at) FROM stdin;
80	5	425.45	438.12	4	2025-09-29 16:28:14.584	\N
81	5	438.12	438.74	4	2025-09-30 11:44:22.151	\N
82	5	438.74	439.36	4	2025-09-30 11:44:27.022	\N
83	5	439.36	469.36	4	2025-09-30 11:44:34.211	\N
84	5	469.36	549.36	4	2025-09-30 11:45:08.95	\N
5	1	12400.50	12450.75	2	2025-09-17 11:28:06.27386	\N
1	1	12000.50	12050.75	3	2025-09-16 16:39:37.150273	\N
2	1	12050.50	12100.75	2	2025-09-17 10:51:27.800254	\N
3	1	12200.50	12250.75	2	2025-09-17 11:05:34.581935	\N
4	1	12300.50	12350.75	2	2025-09-17 11:26:02.328735	\N
85	5	549.36	550.54	4	2025-09-30 12:28:40.722	\N
7	2	100.00	200.00	2	2025-09-19 14:04:05.790766	\N
8	2	200.00	300.00	2	2025-09-19 14:04:24.537036	\N
9	2	300.00	500.00	2	2025-09-19 14:10:32.395521	\N
10	3	10.00	100.00	3	2025-09-19 15:47:11.869787	\N
11	5	0.00	1.00	12	2025-09-22 14:42:18.001	\N
86	5	550.54	551.16	4	2025-09-30 12:28:44.228	\N
87	5	551.16	552.34	4	2025-09-30 12:49:11.207	\N
88	5	552.34	555.21	4	2025-09-30 12:49:18.977	\N
89	5	555.21	575.21	4	2025-09-30 12:49:27.602	\N
6	1	12450.75	13028.30	2	2025-09-19 12:38:02.807639	2025-09-23 14:07:09.708
12	1	13028.30	13034.30	12	2025-09-23 15:02:15.432	\N
13	1	13034.30	13064.30	12	2025-09-23 15:06:40.97	\N
14	5	1.00	3.00	12	2025-09-23 15:16:12.112	\N
15	1	13064.30	13065.84	12	2025-09-24 12:43:22.148	\N
16	5	3.00	4.54	12	2025-09-24 14:20:14.077	\N
17	1	13065.84	13070.46	12	2025-09-24 14:20:19.803	\N
18	1	13070.46	13072.00	12	2025-09-25 14:08:15.597	\N
19	5	4.54	9.16	12	2025-09-25 14:08:21.377	\N
20	2	500.00	539.52	12	2025-09-25 14:08:28.424	\N
21	3	100.00	111.96	12	2025-09-25 14:08:34.171	\N
22	4	0.00	10.59	12	2025-09-25 14:08:41.38	\N
23	2	539.52	540.42	12	2025-09-26 10:17:34.256	\N
24	2	540.42	540.48	12	2025-09-26 10:17:46.823	\N
25	2	540.48	554.48	12	2025-09-26 10:18:37.625	\N
26	2	554.48	555.48	12	2025-09-26 10:18:53.148	\N
27	2	555.48	556.48	12	2025-09-26 10:19:04.959	\N
28	1	13072.00	13076.62	12	2025-09-26 13:50:58.536	\N
29	5	9.16	19.93	12	2025-09-26 13:51:03.687	\N
30	2	556.48	580.43	12	2025-09-26 13:51:09.246	\N
31	3	111.96	128.26	12	2025-09-26 13:51:18.884	\N
32	4	10.59	104.71	12	2025-09-26 13:51:24.578	\N
33	5	19.93	21.11	12	2025-09-26 14:02:07.375	\N
34	1	13076.62	13082.93	4	2025-09-26 14:08:30.626	\N
35	5	21.11	23.42	4	2025-09-26 14:08:37.259	\N
36	2	580.43	593.18	4	2025-09-26 14:08:43.561	\N
37	3	128.26	157.77	4	2025-09-26 14:08:48.852	\N
38	4	104.71	119.18	4	2025-09-26 14:08:53.185	\N
39	1	13082.93	13089.24	4	2025-09-26 14:09:36.848	\N
40	1	13089.24	13104.63	4	2025-09-26 15:53:18.548	\N
41	1	13104.63	13135.40	4	2025-09-26 16:16:04.956	\N
42	5	23.42	54.19	4	2025-09-26 16:16:11.337	\N
43	1	13135.40	13181.55	4	2025-09-26 16:25:36.439	\N
44	1	13181.55	13191.55	4	2025-09-26 16:47:32.356	\N
45	1	13191.55	13196.17	4	2025-09-29 11:33:23.645	\N
46	5	54.19	100.34	4	2025-09-29 11:33:31.252	\N
47	1	13196.17	14096.17	4	2025-09-29 11:34:33.414	\N
48	1	14096.17	14111.56	4	2025-09-29 12:09:53.903	\N
49	5	100.34	110.60	4	2025-09-29 12:09:59.222	\N
50	2	593.18	600.49	4	2025-09-29 12:10:03.696	\N
51	3	157.77	164.40	4	2025-09-29 12:10:10.953	\N
52	4	119.18	157.06	4	2025-09-29 12:10:16.345	\N
53	1	14111.56	14122.95	4	2025-09-29 12:11:33.374	\N
54	1	14122.95	14125.21	4	2025-09-29 12:11:38.792	\N
55	5	110.60	125.99	4	2025-09-29 12:12:45.024	\N
56	5	125.99	172.14	4	2025-09-29 12:12:59.674	\N
57	5	172.14	218.29	4	2025-09-29 12:16:06.432	\N
58	5	218.29	264.55	4	2025-09-29 12:16:12.815	\N
59	5	264.55	265.58	4	2025-09-29 13:32:43.285	\N
60	1	14125.21	14145.72	4	2025-09-29 13:32:47.902	\N
61	5	265.58	267.12	4	2025-09-29 13:32:53.36	\N
62	5	267.12	270.71	4	2025-09-29 13:32:58.081	\N
63	5	270.71	271.33	4	2025-09-29 14:46:32.233	\N
64	1	14145.72	14147.36	4	2025-09-29 14:46:37.392	\N
65	5	271.33	299.18	4	2025-09-29 14:46:42.363	\N
66	5	299.18	314.57	4	2025-09-29 15:10:47.04	\N
67	5	314.57	352.72	4	2025-09-29 15:10:53.29	\N
68	5	352.72	353.34	4	2025-09-29 15:11:00.032	\N
69	5	353.34	357.34	4	2025-09-29 15:11:05.238	\N
70	5	357.34	360.52	4	2025-09-29 15:11:11.663	\N
71	1	14147.36	14210.69	12	2025-09-29 15:23:08.127	\N
72	1	14210.69	14217.10	12	2025-09-29 15:23:52.235	\N
73	5	360.52	365.60	4	2025-09-29 16:16:46.815	\N
74	5	365.60	366.22	4	2025-09-29 16:17:20.273	\N
75	5	366.22	368.53	4	2025-09-29 16:17:25.455	\N
76	5	368.53	371.09	4	2025-09-29 16:17:30.56	\N
77	5	371.09	384.22	4	2025-09-29 16:17:34.99	\N
78	5	384.22	386.89	4	2025-09-29 16:28:06.058	\N
79	5	386.89	425.45	4	2025-09-29 16:28:10.826	\N
90	5	575.21	587.21	4	2025-09-30 13:07:56.162	\N
91	5	587.21	601.21	4	2025-09-30 13:07:59.76	\N
92	5	601.21	603.52	4	2025-09-30 13:59:11.55	\N
93	5	603.52	604.24	4	2025-09-30 13:59:15.617	\N
94	5	604.24	608.24	4	2025-09-30 13:59:23.593	\N
95	1	14217.10	14223.41	12	2025-09-30 14:00:14.54	\N
96	5	608.24	686.24	4	2025-09-30 14:11:52.806	\N
97	5	686.24	733.24	4	2025-09-30 14:11:58.374	\N
98	5	733.24	734.78	4	2025-09-30 14:17:24.376	\N
99	5	734.78	735.40	4	2025-09-30 14:17:28.338	\N
100	5	735.40	737.50	4	2025-09-30 14:17:32.937	\N
101	5	737.50	782.50	4	2025-09-30 14:18:55.958	\N
102	5	782.50	796.50	4	2025-09-30 14:19:01.419	\N
103	5	796.50	806.50	4	2025-09-30 14:19:07.657	\N
104	5	806.50	826.50	4	2025-09-30 14:27:29.785	\N
105	5	826.50	836.50	4	2025-09-30 14:27:34.085	\N
106	5	836.50	866.50	4	2025-09-30 14:27:38.165	\N
107	5	866.50	876.50	4	2025-09-30 14:32:44.667	\N
108	5	876.50	886.50	4	2025-09-30 14:32:49.043	\N
109	5	886.50	896.50	4	2025-09-30 14:32:54.207	\N
110	5	896.50	916.50	4	2025-09-30 14:32:58.456	\N
111	5	916.50	936.50	4	2025-09-30 14:39:20.575	\N
112	5	936.50	946.50	4	2025-09-30 14:39:29.36	\N
113	5	946.50	956.50	4	2025-09-30 14:39:34.074	\N
114	5	956.50	976.50	4	2025-09-30 15:31:28.711	\N
115	5	976.50	986.50	4	2025-09-30 15:31:32.644	\N
116	5	986.50	1006.48	4	2025-09-30 15:46:22.547	\N
117	5	1006.48	1016.48	4	2025-09-30 15:46:26.488	\N
118	5	1016.48	1046.48	4	2025-09-30 15:46:30.479	\N
119	5	1046.48	1047.10	4	2025-10-01 12:29:20.764	\N
120	5	1047.10	1125.10	4	2025-10-01 12:29:28.271	\N
121	5	1125.10	1148.10	4	2025-10-01 12:29:33.078	\N
122	5	1148.10	1178.10	4	2025-10-01 12:32:24.737	\N
123	5	1178.10	1198.10	4	2025-10-01 12:32:29.603	\N
124	5	1198.10	1218.10	4	2025-10-01 12:32:35.02	\N
125	5	1218.10	1228.10	4	2025-10-01 12:32:39.993	\N
126	5	1228.10	1248.10	4	2025-10-01 12:35:11.25	\N
127	5	1248.10	1268.10	4	2025-10-01 12:35:17.455	\N
128	5	1268.10	1288.10	4	2025-10-01 12:35:23.049	\N
129	5	1288.10	1308.10	4	2025-10-01 12:55:42.62	\N
130	5	1308.10	1328.10	4	2025-10-01 12:55:50.043	\N
131	5	1328.10	1348.10	4	2025-10-01 12:55:55.98	\N
132	5	1348.10	1368.10	4	2025-10-01 13:41:32.437	\N
133	5	1368.10	1388.10	4	2025-10-01 13:41:38.334	\N
134	5	1388.10	1408.10	4	2025-10-01 13:41:43.031	\N
135	5	1408.10	1428.10	4	2025-10-01 13:50:44.517	\N
136	5	1428.10	1448.10	4	2025-10-01 13:50:48.262	\N
137	5	1448.10	1468.10	4	2025-10-01 13:50:51.91	\N
138	5	1468.10	1488.10	4	2025-10-01 13:51:36.759	\N
139	5	1488.10	1508.10	4	2025-10-01 13:51:40.844	\N
140	5	1508.10	1528.10	4	2025-10-01 13:51:44.015	\N
141	5	1528.10	1549.10	4	2025-10-01 16:24:35.447	\N
142	5	1549.10	1561.10	4	2025-10-01 16:24:41.207	\N
143	5	1561.10	1584.10	4	2025-10-01 16:24:46.857	\N
144	5	1584.10	1604.10	4	2025-10-03 10:59:28.53	\N
145	5	1604.10	1624.10	4	2025-10-03 10:59:33.409	\N
146	5	1624.10	1644.10	4	2025-10-03 10:59:37.011	\N
147	5	1644.10	1664.10	4	2025-10-03 10:59:59.813	\N
148	5	1664.10	1684.10	4	2025-10-03 11:00:06.674	\N
149	5	1684.10	1704.10	4	2025-10-03 11:00:12.161	\N
150	5	1704.10	1724.10	4	2025-10-03 11:01:09.158	\N
151	5	1724.10	1744.10	4	2025-10-03 11:01:12.775	\N
152	5	1744.10	1764.10	4	2025-10-03 11:01:16.183	\N
153	5	1764.10	1784.10	4	2025-10-03 11:01:20.486	\N
154	5	1784.10	1804.10	4	2025-10-03 11:07:47.35	\N
155	5	1804.10	1824.10	4	2025-10-03 11:07:56.324	\N
156	5	1824.10	1844.10	4	2025-10-03 11:08:01.274	\N
157	5	1844.10	1864.10	4	2025-10-03 11:08:04.893	\N
158	5	1864.10	1884.09	4	2025-10-03 11:57:15.074	\N
159	5	1884.09	1904.09	4	2025-10-03 11:57:21.43	\N
160	5	1904.09	1924.09	4	2025-10-03 11:57:25.556	\N
161	5	1924.09	1944.09	4	2025-10-03 12:06:05.978	\N
162	5	1944.09	1964.09	4	2025-10-03 12:06:13.219	\N
163	5	1964.09	1984.09	4	2025-10-03 12:13:26.736	\N
164	5	1984.09	2004.09	4	2025-10-03 12:13:31.738	\N
165	5	2004.09	2024.09	4	2025-10-03 12:13:39.613	\N
166	5	2024.09	2025.12	4	2025-10-03 12:17:32.97	\N
167	5	2025.12	2045.12	4	2025-10-03 12:17:43.351	\N
168	5	2045.12	2065.12	4	2025-10-03 12:17:49.148	\N
169	1	14223.41	14243.41	4	2025-10-03 12:17:52.934	\N
170	1	14243.41	14263.41	4	2025-10-03 12:17:57.093	\N
171	1	14263.41	14283.41	4	2025-10-03 12:18:01.859	\N
172	5	2065.12	2085.12	4	2025-10-03 12:42:38.334	\N
173	5	2085.12	2105.12	4	2025-10-03 12:42:42	\N
174	5	2105.12	2125.12	4	2025-10-03 12:42:47.005	\N
175	1	14283.41	14303.41	4	2025-10-03 12:42:50.751	\N
176	1	14303.41	14323.41	4	2025-10-03 12:42:53.972	\N
177	1	14323.41	14343.41	4	2025-10-03 12:42:57.732	\N
178	1	14343.41	14452.28	12	2025-10-14 12:34:15.638	\N
179	3	164.40	165.05	3	2025-10-15 15:31:05.49	\N
180	5	2125.12	2131.43	12	2025-10-16 10:41:18.457	\N
181	5	2131.43	2137.74	12	2025-10-16 10:42:02.819	\N
182	1	14452.28	14458.59	12	2025-10-16 14:31:17.514	\N
183	5	2137.74	2138.36	12	2025-10-16 14:56:58.54	\N
184	1	14458.59	14464.90	12	2025-10-16 14:57:09.906	\N
185	1	14464.90	14471.21	12	2025-10-16 14:58:17.494	\N
186	1	14471.21	14477.52	12	2025-10-16 14:59:32.089	\N
187	1	14477.52	14490.55	12	2025-10-17 15:56:38.554	\N
188	1	14490.55	14491.73	12	2025-10-17 15:59:30.035	\N
189	1	14491.73	14492.91	12	2025-10-17 16:00:40.472	\N
190	1	14492.91	14494.24	12	2025-10-17 16:13:48.496	\N
191	1	14494.24	14495.63	12	2025-10-17 16:48:37.53	\N
192	1	14495.63	14496.25	12	2025-10-20 11:35:23.505	\N
193	1	14496.25	14496.30	12	2025-11-10 13:22:18.378	\N
194	1	14496.30	14496.35	12	2025-11-10 13:22:43.778	\N
195	1	14496.35	14496.40	12	2025-11-10 13:24:52.275	\N
196	1	14496.40	14496.45	12	2025-11-10 13:25:07.422	\N
197	1	14496.45	14527.45	12	2025-11-10 16:22:48.268	\N
198	1	14527.45	14558.45	12	2025-11-10 16:23:19.837	\N
199	1	14558.45	14589.45	12	2025-11-10 16:24:50.954	\N
200	1	14589.45	14620.45	12	2025-11-10 16:27:06.251	\N
201	1	14620.45	14651.45	12	2025-11-10 16:27:51.843	\N
202	1	14651.45	14682.45	12	2025-11-10 16:28:35.806	\N
\.


--
-- TOC entry 4493 (class 0 OID 18149)
-- Dependencies: 262
-- Data for Name: nozzles; Type: TABLE DATA; Schema: public; Owner: postgres
--

COPY public.nozzles (nozzle_id, pump_id, product_id, tank_id, nozzle_number, created_at, updated_at, dispenser_id, estado) FROM stdin;
1	1	1	1	1001	2025-09-16 16:36:52.225376	\N	\N	\N
2	2	2	2	1002	2025-09-16 16:37:02.17802	\N	\N	\N
3	3	3	3	1003	2025-09-16 16:37:09.735007	\N	\N	\N
4	4	4	4	1004	2025-09-16 16:37:19.731097	\N	\N	\N
5	1	1	1	1101	2025-09-19 10:08:38.934184	\N	\N	\N
\.


--
-- TOC entry 4495 (class 0 OID 18154)
-- Dependencies: 264
-- Data for Name: payment_methods; Type: TABLE DATA; Schema: public; Owner: postgres
--

COPY public.payment_methods (payment_method_id, method_name, is_active, description, created_at, updated_at, name, is_credit) FROM stdin;
3	Transferencia	t		2025-09-16 13:21:24.296233	2025-09-23 15:10:19.768658	TARJETA	f
4	Crédito	t		2025-09-16 13:21:42.481267	2025-11-10 12:47:23.338228	TRANSFER	f
1	Efectivo	t		2025-09-16 13:20:53.405069	2025-09-23 15:04:58.865061	EFECTIVO	f
2	Yape	t		2025-09-16 13:21:16.753534	2025-09-23 15:09:39.610015	CRÉDITO	f
\.


--
-- TOC entry 4497 (class 0 OID 18163)
-- Dependencies: 266
-- Data for Name: payments; Type: TABLE DATA; Schema: public; Owner: postgres
--

COPY public.payments (payment_id, user_id, sale_id, credit_id, payment_timestamp, amount, payment_method_id, notes, payment_type, status, request_key) FROM stdin;
1	12	3	\N	2025-09-17 11:56:46.04878	123.00	1	Pago automático	\N	completed	\N
2	12	12	\N	2025-09-19 11:48:46.213251	20.00	1	Pago automático	\N	completed	\N
3	12	13	\N	2025-09-19 14:29:31.785662	30.00	1	Pago automático	\N	completed	\N
4	12	14	\N	2025-09-19 14:29:38.035948	20.00	1	Pago automático	\N	completed	\N
5	12	15	\N	2025-09-19 14:29:43.182589	40.00	1	Pago automático	\N	completed	\N
6	12	16	\N	2025-09-19 14:29:48.541502	85.00	1	Pago automático	\N	completed	\N
7	12	17	\N	2025-09-22 14:42:17.902429	19.50	1	Pago automático	\N	completed	\N
8	12	18	\N	2025-09-22 16:42:54.868432	123.00	1	Pago automático	\N	completed	\N
9	12	19	\N	2025-09-22 16:43:03.5132	123.00	1	Pago automático	\N	completed	\N
10	12	20	\N	2025-09-22 16:53:10.369249	19.50	1	Pago automático	\N	completed	\N
11	12	21	\N	2025-09-23 13:19:52.354259	117.00	1	Pago automático	\N	completed	\N
12	12	22	\N	2025-09-23 13:26:12.404404	1.00	1	Pago automático	\N	completed	\N
13	12	23	\N	2025-09-23 13:26:56.744157	195.00	1	Pago automático	\N	completed	\N
14	12	24	\N	2025-09-23 14:06:20.948283	117.00	1	Pago automático	\N	completed	\N
15	12	25	\N	2025-09-23 14:07:09.680136	117.00	1	Pago automático	\N	completed	\N
16	12	26	\N	2025-09-23 15:02:15.418786	117.00	1	Pago automático	\N	completed	\N
17	12	28	\N	2025-09-23 15:16:12.075796	39.00	1	Pago automático	\N	completed	\N
18	12	29	\N	2025-09-24 12:43:22.048523	30.00	1	Pago automático	\N	completed	\N
19	12	30	\N	2025-09-24 14:20:13.979047	30.00	1	Pago automático	\N	completed	\N
20	12	31	\N	2025-09-24 14:20:19.78054	90.00	1	Pago automático	\N	completed	\N
21	12	32	\N	2025-09-25 14:08:15.491422	30.00	1	Pago automático	\N	completed	\N
22	12	33	\N	2025-09-25 14:08:21.366448	90.00	1	Pago automático	\N	completed	\N
23	12	34	\N	2025-09-25 14:08:28.40724	660.00	1	Pago automático	\N	completed	\N
24	12	35	\N	2025-09-25 14:08:34.133453	220.00	1	Pago automático	\N	completed	\N
25	12	36	\N	2025-09-25 14:08:41.364023	90.00	1	Pago automático	\N	completed	\N
26	12	37	\N	2025-09-26 10:17:31.580492	15.00	1	Pago automático	\N	completed	\N
27	12	38	\N	2025-09-26 10:17:44.444678	1.00	1	Pago automático	\N	completed	\N
28	12	39	\N	2025-09-26 10:18:35.352384	233.80	1	Pago automático	\N	completed	\N
29	12	40	\N	2025-09-26 10:18:50.62012	16.70	1	Pago automático	\N	completed	\N
30	12	41	\N	2025-09-26 10:19:02.688625	16.70	1	Pago automático	\N	completed	\N
32	12	43	\N	2025-09-26 13:50:58.518832	90.00	1	Pago automático	\N	completed	\N
33	12	44	\N	2025-09-26 13:51:03.650885	210.00	1	Pago automático	\N	completed	\N
34	12	45	\N	2025-09-26 13:51:09.202462	400.00	1	Pago automático	\N	completed	\N
35	12	46	\N	2025-09-26 13:51:18.869066	300.00	1	Pago automático	\N	completed	\N
36	12	47	\N	2025-09-26 13:51:24.552452	800.00	1	Pago automático	\N	completed	\N
37	12	48	\N	2025-09-26 14:02:07.240908	23.00	1	Pago automático	\N	completed	\N
38	4	49	\N	2025-09-26 14:08:30.593043	123.00	1	Pago automático	\N	completed	\N
39	4	50	\N	2025-09-26 14:08:37.246887	45.00	1	Pago automático	\N	completed	\N
40	4	51	\N	2025-09-26 14:08:43.538961	213.00	1	Pago automático	\N	completed	\N
41	4	52	\N	2025-09-26 14:08:48.837897	543.00	1	Pago automático	\N	completed	\N
42	4	53	\N	2025-09-26 14:08:53.180316	123.00	1	Pago automático	\N	completed	\N
43	12	\N	1	2025-09-26 14:32:41.888725	500.00	1	\N	credit	completed	\N
44	12	\N	1	2025-09-26 14:33:03.505821	85.00	1	\N	credit	completed	\N
45	12	\N	2	2025-09-26 14:33:03.505821	25.00	1	\N	credit	completed	\N
46	12	\N	2	2025-09-26 14:39:05.285433	30.00	2	\N	credit	completed	\N
47	4	56	\N	2025-09-26 15:53:18.533711	300.00	1	Pago automático	\N	completed	\N
48	4	57	\N	2025-09-26 16:16:04.9355	600.00	1	Pago automático	\N	completed	\N
49	4	58	\N	2025-09-26 16:16:11.329414	600.00	1	Pago automático	\N	completed	\N
50	4	59	\N	2025-09-26 16:25:36.427028	900.00	1	Pago automático	\N	completed	\N
51	4	60	\N	2025-09-26 16:47:32.33289	195.00	1	Pago automático	\N	completed	\N
52	4	61	\N	2025-09-29 11:33:23.546141	90.00	1	Pago automático	\N	completed	\N
53	4	62	\N	2025-09-29 11:33:31.221725	900.00	1	Pago automático	\N	completed	\N
54	4	63	\N	2025-09-29 11:34:33.390338	17550.00	1	Pago automático	\N	completed	\N
55	4	64	\N	2025-09-29 12:09:53.890464	300.00	1	Pago automático	\N	completed	\N
56	4	65	\N	2025-09-29 12:09:59.198453	200.00	1	Pago automático	\N	completed	\N
57	4	66	\N	2025-09-29 12:10:03.682071	122.00	1	Pago automático	\N	completed	\N
58	4	67	\N	2025-09-29 12:10:10.936225	122.00	1	Pago automático	\N	completed	\N
59	4	68	\N	2025-09-29 12:10:16.325027	322.00	1	Pago automático	\N	completed	\N
60	4	69	\N	2025-09-29 12:11:33.367627	222.00	1	Pago automático	\N	completed	\N
61	4	70	\N	2025-09-29 12:11:38.771975	44.00	1	Pago automático	\N	completed	\N
62	4	71	\N	2025-09-29 12:12:44.992867	300.00	1	Pago automático	\N	completed	\N
63	4	72	\N	2025-09-29 12:12:59.648009	900.00	1	Pago automático	\N	completed	\N
64	4	73	\N	2025-09-29 12:16:06.390925	900.00	1	Pago automático	\N	completed	\N
65	4	74	\N	2025-09-29 12:16:12.793601	902.00	1	Pago automático	\N	completed	\N
66	4	75	\N	2025-09-29 13:32:43.265831	20.00	1	Pago automático	\N	completed	\N
67	4	76	\N	2025-09-29 13:32:47.878255	400.00	1	Pago automático	\N	completed	\N
68	4	77	\N	2025-09-29 13:32:53.344639	30.00	1	Pago automático	\N	completed	\N
69	4	78	\N	2025-09-29 13:32:58.062027	70.00	1	Pago automático	\N	completed	\N
70	4	79	\N	2025-09-29 14:46:32.212893	12.00	1	Pago automático	\N	completed	\N
71	4	80	\N	2025-09-29 14:46:37.376996	32.00	1	Pago automático	\N	completed	\N
72	4	81	\N	2025-09-29 14:46:42.346865	543.00	1	Pago automático	\N	completed	\N
73	4	82	\N	2025-09-29 15:10:47.021415	300.00	1	Pago automático	\N	completed	\N
74	4	83	\N	2025-09-29 15:10:53.268655	744.00	1	Pago automático	\N	completed	\N
75	4	84	\N	2025-09-29 15:11:00.020426	12.00	1	Pago automático	\N	completed	\N
76	4	85	\N	2025-09-29 15:11:05.226875	78.00	1	Pago automático	\N	completed	\N
77	4	86	\N	2025-09-29 15:11:11.64166	62.00	1	Pago automático	\N	completed	\N
78	12	87	\N	2025-09-29 15:23:02.986121	1235.00	1	Pago automático	\N	completed	\N
79	4	89	\N	2025-09-29 16:16:46.792655	99.00	1	Pago automático	\N	completed	\N
80	4	90	\N	2025-09-29 16:17:20.238201	12.00	1	Pago automático	\N	completed	\N
81	4	91	\N	2025-09-29 16:17:25.427668	45.00	1	Pago automático	\N	completed	\N
82	4	92	\N	2025-09-29 16:17:30.546775	50.00	1	Pago automático	\N	completed	\N
83	4	93	\N	2025-09-29 16:17:34.964883	256.00	1	Pago automático	\N	completed	\N
84	4	94	\N	2025-09-29 16:28:06.044082	52.00	1	Pago automático	\N	completed	\N
85	4	95	\N	2025-09-29 16:28:10.810342	752.00	1	Pago automático	\N	completed	\N
86	4	96	\N	2025-09-29 16:28:14.559436	247.00	1	Pago automático	\N	completed	\N
87	4	97	\N	2025-09-30 11:44:22.052229	12.00	1	Pago automático	\N	completed	\N
88	4	98	\N	2025-09-30 11:44:26.99794	12.00	1	Pago automático	\N	completed	\N
89	4	99	\N	2025-09-30 11:44:34.187936	585.00	1	Pago automático	\N	completed	\N
90	4	100	\N	2025-09-30 11:45:08.921866	1560.00	1	Pago automático	\N	completed	\N
91	4	101	\N	2025-09-30 12:28:40.687264	23.00	1	Pago automático	\N	completed	\N
92	4	102	\N	2025-09-30 12:28:44.197855	12.00	1	Pago automático	\N	completed	\N
93	4	103	\N	2025-09-30 12:49:11.183817	23.00	1	Pago automático	\N	completed	\N
94	4	104	\N	2025-09-30 12:49:18.960013	56.00	1	Pago automático	\N	completed	\N
95	4	105	\N	2025-09-30 12:49:27.569939	390.00	1	Pago automático	\N	completed	\N
96	4	106	\N	2025-09-30 13:07:56.126971	234.00	1	Pago automático	\N	completed	\N
97	4	107	\N	2025-09-30 13:07:59.748576	273.00	1	Pago automático	\N	completed	\N
98	4	108	\N	2025-09-30 13:59:11.528106	45.00	1	Pago automático	\N	completed	\N
99	4	109	\N	2025-09-30 13:59:15.597825	14.00	1	Pago automático	\N	completed	\N
100	4	110	\N	2025-09-30 13:59:23.577497	78.00	1	Pago automático	\N	completed	\N
101	4	112	\N	2025-09-30 14:11:52.786688	1521.00	1	Pago automático	\N	completed	\N
102	4	113	\N	2025-09-30 14:11:58.348969	916.50	1	Pago automático	\N	completed	\N
103	12	\N	4	2025-09-30 14:15:56.335754	125.00	1	\N	credit	completed	\N
104	12	\N	5	2025-09-30 14:15:56.335754	75.00	1	\N	credit	completed	\N
105	12	\N	5	2025-09-30 14:16:38.97313	48.00	1	\N	credit	completed	\N
106	4	114	\N	2025-09-30 14:17:24.360167	30.00	1	Pago automático	\N	completed	\N
107	4	115	\N	2025-09-30 14:17:28.317743	12.00	1	Pago automático	\N	completed	\N
108	4	116	\N	2025-09-30 14:17:32.928983	41.00	1	Pago automático	\N	completed	\N
109	4	117	\N	2025-09-30 14:18:55.940801	877.50	1	Pago automático	\N	completed	\N
110	4	118	\N	2025-09-30 14:19:01.409469	273.00	1	Pago automático	\N	completed	\N
111	4	119	\N	2025-09-30 14:19:07.648415	195.00	1	Pago automático	\N	completed	\N
112	4	120	\N	2025-09-30 14:27:29.766162	390.00	1	Pago automático	\N	completed	\N
113	4	121	\N	2025-09-30 14:27:34.07797	195.00	1	Pago automático	\N	completed	\N
114	4	122	\N	2025-09-30 14:27:38.15537	585.00	1	Pago automático	\N	completed	\N
115	4	123	\N	2025-09-30 14:32:44.651576	195.00	1	Pago automático	\N	completed	\N
116	4	124	\N	2025-09-30 14:32:49.034117	195.00	1	Pago automático	\N	completed	\N
117	4	125	\N	2025-09-30 14:32:54.189575	195.00	1	Pago automático	\N	completed	\N
118	4	126	\N	2025-09-30 14:32:58.444121	390.00	1	Pago automático	\N	completed	\N
119	4	127	\N	2025-09-30 14:39:20.566845	390.00	1	Pago automático	\N	completed	\N
120	4	128	\N	2025-09-30 14:39:29.344478	195.00	1	Pago automático	\N	completed	\N
121	4	129	\N	2025-09-30 14:39:34.05427	195.00	1	Pago automático	\N	completed	\N
122	4	130	\N	2025-09-30 15:31:28.695827	390.00	1	Pago automático	\N	completed	\N
123	4	131	\N	2025-09-30 15:31:32.628076	195.00	1	Pago automático	\N	completed	\N
124	4	132	\N	2025-09-30 15:46:22.527675	389.61	1	Pago automático	\N	completed	\N
125	4	133	\N	2025-09-30 15:46:26.46285	195.00	1	Pago automático	\N	completed	\N
126	4	134	\N	2025-09-30 15:46:30.466387	585.00	1	Pago automático	\N	completed	\N
127	4	135	\N	2025-10-01 12:29:20.656795	12.00	1	Pago automático	\N	completed	\N
128	4	136	\N	2025-10-01 12:29:28.246693	1521.00	1	Pago automático	\N	completed	\N
129	4	137	\N	2025-10-01 12:29:33.045776	448.50	1	Pago automático	\N	completed	\N
130	4	138	\N	2025-10-01 12:32:24.703305	585.00	1	Pago automático	\N	completed	\N
131	4	139	\N	2025-10-01 12:32:29.58159	390.00	1	Pago automático	\N	completed	\N
132	4	140	\N	2025-10-01 12:32:34.997292	390.00	1	Pago automático	\N	completed	\N
133	4	141	\N	2025-10-01 12:32:39.967191	195.00	1	Pago automático	\N	completed	\N
134	4	142	\N	2025-10-01 12:35:11.210669	390.00	1	Pago automático	\N	completed	\N
135	4	143	\N	2025-10-01 12:35:17.426253	390.00	1	Pago automático	\N	completed	\N
136	4	144	\N	2025-10-01 12:35:23.021316	390.00	1	Pago automático	\N	completed	\N
137	4	145	\N	2025-10-01 12:55:42.60153	390.00	1	Pago automático	\N	completed	\N
138	4	146	\N	2025-10-01 12:55:50.015379	390.00	1	Pago automático	\N	completed	\N
139	4	147	\N	2025-10-01 12:55:55.95416	390.00	1	Pago automático	\N	completed	\N
140	4	148	\N	2025-10-01 13:41:32.409279	390.00	1	Pago automático	\N	completed	\N
141	4	149	\N	2025-10-01 13:41:38.300239	390.00	1	Pago automático	\N	completed	\N
142	4	150	\N	2025-10-01 13:41:43.014625	390.00	1	Pago automático	\N	completed	\N
143	4	151	\N	2025-10-01 13:50:44.493166	390.00	1	Pago automático	\N	completed	\N
144	4	152	\N	2025-10-01 13:50:48.25468	390.00	1	Pago automático	\N	completed	\N
145	4	153	\N	2025-10-01 13:50:51.889003	390.00	1	Pago automático	\N	completed	\N
146	4	154	\N	2025-10-01 13:51:36.746958	390.00	1	Pago automático	\N	completed	\N
147	4	155	\N	2025-10-01 13:51:40.818419	390.00	1	Pago automático	\N	completed	\N
148	4	156	\N	2025-10-01 13:51:43.999884	390.00	1	Pago automático	\N	completed	\N
149	4	157	\N	2025-10-01 16:24:35.427084	409.50	1	Pago automático	\N	completed	\N
150	4	158	\N	2025-10-01 16:24:41.168838	234.00	1	Pago automático	\N	completed	\N
151	4	159	\N	2025-10-01 16:24:46.785154	448.50	1	Pago automático	\N	completed	\N
152	4	160	\N	2025-10-03 10:59:28.419361	390.00	1	Pago automático	\N	completed	\N
153	4	161	\N	2025-10-03 10:59:33.374218	390.00	1	Pago automático	\N	completed	\N
154	4	162	\N	2025-10-03 10:59:36.988488	390.00	1	Pago automático	\N	completed	\N
155	4	163	\N	2025-10-03 10:59:59.79171	390.00	1	Pago automático	\N	completed	\N
156	4	164	\N	2025-10-03 11:00:06.650075	390.00	1	Pago automático	\N	completed	\N
157	4	165	\N	2025-10-03 11:00:12.144568	390.00	1	Pago automático	\N	completed	\N
158	4	166	\N	2025-10-03 11:01:09.127085	390.00	1	Pago automático	\N	completed	\N
159	4	167	\N	2025-10-03 11:01:12.746617	390.00	1	Pago automático	\N	completed	\N
160	4	168	\N	2025-10-03 11:01:16.167144	390.00	1	Pago automático	\N	completed	\N
161	4	169	\N	2025-10-03 11:01:20.467409	390.00	1	Pago automático	\N	completed	\N
162	4	170	\N	2025-10-03 11:07:47.326118	390.00	1	Pago automático	\N	completed	\N
163	4	171	\N	2025-10-03 11:07:56.292628	390.00	1	Pago automático	\N	completed	\N
164	4	172	\N	2025-10-03 11:08:01.215229	390.00	1	Pago automático	\N	completed	\N
165	4	173	\N	2025-10-03 11:08:04.884213	390.00	1	Pago automático	\N	completed	\N
166	4	174	\N	2025-10-03 11:57:15.054335	389.80	1	Pago automático	\N	completed	\N
167	4	175	\N	2025-10-03 11:57:21.417197	390.00	1	Pago automático	\N	completed	\N
168	4	176	\N	2025-10-03 11:57:25.537869	390.00	1	Pago automático	\N	completed	\N
169	4	177	\N	2025-10-03 12:06:05.959801	390.00	1	Pago automático	\N	completed	\N
170	4	178	\N	2025-10-03 12:06:13.205011	390.00	1	Pago automático	\N	completed	\N
171	4	179	\N	2025-10-03 12:13:26.719033	390.00	1	Pago automático	\N	completed	\N
172	4	180	\N	2025-10-03 12:13:31.719481	390.00	1	Pago automático	\N	completed	\N
173	4	181	\N	2025-10-03 12:13:39.600059	390.00	1	Pago automático	\N	completed	\N
174	4	182	\N	2025-10-03 12:17:32.914228	20.00	1	Pago automático	\N	completed	\N
175	4	183	\N	2025-10-03 12:17:43.333517	390.00	1	Pago automático	\N	completed	\N
176	4	184	\N	2025-10-03 12:17:49.129442	390.00	1	Pago automático	\N	completed	\N
177	4	185	\N	2025-10-03 12:17:52.900873	390.00	1	Pago automático	\N	completed	\N
178	4	186	\N	2025-10-03 12:17:57.084963	390.00	1	Pago automático	\N	completed	\N
179	4	187	\N	2025-10-03 12:18:01.841786	390.00	1	Pago automático	\N	completed	\N
180	4	188	\N	2025-10-03 12:42:38.303603	390.00	1	Pago automático	\N	completed	\N
181	4	189	\N	2025-10-03 12:42:41.937915	390.00	1	Pago automático	\N	completed	\N
182	4	190	\N	2025-10-03 12:42:46.992787	390.00	1	Pago automático	\N	completed	\N
183	4	191	\N	2025-10-03 12:42:50.731762	390.00	1	Pago automático	\N	completed	\N
184	4	192	\N	2025-10-03 12:42:53.958217	390.00	1	Pago automático	\N	completed	\N
185	4	193	\N	2025-10-03 12:42:57.728545	390.00	1	Pago automático	\N	completed	\N
186	12	197	\N	2025-10-16 10:41:58.040914	123.00	1	Pago automático	\N	completed	\N
187	12	199	\N	2025-10-16 14:56:58.130339	12.00	1	Pago automático	\N	completed	\N
188	12	\N	6	2025-10-17 10:52:43.157128	2123.00	1	\N	credit	completed	\N
189	12	\N	8	2025-10-17 10:52:43.157128	123.00	1	\N	credit	completed	\N
190	12	\N	9	2025-10-17 10:52:43.157128	123.00	1	\N	credit	completed	\N
191	12	\N	10	2025-10-17 10:52:43.157128	123.00	1	\N	credit	completed	\N
192	12	\N	11	2025-10-17 10:52:43.157128	123.00	1	\N	credit	completed	\N
193	12	\N	12	2025-10-17 10:52:43.157128	123.00	1	\N	credit	completed	\N
202	12	234	\N	2025-11-10 13:22:18.35904	1.00	1	Pago automático	\N	completed	\N
203	12	235	\N	2025-11-10 13:22:43.758834	1.00	1	Pago automático	\N	completed	\N
204	12	237	\N	2025-11-10 13:25:07.413153	1.00	2	Pago automático	\N	completed	\N
205	12	263	\N	2025-11-10 16:22:48.243405	573.50	1	Pago automático	\N	completed	\N
206	12	264	\N	2025-11-10 16:23:19.813367	573.50	1	Pago automático	\N	completed	\N
207	12	265	\N	2025-11-10 16:24:50.938479	604.50	1	Pago automático	\N	completed	\N
208	12	266	\N	2025-11-10 16:27:06.232457	604.50	1	Pago automático	\N	completed	\N
209	12	267	\N	2025-11-10 16:27:51.832495	604.50	1	Pago automático	\N	completed	\N
210	12	268	\N	2025-11-10 16:28:35.796184	604.50	1	Pago automático	\N	completed	\N
\.


--
-- TOC entry 4499 (class 0 OID 18173)
-- Dependencies: 268
-- Data for Name: products; Type: TABLE DATA; Schema: public; Owner: postgres
--

COPY public.products (product_id, name, description, category, fuel_type, unit, unit_price, is_active, created_at, updated_at) FROM stdin;
1	Gasolina de 95 octanos		combustible	otro	galón	19.50	t	2025-09-16 16:31:21.089202	\N
2	Diésel (B5 S-50)		combustible	otro	galón	16.70	t	2025-09-16 16:32:06.634461	\N
3	Diésel Premium		combustible	otro	galón	18.40	t	2025-09-16 16:32:38.488619	\N
4	Gas Licuado del Petróleo (GLP)		otro	otro	galón	8.50	t	2025-09-16 16:34:24.797392	\N
5	Gasol 25		combustible	otro	galón	10.00	t	2025-09-19 15:22:12.979701	\N
\.


--
-- TOC entry 4501 (class 0 OID 18184)
-- Dependencies: 270
-- Data for Name: pump_tank; Type: TABLE DATA; Schema: public; Owner: postgres
--

COPY public.pump_tank (id, pump_id, tank_id, created_at, updated_at) FROM stdin;
1	1	1	2025-09-16 16:35:56.095536	2025-09-16 16:35:56.095536
2	2	2	2025-09-16 16:36:09.570303	2025-09-16 16:36:09.570303
3	3	3	2025-09-16 16:36:17.368203	2025-09-16 16:36:17.368203
5	4	4	2025-09-19 15:23:46.998369	2025-09-19 15:23:46.998369
6	4	5	2025-09-19 15:23:47.007182	2025-09-19 15:23:47.007182
\.


--
-- TOC entry 4503 (class 0 OID 18190)
-- Dependencies: 272
-- Data for Name: pumps; Type: TABLE DATA; Schema: public; Owner: postgres
--

COPY public.pumps (pump_id, pump_number, pump_name, location_description, created_at, updated_at) FROM stdin;
1	S-001	Surtidor 001	\N	2025-09-16 16:35:55.827213	\N
2	S-002	Surtidor 002	\N	2025-09-16 16:36:09.406082	\N
3	S-003	Surtidor 003	\N	2025-09-16 16:36:17.199131	\N
4	S-004	Surtidor 004	\N	2025-09-16 16:36:25.643969	\N
\.


--
-- TOC entry 4505 (class 0 OID 18197)
-- Dependencies: 274
-- Data for Name: purchase_attachments; Type: TABLE DATA; Schema: public; Owner: postgres
--

COPY public.purchase_attachments (attachment_id, purchase_id, storage_path, mime_type, original_name, uploaded_by, uploaded_at) FROM stdin;
\.


--
-- TOC entry 4507 (class 0 OID 18204)
-- Dependencies: 276
-- Data for Name: purchase_lines; Type: TABLE DATA; Schema: public; Owner: postgres
--

COPY public.purchase_lines (line_id, purchase_id, line_no, line_type, supplier_id, invoice_number, discount_header, subtotal_header, tax_header, total_amount, payment_status, amount_paid, notes, product_id, product_name, quantity, unit_cost, line_discount, subtotal_item, created_at, updated_at, doc_type_code, series, doc_number, issue_date, due_date, currency_code, fx_rate, station_id, cost_center_id, external_ref, approved_by, responsible_received_by, attachment_count, uom, tax_rate, is_tax_exempt, tank_id, nozzle_id, landed_cost, lot_number, expiry_date, is_capex, note, received_qty, is_fully_received) FROM stdin;
7	9001	1	ITEM	\N	\N	\N	\N	\N	\N	\N	\N	\N	\N	Filtro	2.000	50.0000	\N	\N	2025-10-13 15:16:51.766153	2025-10-13 16:00:03.929736	\N	\N	\N	\N	\N	\N	\N	\N	\N	\N	\N	\N	0	\N	18.00	f	\N	\N	14.2857	\N	\N	f	\N	1.500	f
8	9001	2	ITEM	\N	\N	\N	\N	\N	\N	\N	\N	\N	\N	Guantes	5.000	8.0000	\N	\N	2025-10-13 15:16:51.766153	2025-10-13 16:00:03.929736	\N	\N	\N	\N	\N	\N	\N	\N	\N	\N	\N	\N	0	\N	\N	t	\N	\N	5.7143	\N	\N	f	\N	3.000	f
1	9001	0	HEADER	5	\N	10.00	140.00	18.00	148.00	PARTIAL	50.00	\N	\N	\N	\N	\N	\N	\N	2025-10-13 15:04:22.394298	2025-10-13 16:00:03.929736	\N	\N	\N	\N	\N	\N	\N	\N	\N	\N	\N	\N	0	\N	\N	f	\N	\N	\N	\N	\N	f	\N	0.000	f
\.


--
-- TOC entry 4509 (class 0 OID 18219)
-- Dependencies: 278
-- Data for Name: purchase_receipt_lines; Type: TABLE DATA; Schema: public; Owner: postgres
--

COPY public.purchase_receipt_lines (receipt_line_id, receipt_id, line_id, received_qty) FROM stdin;
1	1	7	1.500
2	1	8	3.000
\.


--
-- TOC entry 4511 (class 0 OID 18224)
-- Dependencies: 280
-- Data for Name: purchase_receipts; Type: TABLE DATA; Schema: public; Owner: postgres
--

COPY public.purchase_receipts (receipt_id, purchase_id, received_at, received_by, document_ref) FROM stdin;
1	9001	2025-10-13 15:58:36.960734	\N	Guía 001-12345
\.


--
-- TOC entry 4486 (class 0 OID 18101)
-- Dependencies: 255
-- Data for Name: sale_details; Type: TABLE DATA; Schema: public; Owner: postgres
--

COPY public.sale_details (sale_detail_id, sale_id, product_id, quantity, unit_price_at_sale, discount_amount, tax_rate, tax_amount, subtotal, created_at, updated_at) FROM stdin;
1	3	1	6.308	19.50	0.00	0.18	0.00	106.04	2025-09-17 11:56:46.04878	\N
11	12	2	1.198	16.70	0.00	0.18	0.00	17.25	2025-09-19 11:48:46.213251	\N
12	13	1	1.538	19.50	0.00	0.18	0.00	25.85	2025-09-19 14:29:31.785662	\N
13	14	2	1.198	16.70	0.00	0.18	0.00	17.25	2025-09-19 14:29:38.035948	\N
14	15	3	2.174	18.40	0.00	0.18	0.00	34.48	2025-09-19 14:29:43.182589	\N
15	16	4	10.000	8.50	0.00	0.18	0.00	73.28	2025-09-19 14:29:48.541502	\N
16	17	1	1.000	19.50	0.00	0.18	0.00	16.81	2025-09-22 14:42:17.902429	\N
17	18	1	6.308	19.50	0.00	0.18	0.00	106.04	2025-09-22 16:42:54.868432	\N
18	19	3	6.685	18.40	0.00	0.18	0.00	106.03	2025-09-22 16:43:03.5132	\N
19	20	1	1.000	19.50	0.00	0.18	0.00	16.81	2025-09-22 16:53:10.369249	\N
20	21	1	6.000	19.50	0.00	0.18	0.00	100.86	2025-09-23 13:19:52.354259	\N
21	22	1	0.051	19.50	0.00	0.18	0.00	0.85	2025-09-23 13:26:12.404404	\N
22	23	1	10.000	19.50	0.00	0.18	0.00	168.10	2025-09-23 13:26:56.744157	\N
23	24	1	6.000	19.50	0.00	0.18	0.00	100.86	2025-09-23 14:06:20.948283	\N
24	25	1	6.000	19.50	0.00	0.18	0.00	100.86	2025-09-23 14:07:09.680136	\N
25	26	1	6.000	19.50	0.00	0.18	0.00	100.86	2025-09-23 15:02:15.418786	\N
26	27	1	30.000	19.50	0.00	0.18	0.00	504.31	2025-09-23 15:06:40.897053	\N
27	28	1	2.000	19.50	0.00	0.18	0.00	33.62	2025-09-23 15:16:12.075796	\N
28	29	1	1.538	19.50	0.00	0.18	0.00	25.85	2025-09-24 12:43:22.048523	\N
29	30	1	1.538	19.50	0.00	0.18	0.00	25.85	2025-09-24 14:20:13.979047	\N
30	31	1	4.615	19.50	0.00	0.18	0.00	77.58	2025-09-24 14:20:19.78054	\N
31	32	1	1.538	19.50	0.00	0.18	0.00	25.85	2025-09-25 14:08:15.491422	\N
32	33	1	4.615	19.50	0.00	0.18	0.00	77.58	2025-09-25 14:08:21.366448	\N
33	34	2	39.521	16.70	0.00	0.18	0.00	568.97	2025-09-25 14:08:28.40724	\N
34	35	3	11.957	18.40	0.00	0.18	0.00	189.66	2025-09-25 14:08:34.133453	\N
35	36	4	10.588	8.50	0.00	0.18	0.00	77.59	2025-09-25 14:08:41.364023	\N
36	37	2	0.898	16.70	0.00	0.18	0.00	12.93	2025-09-26 10:17:31.580492	\N
37	38	2	0.060	16.70	0.00	0.18	0.00	0.86	2025-09-26 10:17:44.444678	\N
38	39	2	14.000	16.70	0.00	0.18	0.00	201.55	2025-09-26 10:18:35.352384	\N
39	40	2	1.000	16.70	0.00	0.18	0.00	14.40	2025-09-26 10:18:50.62012	\N
40	41	2	1.000	16.70	0.00	0.18	0.00	14.40	2025-09-26 10:19:02.688625	\N
42	43	1	4.615	19.50	0.00	0.18	0.00	77.58	2025-09-26 13:50:58.518832	\N
43	44	1	10.769	19.50	0.00	0.18	0.00	181.03	2025-09-26 13:51:03.650885	\N
44	45	2	23.952	16.70	0.00	0.18	0.00	344.83	2025-09-26 13:51:09.202462	\N
45	46	3	16.304	18.40	0.00	0.18	0.00	258.61	2025-09-26 13:51:18.869066	\N
46	47	4	94.118	8.50	0.00	0.18	0.00	689.66	2025-09-26 13:51:24.552452	\N
47	48	1	1.179	19.50	0.00	0.18	0.00	19.82	2025-09-26 14:02:07.240908	\N
48	49	1	6.308	19.50	0.00	0.18	0.00	106.04	2025-09-26 14:08:30.593043	\N
49	50	1	2.308	19.50	0.00	0.18	0.00	38.80	2025-09-26 14:08:37.246887	\N
50	51	2	12.754	16.70	0.00	0.18	0.00	183.61	2025-09-26 14:08:43.538961	\N
51	52	3	29.511	18.40	0.00	0.18	0.00	468.10	2025-09-26 14:08:48.837897	\N
52	53	4	14.471	8.50	0.00	0.18	0.00	106.03	2025-09-26 14:08:53.180316	\N
53	55	1	6.308	19.50	0.00	0.18	0.00	106.04	2025-09-26 14:09:36.78258	\N
54	56	1	15.385	19.50	0.00	0.18	0.00	258.63	2025-09-26 15:53:18.533711	\N
55	57	1	30.769	19.50	0.00	0.18	0.00	517.24	2025-09-26 16:16:04.9355	\N
56	58	1	30.769	19.50	0.00	0.18	0.00	517.24	2025-09-26 16:16:11.329414	\N
57	59	1	46.154	19.50	0.00	0.18	0.00	775.86	2025-09-26 16:25:36.427028	\N
58	60	1	10.000	19.50	0.00	0.18	0.00	168.10	2025-09-26 16:47:32.33289	\N
59	61	1	4.615	19.50	0.00	0.18	0.00	77.58	2025-09-29 11:33:23.546141	\N
60	62	1	46.154	19.50	0.00	0.18	0.00	775.86	2025-09-29 11:33:31.221725	\N
61	63	1	900.000	19.50	0.00	0.18	0.00	15129.31	2025-09-29 11:34:33.390338	\N
62	64	1	15.385	19.50	0.00	0.18	0.00	258.63	2025-09-29 12:09:53.890464	\N
63	65	1	10.256	19.50	0.00	0.18	0.00	172.41	2025-09-29 12:09:59.198453	\N
64	66	2	7.305	16.70	0.00	0.18	0.00	105.16	2025-09-29 12:10:03.682071	\N
65	67	3	6.630	18.40	0.00	0.18	0.00	105.16	2025-09-29 12:10:10.936225	\N
66	68	4	37.882	8.50	0.00	0.18	0.00	277.59	2025-09-29 12:10:16.325027	\N
67	69	1	11.385	19.50	0.00	0.18	0.00	191.39	2025-09-29 12:11:33.367627	\N
68	70	1	2.256	19.50	0.00	0.18	0.00	37.92	2025-09-29 12:11:38.771975	\N
69	71	1	15.385	19.50	0.00	0.18	0.00	258.63	2025-09-29 12:12:44.992867	\N
70	72	1	46.154	19.50	0.00	0.18	0.00	775.86	2025-09-29 12:12:59.648009	\N
71	73	1	46.154	19.50	0.00	0.18	0.00	775.86	2025-09-29 12:16:06.390925	\N
72	74	1	46.256	19.50	0.00	0.18	0.00	777.58	2025-09-29 12:16:12.793601	\N
73	75	1	1.026	19.50	0.00	0.18	0.00	17.25	2025-09-29 13:32:43.265831	\N
74	76	1	20.513	19.50	0.00	0.18	0.00	344.83	2025-09-29 13:32:47.878255	\N
75	77	1	1.538	19.50	0.00	0.18	0.00	25.85	2025-09-29 13:32:53.344639	\N
76	78	1	3.590	19.50	0.00	0.18	0.00	60.34	2025-09-29 13:32:58.062027	\N
77	79	1	0.615	19.50	0.00	0.18	0.00	10.34	2025-09-29 14:46:32.212893	\N
78	80	1	1.641	19.50	0.00	0.18	0.00	27.59	2025-09-29 14:46:37.376996	\N
79	81	1	27.846	19.50	0.00	0.18	0.00	468.10	2025-09-29 14:46:42.346865	\N
80	82	1	15.385	19.50	0.00	0.18	0.00	258.63	2025-09-29 15:10:47.021415	\N
81	83	1	38.154	19.50	0.00	0.18	0.00	641.38	2025-09-29 15:10:53.268655	\N
82	84	1	0.615	19.50	0.00	0.18	0.00	10.34	2025-09-29 15:11:00.020426	\N
83	85	1	4.000	19.50	0.00	0.18	0.00	67.24	2025-09-29 15:11:05.226875	\N
84	86	1	3.179	19.50	0.00	0.18	0.00	53.44	2025-09-29 15:11:11.64166	\N
85	87	1	63.333	19.50	0.00	0.18	0.00	1064.65	2025-09-29 15:23:02.986121	\N
86	88	1	6.410	19.50	0.00	0.18	0.00	107.76	2025-09-29 15:23:47.302301	\N
87	89	1	5.077	19.50	0.00	0.18	0.00	85.34	2025-09-29 16:16:46.792655	\N
88	90	1	0.615	19.50	0.00	0.18	0.00	10.34	2025-09-29 16:17:20.238201	\N
89	91	1	2.308	19.50	0.00	0.18	0.00	38.80	2025-09-29 16:17:25.427668	\N
90	92	1	2.564	19.50	0.00	0.18	0.00	43.10	2025-09-29 16:17:30.546775	\N
91	93	1	13.128	19.50	0.00	0.18	0.00	220.69	2025-09-29 16:17:34.964883	\N
92	94	1	2.667	19.50	0.00	0.18	0.00	44.84	2025-09-29 16:28:06.044082	\N
93	95	1	38.564	19.50	0.00	0.18	0.00	648.28	2025-09-29 16:28:10.810342	\N
94	96	1	12.667	19.50	0.00	0.18	0.00	212.94	2025-09-29 16:28:14.559436	\N
95	97	1	0.615	19.50	0.00	0.18	0.00	10.34	2025-09-30 11:44:22.052229	\N
96	98	1	0.615	19.50	0.00	0.18	0.00	10.34	2025-09-30 11:44:26.99794	\N
97	99	1	30.000	19.50	0.00	0.18	0.00	504.31	2025-09-30 11:44:34.187936	\N
98	100	1	80.000	19.50	0.00	0.18	0.00	1344.83	2025-09-30 11:45:08.921866	\N
99	101	1	1.179	19.50	0.00	0.18	0.00	19.82	2025-09-30 12:28:40.687264	\N
100	102	1	0.615	19.50	0.00	0.18	0.00	10.34	2025-09-30 12:28:44.197855	\N
101	103	1	1.179	19.50	0.00	0.18	0.00	19.82	2025-09-30 12:49:11.183817	\N
102	104	1	2.872	19.50	0.00	0.18	0.00	48.28	2025-09-30 12:49:18.960013	\N
103	105	1	20.000	19.50	0.00	0.18	0.00	336.21	2025-09-30 12:49:27.569939	\N
104	106	1	12.000	19.50	0.00	0.18	0.00	201.72	2025-09-30 13:07:56.126971	\N
105	107	1	14.000	19.50	0.00	0.18	0.00	235.34	2025-09-30 13:07:59.748576	\N
106	108	1	2.308	19.50	0.00	0.18	0.00	38.80	2025-09-30 13:59:11.528106	\N
107	109	1	0.718	19.50	0.00	0.18	0.00	12.07	2025-09-30 13:59:15.597825	\N
108	110	1	4.000	19.50	0.00	0.18	0.00	67.24	2025-09-30 13:59:23.577497	\N
109	111	1	6.308	19.50	0.00	0.18	0.00	106.04	2025-09-30 14:00:07.779879	\N
110	112	1	78.000	19.50	0.00	0.18	0.00	1311.21	2025-09-30 14:11:52.786688	\N
111	113	1	47.000	19.50	0.00	0.18	0.00	790.09	2025-09-30 14:11:58.348969	\N
112	114	1	1.538	19.50	0.00	0.18	0.00	25.85	2025-09-30 14:17:24.360167	\N
113	115	1	0.615	19.50	0.00	0.18	0.00	10.34	2025-09-30 14:17:28.317743	\N
114	116	1	2.103	19.50	0.00	0.18	0.00	35.35	2025-09-30 14:17:32.928983	\N
115	117	1	45.000	19.50	0.00	0.18	0.00	756.47	2025-09-30 14:18:55.940801	\N
116	118	1	14.000	19.50	0.00	0.18	0.00	235.34	2025-09-30 14:19:01.409469	\N
117	119	1	10.000	19.50	0.00	0.18	0.00	168.10	2025-09-30 14:19:07.648415	\N
118	120	1	20.000	19.50	0.00	0.18	0.00	336.21	2025-09-30 14:27:29.766162	\N
119	121	1	10.000	19.50	0.00	0.18	0.00	168.10	2025-09-30 14:27:34.07797	\N
120	122	1	30.000	19.50	0.00	0.18	0.00	504.31	2025-09-30 14:27:38.15537	\N
121	123	1	10.000	19.50	0.00	0.18	0.00	168.10	2025-09-30 14:32:44.651576	\N
122	124	1	10.000	19.50	0.00	0.18	0.00	168.10	2025-09-30 14:32:49.034117	\N
123	125	1	10.000	19.50	0.00	0.18	0.00	168.10	2025-09-30 14:32:54.189575	\N
124	126	1	20.000	19.50	0.00	0.18	0.00	336.21	2025-09-30 14:32:58.444121	\N
125	127	1	20.000	19.50	0.00	0.18	0.00	336.21	2025-09-30 14:39:20.566845	\N
126	128	1	10.000	19.50	0.00	0.18	0.00	168.10	2025-09-30 14:39:29.344478	\N
127	129	1	10.000	19.50	0.00	0.18	0.00	168.10	2025-09-30 14:39:34.05427	\N
128	130	1	20.000	19.50	0.00	0.18	0.00	336.21	2025-09-30 15:31:28.695827	\N
129	131	1	10.000	19.50	0.00	0.18	0.00	168.10	2025-09-30 15:31:32.628076	\N
130	132	1	19.980	19.50	0.00	0.18	0.00	335.87	2025-09-30 15:46:22.527675	\N
131	133	1	10.000	19.50	0.00	0.18	0.00	168.10	2025-09-30 15:46:26.46285	\N
132	134	1	30.000	19.50	0.00	0.18	0.00	504.31	2025-09-30 15:46:30.466387	\N
133	135	1	0.615	19.50	0.00	0.18	0.00	10.34	2025-10-01 12:29:20.656795	\N
134	136	1	78.000	19.50	0.00	0.18	0.00	1311.21	2025-10-01 12:29:28.246693	\N
135	137	1	23.000	19.50	0.00	0.18	0.00	386.64	2025-10-01 12:29:33.045776	\N
136	138	1	30.000	19.50	0.00	0.18	0.00	504.31	2025-10-01 12:32:24.703305	\N
137	139	1	20.000	19.50	0.00	0.18	0.00	336.21	2025-10-01 12:32:29.58159	\N
138	140	1	20.000	19.50	0.00	0.18	0.00	336.21	2025-10-01 12:32:34.997292	\N
139	141	1	10.000	19.50	0.00	0.18	0.00	168.10	2025-10-01 12:32:39.967191	\N
140	142	1	20.000	19.50	0.00	0.18	0.00	336.21	2025-10-01 12:35:11.210669	\N
141	143	1	20.000	19.50	0.00	0.18	0.00	336.21	2025-10-01 12:35:17.426253	\N
142	144	1	20.000	19.50	0.00	0.18	0.00	336.21	2025-10-01 12:35:23.021316	\N
143	145	1	20.000	19.50	0.00	0.18	0.00	336.21	2025-10-01 12:55:42.60153	\N
144	146	1	20.000	19.50	0.00	0.18	0.00	336.21	2025-10-01 12:55:50.015379	\N
145	147	1	20.000	19.50	0.00	0.18	0.00	336.21	2025-10-01 12:55:55.95416	\N
146	148	1	20.000	19.50	0.00	0.18	0.00	336.21	2025-10-01 13:41:32.409279	\N
147	149	1	20.000	19.50	0.00	0.18	0.00	336.21	2025-10-01 13:41:38.300239	\N
148	150	1	20.000	19.50	0.00	0.18	0.00	336.21	2025-10-01 13:41:43.014625	\N
149	151	1	20.000	19.50	0.00	0.18	0.00	336.21	2025-10-01 13:50:44.493166	\N
150	152	1	20.000	19.50	0.00	0.18	0.00	336.21	2025-10-01 13:50:48.25468	\N
151	153	1	20.000	19.50	0.00	0.18	0.00	336.21	2025-10-01 13:50:51.889003	\N
152	154	1	20.000	19.50	0.00	0.18	0.00	336.21	2025-10-01 13:51:36.746958	\N
153	155	1	20.000	19.50	0.00	0.18	0.00	336.21	2025-10-01 13:51:40.818419	\N
154	156	1	20.000	19.50	0.00	0.18	0.00	336.21	2025-10-01 13:51:43.999884	\N
155	157	1	21.000	19.50	0.00	0.18	0.00	353.02	2025-10-01 16:24:35.427084	\N
156	158	1	12.000	19.50	0.00	0.18	0.00	201.72	2025-10-01 16:24:41.168838	\N
157	159	1	23.000	19.50	0.00	0.18	0.00	386.64	2025-10-01 16:24:46.785154	\N
158	160	1	20.000	19.50	0.00	0.18	0.00	336.21	2025-10-03 10:59:28.419361	\N
159	161	1	20.000	19.50	0.00	0.18	0.00	336.21	2025-10-03 10:59:33.374218	\N
160	162	1	20.000	19.50	0.00	0.18	0.00	336.21	2025-10-03 10:59:36.988488	\N
161	163	1	20.000	19.50	0.00	0.18	0.00	336.21	2025-10-03 10:59:59.79171	\N
162	164	1	20.000	19.50	0.00	0.18	0.00	336.21	2025-10-03 11:00:06.650075	\N
163	165	1	20.000	19.50	0.00	0.18	0.00	336.21	2025-10-03 11:00:12.144568	\N
164	166	1	20.000	19.50	0.00	0.18	0.00	336.21	2025-10-03 11:01:09.127085	\N
165	167	1	20.000	19.50	0.00	0.18	0.00	336.21	2025-10-03 11:01:12.746617	\N
166	168	1	20.000	19.50	0.00	0.18	0.00	336.21	2025-10-03 11:01:16.167144	\N
167	169	1	20.000	19.50	0.00	0.18	0.00	336.21	2025-10-03 11:01:20.467409	\N
168	170	1	20.000	19.50	0.00	0.18	0.00	336.21	2025-10-03 11:07:47.326118	\N
169	171	1	20.000	19.50	0.00	0.18	0.00	336.21	2025-10-03 11:07:56.292628	\N
170	172	1	20.000	19.50	0.00	0.18	0.00	336.21	2025-10-03 11:08:01.215229	\N
171	173	1	20.000	19.50	0.00	0.18	0.00	336.21	2025-10-03 11:08:04.884213	\N
172	174	1	19.990	19.50	0.00	0.18	0.00	336.03	2025-10-03 11:57:15.054335	\N
173	175	1	20.000	19.50	0.00	0.18	0.00	336.21	2025-10-03 11:57:21.417197	\N
174	176	1	20.000	19.50	0.00	0.18	0.00	336.21	2025-10-03 11:57:25.537869	\N
175	177	1	20.000	19.50	0.00	0.18	0.00	336.21	2025-10-03 12:06:05.959801	\N
176	178	1	20.000	19.50	0.00	0.18	0.00	336.21	2025-10-03 12:06:13.205011	\N
177	179	1	20.000	19.50	0.00	0.18	0.00	336.21	2025-10-03 12:13:26.719033	\N
178	180	1	20.000	19.50	0.00	0.18	0.00	336.21	2025-10-03 12:13:31.719481	\N
179	181	1	20.000	19.50	0.00	0.18	0.00	336.21	2025-10-03 12:13:39.600059	\N
180	182	1	1.026	19.50	0.00	0.18	0.00	17.25	2025-10-03 12:17:32.914228	\N
181	183	1	20.000	19.50	0.00	0.18	0.00	336.21	2025-10-03 12:17:43.333517	\N
182	184	1	20.000	19.50	0.00	0.18	0.00	336.21	2025-10-03 12:17:49.129442	\N
183	185	1	20.000	19.50	0.00	0.18	0.00	336.21	2025-10-03 12:17:52.900873	\N
184	186	1	20.000	19.50	0.00	0.18	0.00	336.21	2025-10-03 12:17:57.084963	\N
185	187	1	20.000	19.50	0.00	0.18	0.00	336.21	2025-10-03 12:18:01.841786	\N
186	188	1	20.000	19.50	0.00	0.18	0.00	336.21	2025-10-03 12:42:38.303603	\N
187	189	1	20.000	19.50	0.00	0.18	0.00	336.21	2025-10-03 12:42:41.937915	\N
188	190	1	20.000	19.50	0.00	0.18	0.00	336.21	2025-10-03 12:42:46.992787	\N
189	191	1	20.000	19.50	0.00	0.18	0.00	336.21	2025-10-03 12:42:50.731762	\N
190	192	1	20.000	19.50	0.00	0.18	0.00	336.21	2025-10-03 12:42:53.958217	\N
191	193	1	20.000	19.50	0.00	0.18	0.00	336.21	2025-10-03 12:42:57.728545	\N
192	194	1	108.872	19.50	0.00	0.18	0.00	1830.17	2025-10-14 12:34:15.523794	\N
193	195	3	0.652	18.40	0.00	0.18	0.00	10.34	2025-10-15 15:31:05.356412	\N
194	196	1	6.308	19.50	0.00	0.18	0.00	106.04	2025-10-16 10:40:45.769308	\N
195	197	1	6.308	19.50	0.00	0.18	0.00	106.04	2025-10-16 10:41:58.040914	\N
196	198	1	6.308	19.50	0.00	0.18	0.00	106.04	2025-10-16 14:30:59.753157	\N
197	199	1	0.615	19.50	0.00	0.18	0.00	10.34	2025-10-16 14:56:58.130339	\N
198	200	1	6.308	19.50	0.00	0.18	0.00	106.04	2025-10-16 14:57:09.754307	\N
199	201	1	6.308	19.50	0.00	0.18	0.00	106.04	2025-10-16 14:58:16.674897	\N
200	202	1	6.308	19.50	0.00	0.18	0.00	106.04	2025-10-16 14:59:31.532085	\N
201	204	1	13.026	19.50	0.00	0.18	0.00	218.97	2025-10-17 15:56:36.929721	\N
202	205	1	1.179	19.50	0.00	0.18	0.00	19.82	2025-10-17 15:59:28.45621	\N
203	206	1	1.179	19.50	0.00	0.18	0.00	19.82	2025-10-17 16:00:38.890228	\N
204	209	1	1.333	19.50	0.00	0.18	0.00	22.41	2025-10-17 16:13:46.775621	\N
205	210	1	1.385	19.50	0.00	0.18	0.00	23.28	2025-10-17 16:48:35.912477	\N
206	211	1	0.615	19.50	0.00	0.18	0.00	10.34	2025-10-20 11:35:23.298339	\N
211	234	1	0.051	19.50	0.00	0.18	0.00	0.85	2025-11-10 13:22:18.35904	\N
212	235	1	0.051	19.50	0.00	0.18	0.00	0.85	2025-11-10 13:22:43.758834	\N
213	236	1	0.051	19.50	0.00	0.18	0.00	0.85	2025-11-10 13:24:52.258817	\N
214	237	1	0.051	19.50	0.00	0.18	0.00	0.85	2025-11-10 13:25:07.413153	\N
215	263	1	31.000	19.50	31.00	0.18	0.00	521.12	2025-11-10 16:22:48.243405	\N
216	264	1	31.000	19.50	31.00	0.18	0.00	521.12	2025-11-10 16:23:19.813367	\N
217	265	1	31.000	19.50	0.00	0.18	0.00	521.12	2025-11-10 16:24:50.938479	\N
218	266	1	31.000	19.50	0.00	0.18	0.00	521.12	2025-11-10 16:27:06.232457	\N
219	267	1	31.000	19.50	0.00	0.18	0.00	521.12	2025-11-10 16:27:51.832495	\N
220	268	1	31.000	19.50	0.00	0.18	0.00	604.50	2025-11-10 16:28:35.796184	\N
\.


--
-- TOC entry 4484 (class 0 OID 18084)
-- Dependencies: 253
-- Data for Name: sales; Type: TABLE DATA; Schema: public; Owner: postgres
--

COPY public.sales (sale_id, client_id, user_id, employee_id, nozzle_id, sale_timestamp, total_amount, payment_method_id, status, shift, notes, created_at, discount_amount, final_amount, updated_at, driver_id, sector_id, payment_mode) FROM stdin;
3	\N	12	\N	1	2025-09-17 11:56:51.468	106.03	1	completed	Leon	[pagado_bruto=123.00]	2025-09-17 11:56:51.469	0.00	123.00	\N	\N	\N	contado
5	15	\N	\N	1	2025-09-17 12:08:53.395449	0.00	2	completed	\N	\N	2025-09-17 12:08:53.395449	0.00	\N	\N	\N	\N	contado
12	\N	12	\N	2	2025-09-19 11:48:46.219	17.24	1	completed	Leon	[pagado_bruto=20.00]	2025-09-19 11:48:46.219	0.00	20.00	\N	\N	\N	contado
13	\N	12	\N	5	2025-09-19 14:29:31.788	25.86	1	completed	Lobo	[pagado_bruto=30.00]	2025-09-19 14:29:31.788	0.00	30.00	\N	\N	\N	contado
14	\N	12	\N	2	2025-09-19 14:29:38.04	17.24	1	completed	Lobo	[pagado_bruto=20.00]	2025-09-19 14:29:38.04	0.00	20.00	\N	\N	\N	contado
15	\N	12	\N	3	2025-09-19 14:29:43.189	34.48	1	completed	Lobo	[pagado_bruto=40.00]	2025-09-19 14:29:43.189	0.00	40.00	\N	\N	\N	contado
16	\N	12	\N	4	2025-09-19 14:29:48.545	73.28	1	completed	Lobo	[pagado_bruto=85.00]	2025-09-19 14:29:48.545	0.00	85.00	\N	\N	\N	contado
17	\N	12	\N	5	2025-09-22 14:42:17.904	16.81	1	completed	Lobo	[pagado_bruto=19.50]	2025-09-22 14:42:17.904	0.00	19.50	\N	\N	\N	contado
18	1	12	\N	5	2025-09-22 16:42:54.908	106.03	1	completed	Lobo	[pagado_bruto=123.00]	2025-09-22 16:42:54.908	0.00	123.00	\N	\N	\N	contado
19	3	12	\N	3	2025-09-22 16:43:03.551	106.03	1	completed	Lobo	[pagado_bruto=123.00]	2025-09-22 16:43:03.551	0.00	123.00	\N	\N	\N	contado
20	\N	12	\N	5	2025-09-22 16:53:10.372	16.81	1	completed	Lobo	[pagado_bruto=19.50]	2025-09-22 16:53:10.372	0.00	19.50	\N	\N	\N	contado
21	\N	12	\N	1	2025-09-23 13:19:52.359	100.86	1	completed	Lobo	[pagado_bruto=117.00]	2025-09-23 13:19:52.359	0.00	117.00	\N	\N	\N	contado
22	\N	12	\N	1	2025-09-23 13:26:12.409	0.86	1	completed	Lobo	[pagado_bruto=1.00]	2025-09-23 13:26:12.409	0.00	1.00	\N	\N	\N	contado
23	\N	12	\N	1	2025-09-23 13:26:56.745	168.10	1	completed	Lobo	[pagado_bruto=195.00]	2025-09-23 13:26:56.745	0.00	195.00	\N	\N	\N	contado
24	\N	12	\N	1	2025-09-23 14:06:20.956	100.86	1	completed	Lobo	[pagado_bruto=117.00]	2025-09-23 14:06:20.956	0.00	117.00	\N	\N	\N	contado
25	\N	12	\N	1	2025-09-23 14:07:09.684	100.86	1	completed	Lobo	[pagado_bruto=117.00]	2025-09-23 14:07:09.684	0.00	117.00	\N	\N	\N	contado
26	\N	12	\N	1	2025-09-23 15:02:15.421	100.86	1	completed	Lobo	[pagado_bruto=117.00]	2025-09-23 15:02:15.421	0.00	117.00	\N	\N	\N	contado
27	3	12	\N	1	2025-09-23 15:06:40.901	504.31	4	completed	Lobo	[pagado_bruto=585.00]	2025-09-23 15:06:40.901	0.00	585.00	\N	\N	\N	contado
28	\N	12	\N	5	2025-09-23 15:16:12.08	33.62	1	completed	Lobo	[pagado_bruto=39.00]	2025-09-23 15:16:12.08	0.00	39.00	\N	\N	\N	contado
29	\N	12	\N	1	2025-09-24 12:43:22.054	25.86	1	completed	Lobo	[pagado_bruto=30.00]	2025-09-24 12:43:22.054	0.00	30.00	\N	\N	\N	contado
30	\N	12	\N	5	2025-09-24 14:20:13.983	25.86	1	completed	Lobo	[pagado_bruto=30.00]	2025-09-24 14:20:13.983	0.00	30.00	\N	\N	\N	contado
31	\N	12	\N	1	2025-09-24 14:20:19.783	77.59	1	completed	Lobo	[pagado_bruto=90.00]	2025-09-24 14:20:19.783	0.00	90.00	\N	\N	\N	contado
32	\N	12	\N	1	2025-09-25 14:08:15.496	25.86	1	completed	Lobo	[pagado_bruto=30.00]	2025-09-25 14:08:15.496	0.00	30.00	\N	\N	\N	contado
33	\N	12	\N	5	2025-09-25 14:08:21.368	77.59	1	completed	Lobo	[pagado_bruto=90.00]	2025-09-25 14:08:21.368	0.00	90.00	\N	\N	\N	contado
34	\N	12	\N	2	2025-09-25 14:08:28.408	568.97	1	completed	Lobo	[pagado_bruto=660.00]	2025-09-25 14:08:28.408	0.00	660.00	\N	\N	\N	contado
35	\N	12	\N	3	2025-09-25 14:08:34.14	189.66	1	completed	Lobo	[pagado_bruto=220.00]	2025-09-25 14:08:34.14	0.00	220.00	\N	\N	\N	contado
36	\N	12	\N	4	2025-09-25 14:08:41.367	77.59	1	completed	Lobo	[pagado_bruto=90.00]	2025-09-25 14:08:41.367	0.00	90.00	\N	\N	\N	contado
37	12	12	\N	2	2025-09-26 10:17:33.881	12.93	1	completed	Leon	[pagado_bruto=15.00]	2025-09-26 10:17:33.881	0.00	15.00	\N	\N	\N	contado
38	12	12	\N	2	2025-09-26 10:17:46.632	0.86	1	completed	Leon	[pagado_bruto=1.00]	2025-09-26 10:17:46.633	0.00	1.00	\N	\N	\N	contado
39	12	12	\N	2	2025-09-26 10:18:37.528	201.55	1	completed	Leon	[pagado_bruto=233.80]	2025-09-26 10:18:37.528	0.00	233.80	\N	\N	\N	contado
40	\N	12	\N	2	2025-09-26 10:18:52.928	14.40	1	completed	Leon	[pagado_bruto=16.70]	2025-09-26 10:18:52.928	0.00	16.70	\N	\N	\N	contado
41	\N	12	\N	2	2025-09-26 10:19:04.886	14.40	1	completed	Leon	[pagado_bruto=16.70]	2025-09-26 10:19:04.886	0.00	16.70	\N	\N	\N	contado
43	\N	12	\N	1	2025-09-26 13:50:58.523	77.59	1	completed	Lobo	[pagado_bruto=90.00]	2025-09-26 13:50:58.523	0.00	90.00	\N	\N	\N	contado
44	\N	12	\N	5	2025-09-26 13:51:03.657	181.03	1	completed	Lobo	[pagado_bruto=210.00]	2025-09-26 13:51:03.657	0.00	210.00	\N	\N	\N	contado
45	\N	12	\N	2	2025-09-26 13:51:09.213	344.83	1	completed	Lobo	[pagado_bruto=400.00]	2025-09-26 13:51:09.213	0.00	400.00	\N	\N	\N	contado
46	\N	12	\N	3	2025-09-26 13:51:18.874	258.62	1	completed	Lobo	[pagado_bruto=300.00]	2025-09-26 13:51:18.874	0.00	300.00	\N	\N	\N	contado
47	\N	12	\N	4	2025-09-26 13:51:24.554	689.66	1	completed	Lobo	[pagado_bruto=800.00]	2025-09-26 13:51:24.554	0.00	800.00	\N	\N	\N	contado
48	\N	12	\N	5	2025-09-26 14:02:07.29	19.83	1	completed	Lobo	[pagado_bruto=23.00]	2025-09-26 14:02:07.29	0.00	23.00	\N	\N	\N	contado
49	\N	4	\N	1	2025-09-26 14:08:30.598	106.03	1	completed	Lobo	[pagado_bruto=123.00]	2025-09-26 14:08:30.598	0.00	123.00	\N	\N	\N	contado
50	\N	4	\N	5	2025-09-26 14:08:37.248	38.79	1	completed	Lobo	[pagado_bruto=45.00]	2025-09-26 14:08:37.248	0.00	45.00	\N	\N	\N	contado
51	\N	4	\N	2	2025-09-26 14:08:43.541	183.62	1	completed	Lobo	[pagado_bruto=213.00]	2025-09-26 14:08:43.541	0.00	213.00	\N	\N	\N	contado
52	\N	4	\N	3	2025-09-26 14:08:48.839	468.10	1	completed	Lobo	[pagado_bruto=543.00]	2025-09-26 14:08:48.839	0.00	543.00	\N	\N	\N	contado
53	\N	4	\N	4	2025-09-26 14:08:53.181	106.03	1	completed	Lobo	[pagado_bruto=123.00]	2025-09-26 14:08:53.181	0.00	123.00	\N	\N	\N	contado
55	3	4	\N	1	2025-09-26 14:09:36.784	106.03	4	completed	Lobo	[pagado_bruto=123.00]	2025-09-26 14:09:36.784	0.00	123.00	\N	\N	\N	contado
56	\N	4	\N	1	2025-09-26 15:53:18.536	258.62	1	completed	Lobo	[pagado_bruto=300.00]	2025-09-26 15:53:18.536	0.00	300.00	\N	\N	\N	contado
57	\N	4	\N	1	2025-09-26 16:16:04.939	517.24	1	completed	Lobo	[pagado_bruto=600.00]	2025-09-26 16:16:04.939	0.00	600.00	\N	\N	\N	contado
58	\N	4	\N	5	2025-09-26 16:16:11.33	517.24	1	completed	Lobo	[pagado_bruto=600.00]	2025-09-26 16:16:11.33	0.00	600.00	\N	\N	\N	contado
59	\N	4	\N	1	2025-09-26 16:25:36.428	775.86	1	completed	Lobo	[pagado_bruto=900.00]	2025-09-26 16:25:36.428	0.00	900.00	\N	\N	\N	contado
60	\N	4	\N	1	2025-09-26 16:47:32.334	168.10	1	completed	Lobo	[pagado_bruto=195.00]	2025-09-26 16:47:32.334	0.00	195.00	\N	\N	\N	contado
61	\N	4	\N	1	2025-09-29 11:33:23.551	77.59	1	completed	Leon	[pagado_bruto=90.00]	2025-09-29 11:33:23.551	0.00	90.00	\N	\N	\N	contado
62	\N	4	\N	5	2025-09-29 11:33:31.225	775.86	1	completed	Leon	[pagado_bruto=900.00]	2025-09-29 11:33:31.225	0.00	900.00	\N	\N	\N	contado
63	\N	4	\N	1	2025-09-29 11:34:33.395	15129.31	1	completed	Leon	[pagado_bruto=17550.00]	2025-09-29 11:34:33.395	0.00	17550.00	\N	\N	\N	contado
64	\N	4	\N	1	2025-09-29 12:09:53.895	258.62	1	completed	Lobo	[pagado_bruto=300.00]	2025-09-29 12:09:53.895	0.00	300.00	\N	\N	\N	contado
65	\N	4	\N	5	2025-09-29 12:09:59.199	172.41	1	completed	Lobo	[pagado_bruto=200.00]	2025-09-29 12:09:59.199	0.00	200.00	\N	\N	\N	contado
66	\N	4	\N	2	2025-09-29 12:10:03.683	105.17	1	completed	Lobo	[pagado_bruto=122.00]	2025-09-29 12:10:03.683	0.00	122.00	\N	\N	\N	contado
67	\N	4	\N	3	2025-09-29 12:10:10.937	105.17	1	completed	Lobo	[pagado_bruto=122.00]	2025-09-29 12:10:10.937	0.00	122.00	\N	\N	\N	contado
68	\N	4	\N	4	2025-09-29 12:10:16.33	277.59	1	completed	Lobo	[pagado_bruto=322.00]	2025-09-29 12:10:16.33	0.00	322.00	\N	\N	\N	contado
69	\N	4	\N	1	2025-09-29 12:11:33.369	191.38	1	completed	Lobo	[pagado_bruto=222.00]	2025-09-29 12:11:33.369	0.00	222.00	\N	\N	\N	contado
70	\N	4	\N	1	2025-09-29 12:11:38.776	37.93	1	completed	Lobo	[pagado_bruto=44.00]	2025-09-29 12:11:38.776	0.00	44.00	\N	\N	\N	contado
71	\N	4	\N	5	2025-09-29 12:12:44.997	258.62	1	completed	Lobo	[pagado_bruto=300.00]	2025-09-29 12:12:44.997	0.00	300.00	\N	\N	\N	contado
72	\N	4	\N	5	2025-09-29 12:12:59.649	775.86	1	completed	Lobo	[pagado_bruto=900.00]	2025-09-29 12:12:59.649	0.00	900.00	\N	\N	\N	contado
73	\N	4	\N	5	2025-09-29 12:16:06.398	775.86	1	completed	Lobo	[pagado_bruto=900.00]	2025-09-29 12:16:06.398	0.00	900.00	\N	\N	\N	contado
74	\N	4	\N	5	2025-09-29 12:16:12.798	777.59	1	completed	Lobo	[pagado_bruto=902.00]	2025-09-29 12:16:12.798	0.00	902.00	\N	\N	\N	contado
75	\N	4	\N	5	2025-09-29 13:32:43.267	17.24	1	completed	Lobo	[pagado_bruto=20.00]	2025-09-29 13:32:43.267	0.00	20.00	\N	\N	\N	contado
76	\N	4	\N	1	2025-09-29 13:32:47.882	344.83	1	completed	Lobo	[pagado_bruto=400.00]	2025-09-29 13:32:47.882	0.00	400.00	\N	\N	\N	contado
77	\N	4	\N	5	2025-09-29 13:32:53.349	25.86	1	completed	Lobo	[pagado_bruto=30.00]	2025-09-29 13:32:53.349	0.00	30.00	\N	\N	\N	contado
78	\N	4	\N	5	2025-09-29 13:32:58.063	60.34	1	completed	Lobo	[pagado_bruto=70.00]	2025-09-29 13:32:58.063	0.00	70.00	\N	\N	\N	contado
79	\N	4	\N	5	2025-09-29 14:46:32.217	10.34	1	completed	Lobo	[pagado_bruto=12.00]	2025-09-29 14:46:32.217	0.00	12.00	\N	\N	\N	contado
80	\N	4	\N	1	2025-09-29 14:46:37.378	27.59	1	completed	Lobo	[pagado_bruto=32.00]	2025-09-29 14:46:37.378	0.00	32.00	\N	\N	\N	contado
81	\N	4	\N	5	2025-09-29 14:46:42.348	468.10	1	completed	Lobo	[pagado_bruto=543.00]	2025-09-29 14:46:42.348	0.00	543.00	\N	\N	\N	contado
82	\N	4	\N	5	2025-09-29 15:10:47.026	258.62	1	completed	Lobo	[pagado_bruto=300.00]	2025-09-29 15:10:47.026	0.00	300.00	\N	\N	\N	contado
83	\N	4	\N	5	2025-09-29 15:10:53.271	641.38	1	completed	Lobo	[pagado_bruto=744.00]	2025-09-29 15:10:53.271	0.00	744.00	\N	\N	\N	contado
84	\N	4	\N	5	2025-09-29 15:11:00.024	10.34	1	completed	Lobo	[pagado_bruto=12.00]	2025-09-29 15:11:00.024	0.00	12.00	\N	\N	\N	contado
85	\N	4	\N	5	2025-09-29 15:11:05.23	67.24	1	completed	Lobo	[pagado_bruto=78.00]	2025-09-29 15:11:05.23	0.00	78.00	\N	\N	\N	contado
86	\N	4	\N	5	2025-09-29 15:11:11.646	53.45	1	completed	Lobo	[pagado_bruto=62.00]	2025-09-29 15:11:11.646	0.00	62.00	\N	\N	\N	contado
87	1	12	\N	1	2025-09-29 15:23:07.937	1064.66	1	completed	Lobo	[pagado_bruto=1235.00] [driver_name=Juan Pérez] [driver_dni=12345678] [driver_plate=ABC-123]	2025-09-29 15:23:07.937	0.00	1235.00	\N	\N	\N	contado
89	\N	4	\N	5	2025-09-29 16:16:46.796	85.34	1	completed	Lobo	[pagado_bruto=99.00]	2025-09-29 16:16:46.796	0.00	99.00	\N	\N	\N	contado
90	\N	4	\N	5	2025-09-29 16:17:20.244	10.34	1	completed	Lobo	[pagado_bruto=12.00]	2025-09-29 16:17:20.244	0.00	12.00	\N	\N	\N	contado
91	\N	4	\N	5	2025-09-29 16:17:25.432	38.79	1	completed	Lobo	[pagado_bruto=45.00]	2025-09-29 16:17:25.432	0.00	45.00	\N	\N	\N	contado
92	\N	4	\N	5	2025-09-29 16:17:30.551	43.10	1	completed	Lobo	[pagado_bruto=50.00]	2025-09-29 16:17:30.551	0.00	50.00	\N	\N	\N	contado
93	\N	4	\N	5	2025-09-29 16:17:34.972	220.69	1	completed	Lobo	[pagado_bruto=256.00]	2025-09-29 16:17:34.972	0.00	256.00	\N	\N	\N	contado
94	\N	4	\N	5	2025-09-29 16:28:06.049	44.83	1	completed	Lobo	[pagado_bruto=52.00]	2025-09-29 16:28:06.049	0.00	52.00	\N	\N	\N	contado
95	\N	4	\N	5	2025-09-29 16:28:10.815	648.28	1	completed	Lobo	[pagado_bruto=752.00]	2025-09-29 16:28:10.815	0.00	752.00	\N	\N	\N	contado
96	\N	4	\N	5	2025-09-29 16:28:14.566	212.93	1	completed	Lobo	[pagado_bruto=247.00]	2025-09-29 16:28:14.566	0.00	247.00	\N	\N	\N	contado
97	\N	4	\N	5	2025-09-30 11:44:22.057	10.34	1	completed	Leon	[pagado_bruto=12.00]	2025-09-30 11:44:22.057	0.00	12.00	\N	\N	\N	contado
98	\N	4	\N	5	2025-09-30 11:44:26.999	10.34	1	completed	Leon	[pagado_bruto=12.00]	2025-09-30 11:44:26.999	0.00	12.00	\N	\N	\N	contado
99	\N	4	\N	5	2025-09-30 11:44:34.189	504.31	1	completed	Leon	[pagado_bruto=585.00]	2025-09-30 11:44:34.189	0.00	585.00	\N	\N	\N	contado
100	\N	4	\N	5	2025-09-30 11:45:08.925	1344.83	1	completed	Leon	[pagado_bruto=1560.00]	2025-09-30 11:45:08.925	0.00	1560.00	\N	\N	\N	contado
88	1	12	\N	1	2025-09-29 15:23:52.129	107.76	4	completed	Lobo	[pagado_bruto=125.00] [driver_name=Juan Pérez] [driver_dni=12345678] [driver_plate=ABC-123]	2025-09-29 15:23:52.129	0.00	125.00	\N	3	\N	contado
101	\N	4	\N	5	2025-09-30 12:28:40.692	19.83	1	completed	Lobo	[pagado_bruto=23.00]	2025-09-30 12:28:40.692	0.00	23.00	\N	\N	\N	contado
102	\N	4	\N	5	2025-09-30 12:28:44.202	10.34	1	completed	Lobo	[pagado_bruto=12.00]	2025-09-30 12:28:44.202	0.00	12.00	\N	\N	\N	contado
103	\N	4	\N	5	2025-09-30 12:49:11.185	19.83	1	completed	Lobo	[pagado_bruto=23.00]	2025-09-30 12:49:11.185	0.00	23.00	\N	\N	\N	contado
104	\N	4	\N	5	2025-09-30 12:49:18.961	48.28	1	completed	Lobo	[pagado_bruto=56.00]	2025-09-30 12:49:18.961	0.00	56.00	\N	\N	\N	contado
105	\N	4	\N	5	2025-09-30 12:49:27.576	336.21	1	completed	Lobo	[pagado_bruto=390.00]	2025-09-30 12:49:27.576	0.00	390.00	\N	\N	\N	contado
106	\N	4	\N	5	2025-09-30 13:07:56.133	201.72	1	completed	Lobo	[pagado_bruto=234.00]	2025-09-30 13:07:56.133	0.00	234.00	\N	\N	\N	contado
107	\N	4	\N	5	2025-09-30 13:07:59.75	235.34	1	completed	Lobo	[pagado_bruto=273.00]	2025-09-30 13:07:59.75	0.00	273.00	\N	\N	\N	contado
108	\N	4	\N	5	2025-09-30 13:59:11.53	38.79	1	completed	Lobo	[pagado_bruto=45.00]	2025-09-30 13:59:11.53	0.00	45.00	\N	\N	\N	contado
109	\N	4	\N	5	2025-09-30 13:59:15.605	12.07	1	completed	Lobo	[pagado_bruto=14.00]	2025-09-30 13:59:15.605	0.00	14.00	\N	\N	\N	contado
110	\N	4	\N	5	2025-09-30 13:59:23.582	67.24	1	completed	Lobo	[pagado_bruto=78.00]	2025-09-30 13:59:23.582	0.00	78.00	\N	\N	\N	contado
111	1	12	\N	1	2025-09-30 14:00:14.393	106.03	4	completed	Lobo	[pagado_bruto=123.00] [driver_name=cristian] [driver_dni=14785236] [driver_plate=GJR6JHGI]	2025-09-30 14:00:14.393	0.00	123.00	\N	\N	\N	contado
112	\N	4	\N	5	2025-09-30 14:11:52.791	1311.21	1	completed	Lobo	[pagado_bruto=1521.00]	2025-09-30 14:11:52.791	0.00	1521.00	\N	\N	\N	contado
113	\N	4	\N	5	2025-09-30 14:11:58.353	790.09	1	completed	Lobo	[pagado_bruto=916.50]	2025-09-30 14:11:58.353	0.00	916.50	\N	\N	\N	contado
114	\N	4	\N	5	2025-09-30 14:17:24.364	25.86	1	completed	Lobo	[pagado_bruto=30.00]	2025-09-30 14:17:24.364	0.00	30.00	\N	\N	\N	contado
115	\N	4	\N	5	2025-09-30 14:17:28.326	10.34	1	completed	Lobo	[pagado_bruto=12.00]	2025-09-30 14:17:28.326	0.00	12.00	\N	\N	\N	contado
116	\N	4	\N	5	2025-09-30 14:17:32.933	35.34	1	completed	Lobo	[pagado_bruto=41.00]	2025-09-30 14:17:32.933	0.00	41.00	\N	\N	\N	contado
117	\N	4	\N	5	2025-09-30 14:18:55.945	756.47	1	completed	Lobo	[pagado_bruto=877.50]	2025-09-30 14:18:55.945	0.00	877.50	\N	\N	\N	contado
118	\N	4	\N	5	2025-09-30 14:19:01.41	235.34	1	completed	Lobo	[pagado_bruto=273.00]	2025-09-30 14:19:01.41	0.00	273.00	\N	\N	\N	contado
119	\N	4	\N	5	2025-09-30 14:19:07.649	168.10	1	completed	Lobo	[pagado_bruto=195.00]	2025-09-30 14:19:07.649	0.00	195.00	\N	\N	\N	contado
120	\N	4	\N	5	2025-09-30 14:27:29.772	336.21	1	completed	Lobo	[pagado_bruto=390.00]	2025-09-30 14:27:29.772	0.00	390.00	\N	\N	\N	contado
121	\N	4	\N	5	2025-09-30 14:27:34.079	168.10	1	completed	Lobo	[pagado_bruto=195.00]	2025-09-30 14:27:34.079	0.00	195.00	\N	\N	\N	contado
122	\N	4	\N	5	2025-09-30 14:27:38.156	504.31	1	completed	Lobo	[pagado_bruto=585.00]	2025-09-30 14:27:38.156	0.00	585.00	\N	\N	\N	contado
123	\N	4	\N	5	2025-09-30 14:32:44.656	168.10	1	completed	Lobo	[pagado_bruto=195.00]	2025-09-30 14:32:44.656	0.00	195.00	\N	\N	\N	contado
124	\N	4	\N	5	2025-09-30 14:32:49.036	168.10	1	completed	Lobo	[pagado_bruto=195.00]	2025-09-30 14:32:49.036	0.00	195.00	\N	\N	\N	contado
125	\N	4	\N	5	2025-09-30 14:32:54.195	168.10	1	completed	Lobo	[pagado_bruto=195.00]	2025-09-30 14:32:54.195	0.00	195.00	\N	\N	\N	contado
126	\N	4	\N	5	2025-09-30 14:32:58.446	336.21	1	completed	Lobo	[pagado_bruto=390.00]	2025-09-30 14:32:58.446	0.00	390.00	\N	\N	\N	contado
127	\N	4	\N	5	2025-09-30 14:39:20.568	336.21	1	completed	Lobo	[pagado_bruto=390.00]	2025-09-30 14:39:20.568	0.00	390.00	\N	\N	\N	contado
128	\N	4	\N	5	2025-09-30 14:39:29.348	168.10	1	completed	Lobo	[pagado_bruto=195.00]	2025-09-30 14:39:29.348	0.00	195.00	\N	\N	\N	contado
129	\N	4	\N	5	2025-09-30 14:39:34.059	168.10	1	completed	Lobo	[pagado_bruto=195.00]	2025-09-30 14:39:34.059	0.00	195.00	\N	\N	\N	contado
130	\N	4	\N	5	2025-09-30 15:31:28.698	336.21	1	completed	Lobo	[pagado_bruto=390.00]	2025-09-30 15:31:28.698	0.00	390.00	\N	\N	\N	contado
131	\N	4	\N	5	2025-09-30 15:31:32.63	168.10	1	completed	Lobo	[pagado_bruto=195.00]	2025-09-30 15:31:32.63	0.00	195.00	\N	\N	\N	contado
132	\N	4	\N	5	2025-09-30 15:46:22.533	335.87	1	completed	Lobo	[pagado_bruto=389.61]	2025-09-30 15:46:22.533	0.00	389.61	\N	\N	\N	contado
133	\N	4	\N	5	2025-09-30 15:46:26.473	168.10	1	completed	Lobo	[pagado_bruto=195.00]	2025-09-30 15:46:26.473	0.00	195.00	\N	\N	\N	contado
134	\N	4	\N	5	2025-09-30 15:46:30.469	504.31	1	completed	Lobo	[pagado_bruto=585.00]	2025-09-30 15:46:30.469	0.00	585.00	\N	\N	\N	contado
135	\N	4	\N	5	2025-10-01 12:29:20.662	10.34	1	completed	Lobo	[pagado_bruto=12.00]	2025-10-01 12:29:20.662	0.00	12.00	\N	\N	\N	contado
136	\N	4	\N	5	2025-10-01 12:29:28.247	1311.21	1	completed	Lobo	[pagado_bruto=1521.00]	2025-10-01 12:29:28.247	0.00	1521.00	\N	\N	\N	contado
137	\N	4	\N	5	2025-10-01 12:29:33.053	386.64	1	completed	Lobo	[pagado_bruto=448.50]	2025-10-01 12:29:33.053	0.00	448.50	\N	\N	\N	contado
138	\N	4	\N	5	2025-10-01 12:32:24.71	504.31	1	completed	Lobo	[pagado_bruto=585.00]	2025-10-01 12:32:24.71	0.00	585.00	\N	\N	\N	contado
139	\N	4	\N	5	2025-10-01 12:32:29.587	336.21	1	completed	Lobo	[pagado_bruto=390.00]	2025-10-01 12:32:29.587	0.00	390.00	\N	\N	\N	contado
140	\N	4	\N	5	2025-10-01 12:32:35.003	336.21	1	completed	Lobo	[pagado_bruto=390.00]	2025-10-01 12:32:35.003	0.00	390.00	\N	\N	\N	contado
141	\N	4	\N	5	2025-10-01 12:32:39.972	168.10	1	completed	Lobo	[pagado_bruto=195.00]	2025-10-01 12:32:39.972	0.00	195.00	\N	\N	\N	contado
142	\N	4	\N	5	2025-10-01 12:35:11.217	336.21	1	completed	Lobo	[pagado_bruto=390.00]	2025-10-01 12:35:11.217	0.00	390.00	\N	\N	\N	contado
143	\N	4	\N	5	2025-10-01 12:35:17.432	336.21	1	completed	Lobo	[pagado_bruto=390.00]	2025-10-01 12:35:17.432	0.00	390.00	\N	\N	\N	contado
144	\N	4	\N	5	2025-10-01 12:35:23.026	336.21	1	completed	Lobo	[pagado_bruto=390.00]	2025-10-01 12:35:23.026	0.00	390.00	\N	\N	\N	contado
145	\N	4	\N	5	2025-10-01 12:55:42.606	336.21	1	completed	Lobo	[pagado_bruto=390.00]	2025-10-01 12:55:42.606	0.00	390.00	\N	\N	\N	contado
146	\N	4	\N	5	2025-10-01 12:55:50.022	336.21	1	completed	Lobo	[pagado_bruto=390.00]	2025-10-01 12:55:50.022	0.00	390.00	\N	\N	\N	contado
147	\N	4	\N	5	2025-10-01 12:55:55.96	336.21	1	completed	Lobo	[pagado_bruto=390.00]	2025-10-01 12:55:55.96	0.00	390.00	\N	\N	\N	contado
148	\N	4	\N	5	2025-10-01 13:41:32.412	336.21	1	completed	Lobo	[pagado_bruto=390.00]	2025-10-01 13:41:32.412	0.00	390.00	\N	\N	\N	contado
149	\N	4	\N	5	2025-10-01 13:41:38.306	336.21	1	completed	Lobo	[pagado_bruto=390.00]	2025-10-01 13:41:38.306	0.00	390.00	\N	\N	\N	contado
150	\N	4	\N	5	2025-10-01 13:41:43.016	336.21	1	completed	Lobo	[pagado_bruto=390.00]	2025-10-01 13:41:43.016	0.00	390.00	\N	\N	\N	contado
151	\N	4	\N	5	2025-10-01 13:50:44.498	336.21	1	completed	Lobo	[pagado_bruto=390.00]	2025-10-01 13:50:44.498	0.00	390.00	\N	\N	\N	contado
152	\N	4	\N	5	2025-10-01 13:50:48.255	336.21	1	completed	Lobo	[pagado_bruto=390.00]	2025-10-01 13:50:48.255	0.00	390.00	\N	\N	\N	contado
153	\N	4	\N	5	2025-10-01 13:50:51.893	336.21	1	completed	Lobo	[pagado_bruto=390.00]	2025-10-01 13:50:51.893	0.00	390.00	\N	\N	\N	contado
154	\N	4	\N	5	2025-10-01 13:51:36.748	336.21	1	completed	Lobo	[pagado_bruto=390.00]	2025-10-01 13:51:36.748	0.00	390.00	\N	\N	\N	contado
155	\N	4	\N	5	2025-10-01 13:51:40.822	336.21	1	completed	Lobo	[pagado_bruto=390.00]	2025-10-01 13:51:40.822	0.00	390.00	\N	\N	\N	contado
156	\N	4	\N	5	2025-10-01 13:51:44.005	336.21	1	completed	Lobo	[pagado_bruto=390.00]	2025-10-01 13:51:44.005	0.00	390.00	\N	\N	\N	contado
157	\N	4	\N	5	2025-10-01 16:24:35.428	353.02	1	completed	Lobo	[pagado_bruto=409.50]	2025-10-01 16:24:35.428	0.00	409.50	\N	\N	\N	contado
158	\N	4	\N	5	2025-10-01 16:24:41.177	201.72	1	completed	Lobo	[pagado_bruto=234.00]	2025-10-01 16:24:41.177	0.00	234.00	\N	\N	\N	contado
159	\N	4	\N	5	2025-10-01 16:24:46.792	386.64	1	completed	Lobo	[pagado_bruto=448.50]	2025-10-01 16:24:46.792	0.00	448.50	\N	\N	\N	contado
160	\N	4	\N	5	2025-10-03 10:59:28.425	336.21	1	completed	Leon	[pagado_bruto=390.00]	2025-10-03 10:59:28.425	0.00	390.00	\N	\N	\N	contado
161	\N	4	\N	5	2025-10-03 10:59:33.381	336.21	1	completed	Leon	[pagado_bruto=390.00]	2025-10-03 10:59:33.381	0.00	390.00	\N	\N	\N	contado
162	\N	4	\N	5	2025-10-03 10:59:36.996	336.21	1	completed	Leon	[pagado_bruto=390.00]	2025-10-03 10:59:36.996	0.00	390.00	\N	\N	\N	contado
163	\N	4	\N	5	2025-10-03 10:59:59.793	336.21	1	completed	Leon	[pagado_bruto=390.00]	2025-10-03 10:59:59.793	0.00	390.00	\N	\N	\N	contado
164	\N	4	\N	5	2025-10-03 11:00:06.653	336.21	1	completed	Leon	[pagado_bruto=390.00]	2025-10-03 11:00:06.653	0.00	390.00	\N	\N	\N	contado
165	\N	4	\N	5	2025-10-03 11:00:12.146	336.21	1	completed	Leon	[pagado_bruto=390.00]	2025-10-03 11:00:12.146	0.00	390.00	\N	\N	\N	contado
166	\N	4	\N	5	2025-10-03 11:01:09.132	336.21	1	completed	Leon	[pagado_bruto=390.00]	2025-10-03 11:01:09.132	0.00	390.00	\N	\N	\N	contado
167	\N	4	\N	5	2025-10-03 11:01:12.751	336.21	1	completed	Leon	[pagado_bruto=390.00]	2025-10-03 11:01:12.751	0.00	390.00	\N	\N	\N	contado
168	\N	4	\N	5	2025-10-03 11:01:16.172	336.21	1	completed	Leon	[pagado_bruto=390.00]	2025-10-03 11:01:16.172	0.00	390.00	\N	\N	\N	contado
169	\N	4	\N	5	2025-10-03 11:01:20.472	336.21	1	completed	Leon	[pagado_bruto=390.00]	2025-10-03 11:01:20.472	0.00	390.00	\N	\N	\N	contado
170	\N	4	\N	5	2025-10-03 11:07:47.331	336.21	1	completed	Leon	[pagado_bruto=390.00]	2025-10-03 11:07:47.331	0.00	390.00	\N	\N	\N	contado
171	\N	4	\N	5	2025-10-03 11:07:56.3	336.21	1	completed	Leon	[pagado_bruto=390.00]	2025-10-03 11:07:56.3	0.00	390.00	\N	\N	\N	contado
172	\N	4	\N	5	2025-10-03 11:08:01.219	336.21	1	completed	Leon	[pagado_bruto=390.00]	2025-10-03 11:08:01.219	0.00	390.00	\N	\N	\N	contado
173	\N	4	\N	5	2025-10-03 11:08:04.888	336.21	1	completed	Leon	[pagado_bruto=390.00]	2025-10-03 11:08:04.888	0.00	390.00	\N	\N	\N	contado
174	\N	4	\N	5	2025-10-03 11:57:15.059	336.03	1	completed	Leon	[pagado_bruto=389.80]	2025-10-03 11:57:15.059	0.00	389.80	\N	\N	\N	contado
175	\N	4	\N	5	2025-10-03 11:57:21.42	336.21	1	completed	Leon	[pagado_bruto=390.00]	2025-10-03 11:57:21.42	0.00	390.00	\N	\N	\N	contado
176	\N	4	\N	5	2025-10-03 11:57:25.543	336.21	1	completed	Leon	[pagado_bruto=390.00]	2025-10-03 11:57:25.543	0.00	390.00	\N	\N	\N	contado
177	\N	4	\N	5	2025-10-03 12:06:05.962	336.21	1	completed	Lobo	[pagado_bruto=390.00]	2025-10-03 12:06:05.962	0.00	390.00	\N	\N	\N	contado
178	\N	4	\N	5	2025-10-03 12:06:13.207	336.21	1	completed	Lobo	[pagado_bruto=390.00]	2025-10-03 12:06:13.207	0.00	390.00	\N	\N	\N	contado
179	\N	4	\N	5	2025-10-03 12:13:26.722	336.21	1	completed	Lobo	[pagado_bruto=390.00]	2025-10-03 12:13:26.722	0.00	390.00	\N	\N	\N	contado
180	\N	4	\N	5	2025-10-03 12:13:31.723	336.21	1	completed	Lobo	[pagado_bruto=390.00]	2025-10-03 12:13:31.723	0.00	390.00	\N	\N	\N	contado
181	\N	4	\N	5	2025-10-03 12:13:39.605	336.21	1	completed	Lobo	[pagado_bruto=390.00]	2025-10-03 12:13:39.605	0.00	390.00	\N	\N	\N	contado
182	\N	4	\N	5	2025-10-03 12:17:32.919	17.24	1	completed	Lobo	[pagado_bruto=20.00]	2025-10-03 12:17:32.919	0.00	20.00	\N	\N	\N	contado
183	\N	4	\N	5	2025-10-03 12:17:43.343	336.21	1	completed	Lobo	[pagado_bruto=390.00]	2025-10-03 12:17:43.343	0.00	390.00	\N	\N	\N	contado
184	\N	4	\N	5	2025-10-03 12:17:49.132	336.21	1	completed	Lobo	[pagado_bruto=390.00]	2025-10-03 12:17:49.132	0.00	390.00	\N	\N	\N	contado
185	\N	4	\N	1	2025-10-03 12:17:52.911	336.21	1	completed	Lobo	[pagado_bruto=390.00]	2025-10-03 12:17:52.911	0.00	390.00	\N	\N	\N	contado
186	\N	4	\N	1	2025-10-03 12:17:57.087	336.21	1	completed	Lobo	[pagado_bruto=390.00]	2025-10-03 12:17:57.087	0.00	390.00	\N	\N	\N	contado
187	\N	4	\N	1	2025-10-03 12:18:01.851	336.21	1	completed	Lobo	[pagado_bruto=390.00]	2025-10-03 12:18:01.851	0.00	390.00	\N	\N	\N	contado
188	\N	4	\N	5	2025-10-03 12:42:38.307	336.21	1	completed	Lobo	[pagado_bruto=390.00]	2025-10-03 12:42:38.307	0.00	390.00	\N	\N	\N	contado
189	\N	4	\N	5	2025-10-03 12:42:41.939	336.21	1	completed	Lobo	[pagado_bruto=390.00]	2025-10-03 12:42:41.939	0.00	390.00	\N	\N	\N	contado
190	\N	4	\N	5	2025-10-03 12:42:46.998	336.21	1	completed	Lobo	[pagado_bruto=390.00]	2025-10-03 12:42:46.998	0.00	390.00	\N	\N	\N	contado
191	\N	4	\N	1	2025-10-03 12:42:50.738	336.21	1	completed	Lobo	[pagado_bruto=390.00]	2025-10-03 12:42:50.738	0.00	390.00	\N	\N	\N	contado
192	\N	4	\N	1	2025-10-03 12:42:53.959	336.21	1	completed	Lobo	[pagado_bruto=390.00]	2025-10-03 12:42:53.959	0.00	390.00	\N	\N	\N	contado
193	\N	4	\N	1	2025-10-03 12:42:57.729	336.21	1	completed	Lobo	[pagado_bruto=390.00]	2025-10-03 12:42:57.729	0.00	390.00	\N	\N	\N	contado
194	1	12	\N	1	2025-10-14 12:34:15.543	1830.17	4	completed	Lobo	[pagado_bruto=2123.00] [driver_name=cristian] [driver_dni=14785236] [driver_plate=GJR6JHGI]	2025-10-14 12:34:15.543	0.00	2123.00	\N	\N	\N	contado
195	4	3	\N	3	2025-10-15 15:31:05.355	10.34	4	completed	Lobo	[pagado_bruto=12.00]	2025-10-15 15:31:05.355	0.00	12.00	\N	\N	\N	contado
196	1	12	\N	5	2025-10-16 10:41:14.438	106.03	4	completed	Leon	[pagado_bruto=123.00] [driver_name=cristian] [driver_dni=14785236] [driver_plate=GJR6JHGI]	2025-10-16 10:41:14.438	0.00	123.00	\N	\N	\N	contado
197	\N	12	\N	5	2025-10-16 10:41:58.739	106.03	1	completed	Leon	[pagado_bruto=123.00]	2025-10-16 10:41:58.739	0.00	123.00	\N	\N	\N	contado
198	1	12	\N	1	2025-10-16 14:31:03.223	106.03	4	completed	Lobo	[pagado_bruto=123.00] [driver_name=cristian] [driver_dni=14785236] [driver_plate=GJR6JHGI]	2025-10-16 14:31:03.223	0.00	123.00	\N	\N	\N	contado
199	\N	12	\N	5	2025-10-16 14:56:58.308	10.34	1	completed	Lobo	[pagado_bruto=12.00]	2025-10-16 14:56:58.308	0.00	12.00	\N	\N	\N	contado
200	1	12	\N	1	2025-10-16 14:57:09.796	106.03	4	completed	Lobo	[pagado_bruto=123.00] [driver_name=cristian] [driver_dni=14785236] [driver_plate=GJR6JHGI]	2025-10-16 14:57:09.796	0.00	123.00	\N	\N	\N	contado
201	1	12	\N	1	2025-10-16 14:58:16.881	106.03	4	completed	Lobo	[pagado_bruto=123.00] [driver_name=Juan Pérez] [driver_dni=12345678] [driver_plate=ABC-123]	2025-10-16 14:58:16.881	0.00	123.00	\N	\N	\N	contado
202	1	12	\N	1	2025-10-16 14:59:31.652	106.03	4	completed	Lobo	[pagado_bruto=123.00] [driver_name=cristian] [driver_dni=14785236] [driver_plate=GJR6JHGI]	2025-10-16 14:59:31.652	0.00	123.00	\N	3	\N	contado
204	1	12	\N	1	2025-10-17 15:56:38.483	218.97	4	completed	Lobo	[pagado_bruto=254.00] [driver_name=cristian] [driver_dni=14785236] [driver_plate=GJR6JHGI]	2025-10-17 15:56:38.483	0.00	254.00	\N	\N	\N	contado
205	1	12	\N	1	2025-10-17 15:59:29.994	19.83	4	completed	Lobo	[pagado_bruto=23.00] [driver_name=cristian] [driver_dni=14785236] [driver_plate=GJR6JHGI]	2025-10-17 15:59:29.994	0.00	23.00	\N	\N	\N	contado
206	1	12	\N	1	2025-10-17 16:00:40.429	19.83	4	completed	Lobo	[pagado_bruto=23.00] [driver_name=cristian] [driver_dni=14785236] [driver_plate=GJR6JHGI]	2025-10-17 16:00:40.429	0.00	23.00	\N	\N	\N	contado
209	1	12	\N	1	2025-10-17 16:13:48.326	22.41	4	completed	Lobo	[pagado_bruto=26.00] [driver_name=cristian] [driver_dni=14785236] [driver_plate=GJR6JHGI]	2025-10-17 16:13:48.326	0.00	26.00	\N	\N	\N	contado
210	1	12	\N	1	2025-10-17 16:48:37.461	23.28	4	completed	Lobo	[pagado_bruto=27.00] [driver_name=cristian] [driver_dni=14785236] [driver_plate=GJR6JHGI]	2025-10-17 16:48:37.461	0.00	27.00	\N	\N	\N	contado
211	1	12	\N	1	2025-10-20 11:35:23.348	10.34	4	completed	Leon	[pagado_bruto=12.00] [driver_name=cristian] [driver_dni=14785236] [driver_plate=GJR6JHGI]	2025-10-20 11:35:23.348	0.00	12.00	\N	\N	\N	contado
234	2	12	\N	1	2025-11-10 13:22:18.36	0.86	1	completed	Lobo	[pagado_bruto=1.00]	2025-11-10 13:22:18.36	0.00	1.00	\N	\N	\N	contado
235	1	12	\N	1	2025-11-10 13:22:43.761	0.86	1	completed	Lobo	[pagado_bruto=1.00]	2025-11-10 13:22:43.761	0.00	1.00	\N	\N	\N	contado
236	1	12	\N	1	2025-11-10 13:24:52.261	0.86	4	completed	Lobo	[pagado_bruto=1.00] [driver_name=cristian] [driver_dni=14785236] [driver_plate=GJR6JHGI]	2025-11-10 13:24:52.261	0.00	1.00	\N	\N	\N	contado
237	1	12	\N	1	2025-11-10 13:25:07.415	0.86	2	completed	Lobo	[pagado_bruto=1.00] [driver_name=cristian] [driver_dni=14785236] [driver_plate=GJR6JHGI]	2025-11-10 13:25:07.415	0.00	1.00	\N	\N	\N	contado
263	3	12	\N	1	2025-11-10 16:22:48.246	494.40	1	completed	Lobo	[pagado_bruto=573.50]	2025-11-10 16:22:48.246	31.00	573.50	\N	\N	\N	contado
264	\N	12	\N	1	2025-11-10 16:23:19.822	494.40	1	completed	Lobo	[pagado_bruto=573.50]	2025-11-10 16:23:19.822	31.00	573.50	\N	\N	\N	contado
265	\N	12	\N	1	2025-11-10 16:24:50.942	521.12	1	completed	Lobo	[pagado_bruto=604.50]	2025-11-10 16:24:50.942	0.00	604.50	\N	\N	\N	contado
266	\N	12	\N	1	2025-11-10 16:27:06.237	521.12	1	completed	Lobo	[pagado_bruto=604.50]	2025-11-10 16:27:06.237	0.00	604.50	\N	\N	\N	contado
267	\N	12	\N	1	2025-11-10 16:27:51.834	521.12	1	completed	Lobo	[pagado_bruto=604.50]	2025-11-10 16:27:51.834	0.00	604.50	\N	\N	\N	contado
268	\N	12	\N	1	2025-11-10 16:28:35.797	604.50	1	completed	Lobo	[pagado_bruto=604.50]	2025-11-10 16:28:35.797	0.00	604.50	\N	\N	\N	contado
\.


--
-- TOC entry 4515 (class 0 OID 18233)
-- Dependencies: 284
-- Data for Name: sector_drivers; Type: TABLE DATA; Schema: public; Owner: postgres
--

COPY public.sector_drivers (sector_id, driver_id, start_date, end_date) FROM stdin;
1	3	2025-10-17	\N
\.


--
-- TOC entry 4516 (class 0 OID 18237)
-- Dependencies: 285
-- Data for Name: sectors; Type: TABLE DATA; Schema: public; Owner: postgres
--

COPY public.sectors (sector_id, client_id, name, code, budget_limit, is_active, created_at, updated_at) FROM stdin;
1	1	Construcción	CONSTR	500000.00	t	2025-10-17 14:35:30.379526-05	2025-10-20 16:17:46.829432
4	5	General	\N	\N	t	2025-10-20 16:09:53.422613-05	2025-10-20 16:17:46.829432
5	6	General	\N	\N	t	2025-10-20 16:09:53.422613-05	2025-10-20 16:17:46.829432
6	7	General	\N	\N	t	2025-10-20 16:09:53.422613-05	2025-10-20 16:17:46.829432
7	8	General	\N	\N	t	2025-10-20 16:09:53.422613-05	2025-10-20 16:17:46.829432
8	13	General	\N	\N	t	2025-10-20 16:09:53.422613-05	2025-10-20 16:17:46.829432
10	999	Construcción	\N	\N	t	2025-10-20 16:17:52.602294-05	2025-10-20 16:17:52.602294
11	999	Educación	\N	\N	t	2025-10-20 16:17:52.602294-05	2025-10-20 16:17:52.602294
12	1000	Otro sector	\N	\N	t	2025-10-20 16:18:08.994763-05	2025-10-20 16:18:08.994763
16	16	Sector Construcción	\N	\N	t	2025-10-21 16:40:19.911935-05	2025-10-21 16:40:19.911935
17	16	Sector barrenderos	\N	\N	t	2025-10-21 16:40:48.329967-05	2025-10-21 16:40:48.329967
\.


--
-- TOC entry 4518 (class 0 OID 18246)
-- Dependencies: 287
-- Data for Name: settings; Type: TABLE DATA; Schema: public; Owner: postgres
--

COPY public.settings (setting_id, ruc, address, phone, company_name, email, web_address, social_networks, logo, currency, invoices, created_at, updated_at, shift_hours, payment_methods, backup_path) FROM stdin;
1	\N	\N	\N	\N	\N	\N	\N	\N	\N	\N	2025-09-11 16:58:15.728141	2025-09-23 15:04:35.364	{"Búho (Noche)": "20:00-04:00", "León (Tarde)": "12:00-20:00", "Lobo (Mañana)": "04:00-12:00"}	\N	\N
\.


--
-- TOC entry 4520 (class 0 OID 18253)
-- Dependencies: 289
-- Data for Name: shifts; Type: TABLE DATA; Schema: public; Owner: postgres
--

COPY public.shifts (id, start_time, end_time, opened_by, closed_by, initial_amount, final_amount, created_at) FROM stdin;
\.


--
-- TOC entry 4522 (class 0 OID 18258)
-- Dependencies: 291
-- Data for Name: stock_movements; Type: TABLE DATA; Schema: public; Owner: postgres
--

COPY public.stock_movements (stock_movement_id, product_id, tank_id, user_id, movement_timestamp, movement_type, quantity, sale_detail_id, delivery_detail_id, description) FROM stdin;
1	1	1	3	2025-09-16 16:37:31.778	Entrada	10000.000	\N	\N	Ingreso manual al tanque
2	2	2	3	2025-09-16 16:37:39.083	Entrada	10000.000	\N	\N	Ingreso manual al tanque
3	3	3	3	2025-09-16 16:37:46.249	Entrada	10000.000	\N	\N	Ingreso manual al tanque
4	4	4	3	2025-09-16 16:37:55.204	Entrada	10000.000	\N	\N	Ingreso manual al tanque
5	1	1	12	2025-09-17 11:56:51.468	Salida	6.308	1	\N	Venta #3 - Boquilla 1001
6	2	2	12	2025-09-19 11:48:46.219	Salida	1.198	11	\N	Venta #12 - Boquilla 1002
7	1	1	12	2025-09-19 14:29:31.788	Salida	1.538	12	\N	Venta #13 - Boquilla 1101
8	2	2	12	2025-09-19 14:29:38.04	Salida	1.198	13	\N	Venta #14 - Boquilla 1002
9	3	3	12	2025-09-19 14:29:43.189	Salida	2.174	14	\N	Venta #15 - Boquilla 1003
10	4	4	12	2025-09-19 14:29:48.545	Salida	10.000	15	\N	Venta #16 - Boquilla 1004
11	1	1	12	2025-09-22 14:42:17.904	Salida	1.000	16	\N	Venta #17 - Boquilla 1101
12	1	1	12	2025-09-22 16:42:54.908	Salida	6.308	17	\N	Venta #18 - Boquilla 1101
13	3	3	12	2025-09-22 16:43:03.551	Salida	6.685	18	\N	Venta #19 - Boquilla 1003
14	1	1	12	2025-09-22 16:53:10.372	Salida	1.000	19	\N	Venta #20 - Boquilla 1101
15	1	1	12	2025-09-23 13:19:52.359	Salida	6.000	20	\N	Venta #21 - Boquilla 1001
16	1	1	12	2025-09-23 13:26:12.409	Salida	0.051	21	\N	Venta #22 - Boquilla 1001
17	1	1	12	2025-09-23 13:26:56.745	Salida	10.000	22	\N	Venta #23 - Boquilla 1001
18	1	1	12	2025-09-23 14:06:20.956	Salida	6.000	23	\N	Venta #24 - Boquilla 1001
19	1	1	12	2025-09-23 14:07:09.684	Salida	6.000	24	\N	Venta #25 - Boquilla 1001
20	1	1	12	2025-09-23 15:02:15.421	Salida	6.000	25	\N	Venta #26 - Boquilla 1001
21	1	1	12	2025-09-23 15:06:40.901	Salida	30.000	26	\N	Venta #27 - Boquilla 1001
22	1	1	12	2025-09-23 15:16:12.08	Salida	2.000	27	\N	Venta #28 - Boquilla 1101
23	1	1	12	2025-09-24 12:43:22.054	Salida	1.538	28	\N	Venta #29 - Boquilla 1001
24	1	1	12	2025-09-24 14:20:13.983	Salida	1.538	29	\N	Venta #30 - Boquilla 1101
25	1	1	12	2025-09-24 14:20:19.783	Salida	4.615	30	\N	Venta #31 - Boquilla 1001
26	1	1	12	2025-09-25 14:08:15.496	Salida	1.538	31	\N	Venta #32 - Boquilla 1001
27	1	1	12	2025-09-25 14:08:21.368	Salida	4.615	32	\N	Venta #33 - Boquilla 1101
28	2	2	12	2025-09-25 14:08:28.408	Salida	39.521	33	\N	Venta #34 - Boquilla 1002
29	3	3	12	2025-09-25 14:08:34.14	Salida	11.957	34	\N	Venta #35 - Boquilla 1003
30	4	4	12	2025-09-25 14:08:41.367	Salida	10.588	35	\N	Venta #36 - Boquilla 1004
31	2	2	12	2025-09-26 10:17:33.881	Salida	0.898	36	\N	Venta #37 - Boquilla 1002
32	2	2	12	2025-09-26 10:17:46.632	Salida	0.060	37	\N	Venta #38 - Boquilla 1002
33	2	2	12	2025-09-26 10:18:37.528	Salida	14.000	38	\N	Venta #39 - Boquilla 1002
34	2	2	12	2025-09-26 10:18:52.928	Salida	1.000	39	\N	Venta #40 - Boquilla 1002
35	2	2	12	2025-09-26 10:19:04.886	Salida	1.000	40	\N	Venta #41 - Boquilla 1002
36	1	1	12	2025-09-26 13:50:58.523	Salida	4.615	42	\N	Venta #43 - Boquilla 1001
37	1	1	12	2025-09-26 13:51:03.657	Salida	10.769	43	\N	Venta #44 - Boquilla 1101
38	2	2	12	2025-09-26 13:51:09.213	Salida	23.952	44	\N	Venta #45 - Boquilla 1002
39	3	3	12	2025-09-26 13:51:18.874	Salida	16.304	45	\N	Venta #46 - Boquilla 1003
40	4	4	12	2025-09-26 13:51:24.554	Salida	94.118	46	\N	Venta #47 - Boquilla 1004
41	1	1	12	2025-09-26 14:02:07.29	Salida	1.179	47	\N	Venta #48 - Boquilla 1101
42	1	1	4	2025-09-26 14:08:30.598	Salida	6.308	48	\N	Venta #49 - Boquilla 1001
43	1	1	4	2025-09-26 14:08:37.248	Salida	2.308	49	\N	Venta #50 - Boquilla 1101
44	2	2	4	2025-09-26 14:08:43.541	Salida	12.754	50	\N	Venta #51 - Boquilla 1002
45	3	3	4	2025-09-26 14:08:48.839	Salida	29.511	51	\N	Venta #52 - Boquilla 1003
46	4	4	4	2025-09-26 14:08:53.181	Salida	14.471	52	\N	Venta #53 - Boquilla 1004
47	1	1	4	2025-09-26 14:09:36.784	Salida	6.308	53	\N	Venta #55 - Boquilla 1001
48	1	1	4	2025-09-26 15:53:18.536	Salida	15.385	54	\N	Venta #56 - Boquilla 1001
49	1	1	4	2025-09-26 16:16:04.939	Salida	30.769	55	\N	Venta #57 - Boquilla 1001
50	1	1	4	2025-09-26 16:16:11.33	Salida	30.769	56	\N	Venta #58 - Boquilla 1101
51	1	1	4	2025-09-26 16:25:36.428	Salida	46.154	57	\N	Venta #59 - Boquilla 1001
52	1	1	4	2025-09-26 16:47:32.334	Salida	10.000	58	\N	Venta #60 - Boquilla 1001
53	1	1	4	2025-09-29 11:33:23.551	Salida	4.615	59	\N	Venta #61 - Boquilla 1001
54	1	1	4	2025-09-29 11:33:31.225	Salida	46.154	60	\N	Venta #62 - Boquilla 1101
55	1	1	4	2025-09-29 11:34:33.395	Salida	900.000	61	\N	Venta #63 - Boquilla 1001
56	1	1	4	2025-09-29 12:09:53.895	Salida	15.385	62	\N	Venta #64 - Boquilla 1001
57	1	1	4	2025-09-29 12:09:59.199	Salida	10.256	63	\N	Venta #65 - Boquilla 1101
58	2	2	4	2025-09-29 12:10:03.683	Salida	7.305	64	\N	Venta #66 - Boquilla 1002
59	3	3	4	2025-09-29 12:10:10.937	Salida	6.630	65	\N	Venta #67 - Boquilla 1003
60	4	4	4	2025-09-29 12:10:16.33	Salida	37.882	66	\N	Venta #68 - Boquilla 1004
61	1	1	4	2025-09-29 12:11:33.369	Salida	11.385	67	\N	Venta #69 - Boquilla 1001
62	1	1	4	2025-09-29 12:11:38.776	Salida	2.256	68	\N	Venta #70 - Boquilla 1001
63	1	1	4	2025-09-29 12:12:44.997	Salida	15.385	69	\N	Venta #71 - Boquilla 1101
64	1	1	4	2025-09-29 12:12:59.649	Salida	46.154	70	\N	Venta #72 - Boquilla 1101
65	1	1	4	2025-09-29 12:16:06.398	Salida	46.154	71	\N	Venta #73 - Boquilla 1101
66	1	1	4	2025-09-29 12:16:12.798	Salida	46.256	72	\N	Venta #74 - Boquilla 1101
67	1	1	4	2025-09-29 13:32:43.267	Salida	1.026	73	\N	Venta #75 - Boquilla 1101
68	1	1	4	2025-09-29 13:32:47.882	Salida	20.513	74	\N	Venta #76 - Boquilla 1001
69	1	1	4	2025-09-29 13:32:53.349	Salida	1.538	75	\N	Venta #77 - Boquilla 1101
70	1	1	4	2025-09-29 13:32:58.063	Salida	3.590	76	\N	Venta #78 - Boquilla 1101
71	1	1	4	2025-09-29 14:46:32.217	Salida	0.615	77	\N	Venta #79 - Boquilla 1101
72	1	1	4	2025-09-29 14:46:37.378	Salida	1.641	78	\N	Venta #80 - Boquilla 1001
73	1	1	4	2025-09-29 14:46:42.348	Salida	27.846	79	\N	Venta #81 - Boquilla 1101
74	1	1	4	2025-09-29 15:10:47.026	Salida	15.385	80	\N	Venta #82 - Boquilla 1101
75	1	1	4	2025-09-29 15:10:53.271	Salida	38.154	81	\N	Venta #83 - Boquilla 1101
76	1	1	4	2025-09-29 15:11:00.024	Salida	0.615	82	\N	Venta #84 - Boquilla 1101
77	1	1	4	2025-09-29 15:11:05.23	Salida	4.000	83	\N	Venta #85 - Boquilla 1101
78	1	1	4	2025-09-29 15:11:11.646	Salida	3.179	84	\N	Venta #86 - Boquilla 1101
79	1	1	12	2025-09-29 15:23:07.937	Salida	63.333	85	\N	Venta #87 - Boquilla 1001
80	1	1	12	2025-09-29 15:23:52.129	Salida	6.410	86	\N	Venta #88 - Boquilla 1001
81	1	1	4	2025-09-29 16:16:46.796	Salida	5.077	87	\N	Venta #89 - Boquilla 1101
82	1	1	4	2025-09-29 16:17:20.244	Salida	0.615	88	\N	Venta #90 - Boquilla 1101
83	1	1	4	2025-09-29 16:17:25.432	Salida	2.308	89	\N	Venta #91 - Boquilla 1101
84	1	1	4	2025-09-29 16:17:30.551	Salida	2.564	90	\N	Venta #92 - Boquilla 1101
85	1	1	4	2025-09-29 16:17:34.972	Salida	13.128	91	\N	Venta #93 - Boquilla 1101
86	1	1	4	2025-09-29 16:28:06.049	Salida	2.667	92	\N	Venta #94 - Boquilla 1101
87	1	1	4	2025-09-29 16:28:10.815	Salida	38.564	93	\N	Venta #95 - Boquilla 1101
88	1	1	4	2025-09-29 16:28:14.566	Salida	12.667	94	\N	Venta #96 - Boquilla 1101
89	1	1	4	2025-09-30 11:44:22.057	Salida	0.615	95	\N	Venta #97 - Boquilla 1101
90	1	1	4	2025-09-30 11:44:26.999	Salida	0.615	96	\N	Venta #98 - Boquilla 1101
91	1	1	4	2025-09-30 11:44:34.189	Salida	30.000	97	\N	Venta #99 - Boquilla 1101
92	1	1	4	2025-09-30 11:45:08.925	Salida	80.000	98	\N	Venta #100 - Boquilla 1101
93	1	1	4	2025-09-30 12:28:40.692	Salida	1.179	99	\N	Venta #101 - Boquilla 1101
94	1	1	4	2025-09-30 12:28:44.202	Salida	0.615	100	\N	Venta #102 - Boquilla 1101
95	1	1	4	2025-09-30 12:49:11.185	Salida	1.179	101	\N	Venta #103 - Boquilla 1101
96	1	1	4	2025-09-30 12:49:18.961	Salida	2.872	102	\N	Venta #104 - Boquilla 1101
97	1	1	4	2025-09-30 12:49:27.576	Salida	20.000	103	\N	Venta #105 - Boquilla 1101
98	1	1	4	2025-09-30 13:07:56.133	Salida	12.000	104	\N	Venta #106 - Boquilla 1101
99	1	1	4	2025-09-30 13:07:59.75	Salida	14.000	105	\N	Venta #107 - Boquilla 1101
100	1	1	4	2025-09-30 13:59:11.53	Salida	2.308	106	\N	Venta #108 - Boquilla 1101
101	1	1	4	2025-09-30 13:59:15.605	Salida	0.718	107	\N	Venta #109 - Boquilla 1101
102	1	1	4	2025-09-30 13:59:23.582	Salida	4.000	108	\N	Venta #110 - Boquilla 1101
103	1	1	12	2025-09-30 14:00:14.393	Salida	6.308	109	\N	Venta #111 - Boquilla 1001
104	1	1	4	2025-09-30 14:11:52.791	Salida	78.000	110	\N	Venta #112 - Boquilla 1101
105	1	1	4	2025-09-30 14:11:58.353	Salida	47.000	111	\N	Venta #113 - Boquilla 1101
106	1	1	4	2025-09-30 14:17:24.364	Salida	1.538	112	\N	Venta #114 - Boquilla 1101
107	1	1	4	2025-09-30 14:17:28.326	Salida	0.615	113	\N	Venta #115 - Boquilla 1101
108	1	1	4	2025-09-30 14:17:32.933	Salida	2.103	114	\N	Venta #116 - Boquilla 1101
109	1	1	4	2025-09-30 14:18:55.945	Salida	45.000	115	\N	Venta #117 - Boquilla 1101
110	1	1	4	2025-09-30 14:19:01.41	Salida	14.000	116	\N	Venta #118 - Boquilla 1101
111	1	1	4	2025-09-30 14:19:07.649	Salida	10.000	117	\N	Venta #119 - Boquilla 1101
112	1	1	4	2025-09-30 14:27:29.772	Salida	20.000	118	\N	Venta #120 - Boquilla 1101
113	1	1	4	2025-09-30 14:27:34.079	Salida	10.000	119	\N	Venta #121 - Boquilla 1101
114	1	1	4	2025-09-30 14:27:38.156	Salida	30.000	120	\N	Venta #122 - Boquilla 1101
115	1	1	4	2025-09-30 14:32:44.656	Salida	10.000	121	\N	Venta #123 - Boquilla 1101
116	1	1	4	2025-09-30 14:32:49.036	Salida	10.000	122	\N	Venta #124 - Boquilla 1101
117	1	1	4	2025-09-30 14:32:54.195	Salida	10.000	123	\N	Venta #125 - Boquilla 1101
118	1	1	4	2025-09-30 14:32:58.446	Salida	20.000	124	\N	Venta #126 - Boquilla 1101
119	1	1	4	2025-09-30 14:39:20.568	Salida	20.000	125	\N	Venta #127 - Boquilla 1101
120	1	1	4	2025-09-30 14:39:29.348	Salida	10.000	126	\N	Venta #128 - Boquilla 1101
121	1	1	4	2025-09-30 14:39:34.059	Salida	10.000	127	\N	Venta #129 - Boquilla 1101
122	1	1	4	2025-09-30 15:31:28.698	Salida	20.000	128	\N	Venta #130 - Boquilla 1101
123	1	1	4	2025-09-30 15:31:32.63	Salida	10.000	129	\N	Venta #131 - Boquilla 1101
124	1	1	4	2025-09-30 15:46:22.533	Salida	19.980	130	\N	Venta #132 - Boquilla 1101
125	1	1	4	2025-09-30 15:46:26.473	Salida	10.000	131	\N	Venta #133 - Boquilla 1101
126	1	1	4	2025-09-30 15:46:30.469	Salida	30.000	132	\N	Venta #134 - Boquilla 1101
127	1	1	4	2025-10-01 12:29:20.662	Salida	0.615	133	\N	Venta #135 - Boquilla 1101
128	1	1	4	2025-10-01 12:29:28.247	Salida	78.000	134	\N	Venta #136 - Boquilla 1101
129	1	1	4	2025-10-01 12:29:33.053	Salida	23.000	135	\N	Venta #137 - Boquilla 1101
130	1	1	4	2025-10-01 12:32:24.71	Salida	30.000	136	\N	Venta #138 - Boquilla 1101
131	1	1	4	2025-10-01 12:32:29.587	Salida	20.000	137	\N	Venta #139 - Boquilla 1101
132	1	1	4	2025-10-01 12:32:35.003	Salida	20.000	138	\N	Venta #140 - Boquilla 1101
133	1	1	4	2025-10-01 12:32:39.972	Salida	10.000	139	\N	Venta #141 - Boquilla 1101
134	1	1	4	2025-10-01 12:35:11.217	Salida	20.000	140	\N	Venta #142 - Boquilla 1101
135	1	1	4	2025-10-01 12:35:17.432	Salida	20.000	141	\N	Venta #143 - Boquilla 1101
136	1	1	4	2025-10-01 12:35:23.026	Salida	20.000	142	\N	Venta #144 - Boquilla 1101
137	1	1	4	2025-10-01 12:55:42.606	Salida	20.000	143	\N	Venta #145 - Boquilla 1101
138	1	1	4	2025-10-01 12:55:50.022	Salida	20.000	144	\N	Venta #146 - Boquilla 1101
139	1	1	4	2025-10-01 12:55:55.96	Salida	20.000	145	\N	Venta #147 - Boquilla 1101
140	1	1	4	2025-10-01 13:41:32.412	Salida	20.000	146	\N	Venta #148 - Boquilla 1101
141	1	1	4	2025-10-01 13:41:38.306	Salida	20.000	147	\N	Venta #149 - Boquilla 1101
142	1	1	4	2025-10-01 13:41:43.016	Salida	20.000	148	\N	Venta #150 - Boquilla 1101
143	1	1	4	2025-10-01 13:50:44.498	Salida	20.000	149	\N	Venta #151 - Boquilla 1101
144	1	1	4	2025-10-01 13:50:48.255	Salida	20.000	150	\N	Venta #152 - Boquilla 1101
145	1	1	4	2025-10-01 13:50:51.893	Salida	20.000	151	\N	Venta #153 - Boquilla 1101
146	1	1	4	2025-10-01 13:51:36.748	Salida	20.000	152	\N	Venta #154 - Boquilla 1101
147	1	1	4	2025-10-01 13:51:40.822	Salida	20.000	153	\N	Venta #155 - Boquilla 1101
148	1	1	4	2025-10-01 13:51:44.005	Salida	20.000	154	\N	Venta #156 - Boquilla 1101
149	1	1	4	2025-10-01 16:24:35.428	Salida	21.000	155	\N	Venta #157 - Boquilla 1101
150	1	1	4	2025-10-01 16:24:41.177	Salida	12.000	156	\N	Venta #158 - Boquilla 1101
151	1	1	4	2025-10-01 16:24:46.792	Salida	23.000	157	\N	Venta #159 - Boquilla 1101
152	1	1	4	2025-10-03 10:59:28.425	Salida	20.000	158	\N	Venta #160 - Boquilla 1101
153	1	1	4	2025-10-03 10:59:33.381	Salida	20.000	159	\N	Venta #161 - Boquilla 1101
154	1	1	4	2025-10-03 10:59:36.996	Salida	20.000	160	\N	Venta #162 - Boquilla 1101
155	1	1	4	2025-10-03 10:59:59.793	Salida	20.000	161	\N	Venta #163 - Boquilla 1101
156	1	1	4	2025-10-03 11:00:06.653	Salida	20.000	162	\N	Venta #164 - Boquilla 1101
157	1	1	4	2025-10-03 11:00:12.146	Salida	20.000	163	\N	Venta #165 - Boquilla 1101
158	1	1	4	2025-10-03 11:01:09.132	Salida	20.000	164	\N	Venta #166 - Boquilla 1101
159	1	1	4	2025-10-03 11:01:12.751	Salida	20.000	165	\N	Venta #167 - Boquilla 1101
160	1	1	4	2025-10-03 11:01:16.172	Salida	20.000	166	\N	Venta #168 - Boquilla 1101
161	1	1	4	2025-10-03 11:01:20.472	Salida	20.000	167	\N	Venta #169 - Boquilla 1101
162	1	1	4	2025-10-03 11:07:47.331	Salida	20.000	168	\N	Venta #170 - Boquilla 1101
163	1	1	4	2025-10-03 11:07:56.3	Salida	20.000	169	\N	Venta #171 - Boquilla 1101
164	1	1	4	2025-10-03 11:08:01.219	Salida	20.000	170	\N	Venta #172 - Boquilla 1101
165	1	1	4	2025-10-03 11:08:04.888	Salida	20.000	171	\N	Venta #173 - Boquilla 1101
166	1	1	4	2025-10-03 11:57:15.059	Salida	19.990	172	\N	Venta #174 - Boquilla 1101
167	1	1	4	2025-10-03 11:57:21.42	Salida	20.000	173	\N	Venta #175 - Boquilla 1101
168	1	1	4	2025-10-03 11:57:25.543	Salida	20.000	174	\N	Venta #176 - Boquilla 1101
169	1	1	4	2025-10-03 12:06:05.962	Salida	20.000	175	\N	Venta #177 - Boquilla 1101
170	1	1	4	2025-10-03 12:06:13.207	Salida	20.000	176	\N	Venta #178 - Boquilla 1101
171	1	1	4	2025-10-03 12:13:26.722	Salida	20.000	177	\N	Venta #179 - Boquilla 1101
172	1	1	4	2025-10-03 12:13:31.723	Salida	20.000	178	\N	Venta #180 - Boquilla 1101
173	1	1	4	2025-10-03 12:13:39.605	Salida	20.000	179	\N	Venta #181 - Boquilla 1101
174	1	1	4	2025-10-03 12:17:32.919	Salida	1.026	180	\N	Venta #182 - Boquilla 1101
175	1	1	4	2025-10-03 12:17:43.343	Salida	20.000	181	\N	Venta #183 - Boquilla 1101
176	1	1	4	2025-10-03 12:17:49.132	Salida	20.000	182	\N	Venta #184 - Boquilla 1101
177	1	1	4	2025-10-03 12:17:52.911	Salida	20.000	183	\N	Venta #185 - Boquilla 1001
178	1	1	4	2025-10-03 12:17:57.087	Salida	20.000	184	\N	Venta #186 - Boquilla 1001
179	1	1	4	2025-10-03 12:18:01.851	Salida	20.000	185	\N	Venta #187 - Boquilla 1001
180	1	1	4	2025-10-03 12:42:38.307	Salida	20.000	186	\N	Venta #188 - Boquilla 1101
181	1	1	4	2025-10-03 12:42:41.939	Salida	20.000	187	\N	Venta #189 - Boquilla 1101
182	1	1	4	2025-10-03 12:42:46.998	Salida	20.000	188	\N	Venta #190 - Boquilla 1101
183	1	1	4	2025-10-03 12:42:50.738	Salida	20.000	189	\N	Venta #191 - Boquilla 1001
184	1	1	4	2025-10-03 12:42:53.959	Salida	20.000	190	\N	Venta #192 - Boquilla 1001
185	1	1	4	2025-10-03 12:42:57.729	Salida	20.000	191	\N	Venta #193 - Boquilla 1001
186	1	1	12	2025-10-14 12:34:15.543	Salida	108.872	192	\N	Venta #194 - Boquilla 1001
187	3	3	3	2025-10-15 15:31:05.355	Salida	0.652	193	\N	Venta #195 - Boquilla 1003
188	1	1	12	2025-10-16 10:41:14.438	Salida	6.308	194	\N	Venta #196 - Boquilla 1101
189	1	1	12	2025-10-16 10:41:58.739	Salida	6.308	195	\N	Venta #197 - Boquilla 1101
190	1	1	12	2025-10-16 14:31:03.223	Salida	6.308	196	\N	Venta #198 - Boquilla 1001
191	1	1	12	2025-10-16 14:56:58.308	Salida	0.615	197	\N	Venta #199 - Boquilla 1101
192	1	1	12	2025-10-16 14:57:09.796	Salida	6.308	198	\N	Venta #200 - Boquilla 1001
193	1	1	12	2025-10-16 14:58:16.881	Salida	6.308	199	\N	Venta #201 - Boquilla 1001
194	1	1	12	2025-10-16 14:59:31.652	Salida	6.308	200	\N	Venta #202 - Boquilla 1001
195	1	1	12	2025-10-17 15:56:38.483	Salida	13.026	201	\N	Venta #204 - Boquilla 1001
196	1	1	12	2025-10-17 15:59:29.994	Salida	1.179	202	\N	Venta #205 - Boquilla 1001
197	1	1	12	2025-10-17 16:00:40.429	Salida	1.179	203	\N	Venta #206 - Boquilla 1001
198	1	1	12	2025-10-17 16:13:48.326	Salida	1.333	204	\N	Venta #209 - Boquilla 1001
199	1	1	12	2025-10-17 16:48:37.461	Salida	1.385	205	\N	Venta #210 - Boquilla 1001
200	1	1	12	2025-10-20 11:35:23.348	Salida	0.615	206	\N	Venta #211 - Boquilla 1001
201	1	1	12	2025-11-10 13:22:18.36	Salida	0.051	211	\N	Venta #234 - Boquilla 1001
202	1	1	12	2025-11-10 13:22:43.761	Salida	0.051	212	\N	Venta #235 - Boquilla 1001
203	1	1	12	2025-11-10 13:24:52.261	Salida	0.051	213	\N	Venta #236 - Boquilla 1001
204	1	1	12	2025-11-10 13:25:07.415	Salida	0.051	214	\N	Venta #237 - Boquilla 1001
205	1	1	12	2025-11-10 16:22:48.246	Salida	31.000	215	\N	Venta #263 - Boquilla 1001
206	1	1	12	2025-11-10 16:23:19.822	Salida	31.000	216	\N	Venta #264 - Boquilla 1001
207	1	1	12	2025-11-10 16:24:50.942	Salida	31.000	217	\N	Venta #265 - Boquilla 1001
208	1	1	12	2025-11-10 16:27:06.237	Salida	31.000	218	\N	Venta #266 - Boquilla 1001
209	1	1	12	2025-11-10 16:27:51.834	Salida	31.000	219	\N	Venta #267 - Boquilla 1001
210	1	1	12	2025-11-10 16:28:35.797	Salida	31.000	220	\N	Venta #268 - Boquilla 1001
\.


--
-- TOC entry 4524 (class 0 OID 18265)
-- Dependencies: 293
-- Data for Name: suppliers; Type: TABLE DATA; Schema: public; Owner: postgres
--

COPY public.suppliers (supplier_id, supplier_name, ruc, address, phone, email, contact_person, created_at, updated_at) FROM stdin;
\.


--
-- TOC entry 4526 (class 0 OID 18272)
-- Dependencies: 295
-- Data for Name: tanks; Type: TABLE DATA; Schema: public; Owner: postgres
--

COPY public.tanks (tank_id, tank_name, product_id, total_capacity, location, description, created_at, updated_at, current_stock) FROM stdin;
5	Tanque 05	5	5000.000			2025-09-19 15:22:39.00781	\N	0.000
3	Tanque 03	3	10000.000			2025-09-16 16:35:22.875019	\N	9926.087
2	Tanque 02	2	10000.000			2025-09-16 16:35:10.209741	\N	9897.114
4	Tanque 04	4	10000.000			2025-09-16 16:35:36.466886	\N	9832.941
1	Tanque 01	1	10000.000			2025-09-16 16:34:56.439606	\N	6164.420
\.


--
-- TOC entry 4528 (class 0 OID 18280)
-- Dependencies: 297
-- Data for Name: user_audit_logs; Type: TABLE DATA; Schema: public; Owner: postgres
--

COPY public.user_audit_logs (audit_id, action, performed_by, target_user, "timestamp", details, previous_data) FROM stdin;
\.


--
-- TOC entry 4530 (class 0 OID 18288)
-- Dependencies: 299
-- Data for Name: users; Type: TABLE DATA; Schema: public; Owner: postgres
--

COPY public.users (user_id, employee_id, username, password_hash, role, permissions, is_active, created_at, updated_at, full_name, token_version) FROM stdin;
12	\N	nuevo_usuario	$2b$10$MN86PThT8QpT5vAfMYBsGuuxyiddofO5qfFUs0vAznSTQAkXTT3My	superadmin	["ALL"]	t	2025-09-16 16:19:38.423556	2025-09-16 16:19:38.423556	Administrador General	0
4	\N	Jesus Gonzalo	$2b$10$MN86PThT8QpT5vAfMYBsGuuxyiddofO5qfFUs0vAznSTQAkXTT3My	superadmin	"{\\"full_access\\":true}"	t	2025-09-17 16:54:35.145147	\N	Jesus Gonzalo	0
3	\N	superdan	$2b$10$re6TsbDRk5bj6pU/BE3gr.nk2mOGgEQbfWhKmQCzJ5hEgj66kK8m6	superadmin	["ALL"]	t	2025-09-16 13:07:19.255423	2025-09-16 13:07:19.255423	Jack D.	0
2	\N	admin	admin	admin	"{\\"modules\\":[{\\"module\\":\\"users\\",\\"actions\\":[\\"create\\",\\"read\\",\\"update\\"]},{\\"module\\":\\"clients\\",\\"actions\\":[\\"create\\",\\"read\\",\\"update\\"]},{\\"module\\":\\"sales\\",\\"actions\\":[\\"create\\",\\"read\\",\\"update\\"]},{\\"module\\":\\"payments\\",\\"actions\\":[\\"create\\",\\"read\\",\\"update\\"]},{\\"module\\":\\"products\\",\\"actions\\":[\\"create\\",\\"read\\",\\"update\\"]},{\\"module\\":\\"reports\\",\\"actions\\":[\\"read\\",\\"export\\"]},{\\"module\\":\\"credits\\",\\"actions\\":[\\"create\\",\\"read\\",\\"update\\"]},{\\"module\\":\\"expenses\\",\\"actions\\":[\\"create\\",\\"read\\",\\"update\\"]},{\\"module\\":\\"employees\\",\\"actions\\":[\\"create\\",\\"read\\",\\"update\\"]},{\\"module\\":\\"suppliers\\",\\"actions\\":[\\"create\\",\\"read\\",\\"update\\"]},{\\"module\\":\\"tanks\\",\\"actions\\":[\\"read\\",\\"update\\"]},{\\"module\\":\\"pumps\\",\\"actions\\":[\\"read\\",\\"update\\"]},{\\"module\\":\\"nozzles\\",\\"actions\\":[\\"read\\",\\"update\\"]}],\\"isAdmin\\":false}"	t	2025-09-16 13:04:41.364338	2025-09-26 14:02:25.968378	cristian	0
6	\N	preubab	$2b$10$DfE8t3ZJzkDJkFgyvJuSpeBeA7rZXNWHNqb6Y6k0xy/0ZqI7IxJxe	admin	"{\\"modules\\":[{\\"module\\":\\"users\\",\\"actions\\":[\\"create\\",\\"read\\",\\"update\\"]},{\\"module\\":\\"clients\\",\\"actions\\":[\\"create\\",\\"read\\",\\"update\\"]},{\\"module\\":\\"sales\\",\\"actions\\":[\\"create\\",\\"read\\",\\"update\\"]},{\\"module\\":\\"payments\\",\\"actions\\":[\\"create\\",\\"read\\",\\"update\\"]},{\\"module\\":\\"products\\",\\"actions\\":[\\"create\\",\\"read\\",\\"update\\"]},{\\"module\\":\\"reports\\",\\"actions\\":[\\"read\\",\\"export\\"]},{\\"module\\":\\"credits\\",\\"actions\\":[\\"create\\",\\"read\\",\\"update\\"]},{\\"module\\":\\"expenses\\",\\"actions\\":[\\"create\\",\\"read\\",\\"update\\"]},{\\"module\\":\\"employees\\",\\"actions\\":[\\"create\\",\\"read\\",\\"update\\"]},{\\"module\\":\\"suppliers\\",\\"actions\\":[\\"create\\",\\"read\\",\\"update\\"]},{\\"module\\":\\"tanks\\",\\"actions\\":[\\"read\\",\\"update\\"]},{\\"module\\":\\"pumps\\",\\"actions\\":[\\"read\\",\\"update\\"]},{\\"module\\":\\"nozzles\\",\\"actions\\":[\\"read\\",\\"update\\"]}],\\"isAdmin\\":false}"	f	2025-10-07 12:05:01.6858	2025-10-07 12:05:06.778718	preuba b	0
\.


--
-- TOC entry 4590 (class 0 OID 0)
-- Dependencies: 212
-- Name: ap_bills_bill_id_seq; Type: SEQUENCE SET; Schema: public; Owner: postgres
--

SELECT pg_catalog.setval('public.ap_bills_bill_id_seq', 1, true);


--
-- TOC entry 4591 (class 0 OID 0)
-- Dependencies: 214
-- Name: ap_payments_ap_payment_id_seq; Type: SEQUENCE SET; Schema: public; Owner: postgres
--

SELECT pg_catalog.setval('public.ap_payments_ap_payment_id_seq', 1, true);


--
-- TOC entry 4592 (class 0 OID 0)
-- Dependencies: 216
-- Name: backup_config_id_seq; Type: SEQUENCE SET; Schema: public; Owner: postgres
--

SELECT pg_catalog.setval('public.backup_config_id_seq', 1, true);


--
-- TOC entry 4593 (class 0 OID 0)
-- Dependencies: 218
-- Name: backup_history_id_seq; Type: SEQUENCE SET; Schema: public; Owner: postgres
--

SELECT pg_catalog.setval('public.backup_history_id_seq', 3, true);


--
-- TOC entry 4594 (class 0 OID 0)
-- Dependencies: 220
-- Name: cash_box_sessions_id_seq; Type: SEQUENCE SET; Schema: public; Owner: postgres
--

SELECT pg_catalog.setval('public.cash_box_sessions_id_seq', 87, true);


--
-- TOC entry 4595 (class 0 OID 0)
-- Dependencies: 222
-- Name: cash_registers_id_seq; Type: SEQUENCE SET; Schema: public; Owner: postgres
--

SELECT pg_catalog.setval('public.cash_registers_id_seq', 1, false);


--
-- TOC entry 4596 (class 0 OID 0)
-- Dependencies: 224
-- Name: client_credit_limits_id_seq; Type: SEQUENCE SET; Schema: public; Owner: postgres
--

SELECT pg_catalog.setval('public.client_credit_limits_id_seq', 5, true);


--
-- TOC entry 4597 (class 0 OID 0)
-- Dependencies: 226
-- Name: client_drivers_driver_id_seq; Type: SEQUENCE SET; Schema: public; Owner: postgres
--

SELECT pg_catalog.setval('public.client_drivers_driver_id_seq', 11, true);


--
-- TOC entry 4598 (class 0 OID 0)
-- Dependencies: 228
-- Name: client_product_gallon_limits_id_seq; Type: SEQUENCE SET; Schema: public; Owner: postgres
--

SELECT pg_catalog.setval('public.client_product_gallon_limits_id_seq', 6, true);


--
-- TOC entry 4599 (class 0 OID 0)
-- Dependencies: 314
-- Name: client_product_rules_rule_id_seq; Type: SEQUENCE SET; Schema: public; Owner: postgres
--

SELECT pg_catalog.setval('public.client_product_rules_rule_id_seq', 1, false);


--
-- TOC entry 4600 (class 0 OID 0)
-- Dependencies: 230
-- Name: clients_client_id_seq; Type: SEQUENCE SET; Schema: public; Owner: postgres
--

SELECT pg_catalog.setval('public.clients_client_id_seq', 16, true);


--
-- TOC entry 4601 (class 0 OID 0)
-- Dependencies: 232
-- Name: credits_credit_id_seq; Type: SEQUENCE SET; Schema: public; Owner: postgres
--

SELECT pg_catalog.setval('public.credits_credit_id_seq', 25, true);


--
-- TOC entry 4602 (class 0 OID 0)
-- Dependencies: 234
-- Name: deliveries_delivery_id_seq; Type: SEQUENCE SET; Schema: public; Owner: postgres
--

SELECT pg_catalog.setval('public.deliveries_delivery_id_seq', 1, false);


--
-- TOC entry 4603 (class 0 OID 0)
-- Dependencies: 236
-- Name: delivery_details_delivery_detail_id_seq; Type: SEQUENCE SET; Schema: public; Owner: postgres
--

SELECT pg_catalog.setval('public.delivery_details_delivery_detail_id_seq', 1, false);


--
-- TOC entry 4604 (class 0 OID 0)
-- Dependencies: 238
-- Name: discounts_id_seq; Type: SEQUENCE SET; Schema: public; Owner: postgres
--

SELECT pg_catalog.setval('public.discounts_id_seq', 1, true);


--
-- TOC entry 4605 (class 0 OID 0)
-- Dependencies: 240
-- Name: dispensers_dispenser_id_seq; Type: SEQUENCE SET; Schema: public; Owner: postgres
--

SELECT pg_catalog.setval('public.dispensers_dispenser_id_seq', 1, false);


--
-- TOC entry 4606 (class 0 OID 0)
-- Dependencies: 242
-- Name: employees_employee_id_seq; Type: SEQUENCE SET; Schema: public; Owner: postgres
--

SELECT pg_catalog.setval('public.employees_employee_id_seq', 15, true);


--
-- TOC entry 4607 (class 0 OID 0)
-- Dependencies: 244
-- Name: expense_categories_category_id_seq; Type: SEQUENCE SET; Schema: public; Owner: postgres
--

SELECT pg_catalog.setval('public.expense_categories_category_id_seq', 6, true);


--
-- TOC entry 4608 (class 0 OID 0)
-- Dependencies: 246
-- Name: expenses_expense_id_seq; Type: SEQUENCE SET; Schema: public; Owner: postgres
--

SELECT pg_catalog.setval('public.expenses_expense_id_seq', 6, true);


--
-- TOC entry 4609 (class 0 OID 0)
-- Dependencies: 248
-- Name: landed_cost_allocation_lines_allocation_line_id_seq; Type: SEQUENCE SET; Schema: public; Owner: postgres
--

SELECT pg_catalog.setval('public.landed_cost_allocation_lines_allocation_line_id_seq', 2, true);


--
-- TOC entry 4610 (class 0 OID 0)
-- Dependencies: 250
-- Name: landed_cost_allocations_allocation_id_seq; Type: SEQUENCE SET; Schema: public; Owner: postgres
--

SELECT pg_catalog.setval('public.landed_cost_allocations_allocation_id_seq', 1, true);


--
-- TOC entry 4611 (class 0 OID 0)
-- Dependencies: 252
-- Name: meter_readings_reading_id_seq; Type: SEQUENCE SET; Schema: public; Owner: postgres
--

SELECT pg_catalog.setval('public.meter_readings_reading_id_seq', 202, true);


--
-- TOC entry 4612 (class 0 OID 0)
-- Dependencies: 263
-- Name: nozzles_nozzle_id_seq; Type: SEQUENCE SET; Schema: public; Owner: postgres
--

SELECT pg_catalog.setval('public.nozzles_nozzle_id_seq', 5, true);


--
-- TOC entry 4613 (class 0 OID 0)
-- Dependencies: 265
-- Name: payment_methods_payment_method_id_seq; Type: SEQUENCE SET; Schema: public; Owner: postgres
--

SELECT pg_catalog.setval('public.payment_methods_payment_method_id_seq', 4, true);


--
-- TOC entry 4614 (class 0 OID 0)
-- Dependencies: 267
-- Name: payments_payment_id_seq; Type: SEQUENCE SET; Schema: public; Owner: postgres
--

SELECT pg_catalog.setval('public.payments_payment_id_seq', 210, true);


--
-- TOC entry 4615 (class 0 OID 0)
-- Dependencies: 269
-- Name: products_product_id_seq; Type: SEQUENCE SET; Schema: public; Owner: postgres
--

SELECT pg_catalog.setval('public.products_product_id_seq', 5, true);


--
-- TOC entry 4616 (class 0 OID 0)
-- Dependencies: 271
-- Name: pump_tank_id_seq; Type: SEQUENCE SET; Schema: public; Owner: postgres
--

SELECT pg_catalog.setval('public.pump_tank_id_seq', 6, true);


--
-- TOC entry 4617 (class 0 OID 0)
-- Dependencies: 273
-- Name: pumps_pump_id_seq; Type: SEQUENCE SET; Schema: public; Owner: postgres
--

SELECT pg_catalog.setval('public.pumps_pump_id_seq', 4, true);


--
-- TOC entry 4618 (class 0 OID 0)
-- Dependencies: 275
-- Name: purchase_attachments_attachment_id_seq; Type: SEQUENCE SET; Schema: public; Owner: postgres
--

SELECT pg_catalog.setval('public.purchase_attachments_attachment_id_seq', 1, false);


--
-- TOC entry 4619 (class 0 OID 0)
-- Dependencies: 277
-- Name: purchase_lines_line_id_seq; Type: SEQUENCE SET; Schema: public; Owner: postgres
--

SELECT pg_catalog.setval('public.purchase_lines_line_id_seq', 10, true);


--
-- TOC entry 4620 (class 0 OID 0)
-- Dependencies: 279
-- Name: purchase_receipt_lines_receipt_line_id_seq; Type: SEQUENCE SET; Schema: public; Owner: postgres
--

SELECT pg_catalog.setval('public.purchase_receipt_lines_receipt_line_id_seq', 2, true);


--
-- TOC entry 4621 (class 0 OID 0)
-- Dependencies: 281
-- Name: purchase_receipts_receipt_id_seq; Type: SEQUENCE SET; Schema: public; Owner: postgres
--

SELECT pg_catalog.setval('public.purchase_receipts_receipt_id_seq', 1, true);


--
-- TOC entry 4622 (class 0 OID 0)
-- Dependencies: 282
-- Name: sale_details_sale_detail_id_seq; Type: SEQUENCE SET; Schema: public; Owner: postgres
--

SELECT pg_catalog.setval('public.sale_details_sale_detail_id_seq', 220, true);


--
-- TOC entry 4623 (class 0 OID 0)
-- Dependencies: 283
-- Name: sales_sale_id_seq; Type: SEQUENCE SET; Schema: public; Owner: postgres
--

SELECT pg_catalog.setval('public.sales_sale_id_seq', 268, true);


--
-- TOC entry 4624 (class 0 OID 0)
-- Dependencies: 286
-- Name: sectors_sector_id_seq; Type: SEQUENCE SET; Schema: public; Owner: postgres
--

SELECT pg_catalog.setval('public.sectors_sector_id_seq', 17, true);


--
-- TOC entry 4625 (class 0 OID 0)
-- Dependencies: 288
-- Name: settings_setting_id_seq; Type: SEQUENCE SET; Schema: public; Owner: postgres
--

SELECT pg_catalog.setval('public.settings_setting_id_seq', 1, false);


--
-- TOC entry 4626 (class 0 OID 0)
-- Dependencies: 290
-- Name: shifts_id_seq; Type: SEQUENCE SET; Schema: public; Owner: postgres
--

SELECT pg_catalog.setval('public.shifts_id_seq', 1, false);


--
-- TOC entry 4627 (class 0 OID 0)
-- Dependencies: 292
-- Name: stock_movements_stock_movement_id_seq; Type: SEQUENCE SET; Schema: public; Owner: postgres
--

SELECT pg_catalog.setval('public.stock_movements_stock_movement_id_seq', 210, true);


--
-- TOC entry 4628 (class 0 OID 0)
-- Dependencies: 294
-- Name: suppliers_supplier_id_seq; Type: SEQUENCE SET; Schema: public; Owner: postgres
--

SELECT pg_catalog.setval('public.suppliers_supplier_id_seq', 1, false);


--
-- TOC entry 4629 (class 0 OID 0)
-- Dependencies: 296
-- Name: tanks_tank_id_seq; Type: SEQUENCE SET; Schema: public; Owner: postgres
--

SELECT pg_catalog.setval('public.tanks_tank_id_seq', 5, true);


--
-- TOC entry 4630 (class 0 OID 0)
-- Dependencies: 298
-- Name: user_audit_logs_audit_id_seq; Type: SEQUENCE SET; Schema: public; Owner: postgres
--

SELECT pg_catalog.setval('public.user_audit_logs_audit_id_seq', 1, false);


--
-- TOC entry 4631 (class 0 OID 0)
-- Dependencies: 301
-- Name: users_user_id_seq; Type: SEQUENCE SET; Schema: public; Owner: postgres
--

SELECT pg_catalog.setval('public.users_user_id_seq', 6, true);


--
-- TOC entry 3958 (class 2606 OID 18401)
-- Name: ap_bills ap_bills_pkey; Type: CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.ap_bills
    ADD CONSTRAINT ap_bills_pkey PRIMARY KEY (bill_id);


--
-- TOC entry 3960 (class 2606 OID 18403)
-- Name: ap_bills ap_bills_purchase_id_key; Type: CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.ap_bills
    ADD CONSTRAINT ap_bills_purchase_id_key UNIQUE (purchase_id);


--
-- TOC entry 3964 (class 2606 OID 18405)
-- Name: ap_payments ap_payments_pkey; Type: CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.ap_payments
    ADD CONSTRAINT ap_payments_pkey PRIMARY KEY (ap_payment_id);


--
-- TOC entry 3968 (class 2606 OID 18407)
-- Name: backup_config backup_config_pkey; Type: CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.backup_config
    ADD CONSTRAINT backup_config_pkey PRIMARY KEY (id);


--
-- TOC entry 3970 (class 2606 OID 18409)
-- Name: backup_history backup_history_pkey; Type: CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.backup_history
    ADD CONSTRAINT backup_history_pkey PRIMARY KEY (id);


--
-- TOC entry 3972 (class 2606 OID 18411)
-- Name: cash_box_sessions cash_box_sessions_pkey; Type: CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.cash_box_sessions
    ADD CONSTRAINT cash_box_sessions_pkey PRIMARY KEY (id);


--
-- TOC entry 3977 (class 2606 OID 18413)
-- Name: cash_registers cash_registers_pkey; Type: CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.cash_registers
    ADD CONSTRAINT cash_registers_pkey PRIMARY KEY (id);


--
-- TOC entry 3979 (class 2606 OID 18415)
-- Name: client_credit_limits client_credit_limits_pkey; Type: CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.client_credit_limits
    ADD CONSTRAINT client_credit_limits_pkey PRIMARY KEY (id);


--
-- TOC entry 3983 (class 2606 OID 18417)
-- Name: client_drivers client_drivers_company_dni_unique; Type: CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.client_drivers
    ADD CONSTRAINT client_drivers_company_dni_unique UNIQUE (company_id, dni);


--
-- TOC entry 3986 (class 2606 OID 18419)
-- Name: client_drivers client_drivers_company_license_unique; Type: CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.client_drivers
    ADD CONSTRAINT client_drivers_company_license_unique UNIQUE (company_id, driver_license);


--
-- TOC entry 3988 (class 2606 OID 18421)
-- Name: client_drivers client_drivers_company_plate_unique; Type: CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.client_drivers
    ADD CONSTRAINT client_drivers_company_plate_unique UNIQUE (company_id, plate);


--
-- TOC entry 3992 (class 2606 OID 18423)
-- Name: client_drivers client_drivers_pkey; Type: CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.client_drivers
    ADD CONSTRAINT client_drivers_pkey PRIMARY KEY (driver_id);


--
-- TOC entry 3995 (class 2606 OID 18425)
-- Name: client_product_gallon_limits client_product_gallon_limits_pkey; Type: CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.client_product_gallon_limits
    ADD CONSTRAINT client_product_gallon_limits_pkey PRIMARY KEY (id);


--
-- TOC entry 4179 (class 2606 OID 19901)
-- Name: client_product_rules client_product_rules_pkey; Type: CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.client_product_rules
    ADD CONSTRAINT client_product_rules_pkey PRIMARY KEY (rule_id);


--
-- TOC entry 4000 (class 2606 OID 18427)
-- Name: clients clients_document_number_key; Type: CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.clients
    ADD CONSTRAINT clients_document_number_key UNIQUE (document_number);


--
-- TOC entry 4002 (class 2606 OID 18429)
-- Name: clients clients_email_key; Type: CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.clients
    ADD CONSTRAINT clients_email_key UNIQUE (email);


--
-- TOC entry 4004 (class 2606 OID 18431)
-- Name: clients clients_pkey; Type: CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.clients
    ADD CONSTRAINT clients_pkey PRIMARY KEY (client_id);


--
-- TOC entry 4008 (class 2606 OID 18433)
-- Name: credits credits_pkey; Type: CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.credits
    ADD CONSTRAINT credits_pkey PRIMARY KEY (credit_id);


--
-- TOC entry 4021 (class 2606 OID 18435)
-- Name: deliveries deliveries_pkey; Type: CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.deliveries
    ADD CONSTRAINT deliveries_pkey PRIMARY KEY (delivery_id);


--
-- TOC entry 4023 (class 2606 OID 18437)
-- Name: delivery_details delivery_details_pkey; Type: CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.delivery_details
    ADD CONSTRAINT delivery_details_pkey PRIMARY KEY (delivery_detail_id);


--
-- TOC entry 4025 (class 2606 OID 18439)
-- Name: discounts discounts_pkey; Type: CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.discounts
    ADD CONSTRAINT discounts_pkey PRIMARY KEY (id);


--
-- TOC entry 4027 (class 2606 OID 18441)
-- Name: dispensers dispensers_dispenser_number_key; Type: CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.dispensers
    ADD CONSTRAINT dispensers_dispenser_number_key UNIQUE (dispenser_number);


--
-- TOC entry 4029 (class 2606 OID 18443)
-- Name: dispensers dispensers_pkey; Type: CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.dispensers
    ADD CONSTRAINT dispensers_pkey PRIMARY KEY (dispenser_id);


--
-- TOC entry 4031 (class 2606 OID 18445)
-- Name: employees employees_dni_key; Type: CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.employees
    ADD CONSTRAINT employees_dni_key UNIQUE (dni);


--
-- TOC entry 4033 (class 2606 OID 18447)
-- Name: employees employees_email_key; Type: CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.employees
    ADD CONSTRAINT employees_email_key UNIQUE (email);


--
-- TOC entry 4035 (class 2606 OID 18449)
-- Name: employees employees_pkey; Type: CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.employees
    ADD CONSTRAINT employees_pkey PRIMARY KEY (employee_id);


--
-- TOC entry 4037 (class 2606 OID 18451)
-- Name: expense_categories expense_categories_category_name_key; Type: CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.expense_categories
    ADD CONSTRAINT expense_categories_category_name_key UNIQUE (category_name);


--
-- TOC entry 4039 (class 2606 OID 18453)
-- Name: expense_categories expense_categories_pkey; Type: CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.expense_categories
    ADD CONSTRAINT expense_categories_pkey PRIMARY KEY (category_id);


--
-- TOC entry 4041 (class 2606 OID 18455)
-- Name: expenses expenses_pkey; Type: CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.expenses
    ADD CONSTRAINT expenses_pkey PRIMARY KEY (expense_id);


--
-- TOC entry 4045 (class 2606 OID 18457)
-- Name: landed_cost_allocation_lines landed_cost_allocation_lines_pkey; Type: CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.landed_cost_allocation_lines
    ADD CONSTRAINT landed_cost_allocation_lines_pkey PRIMARY KEY (allocation_line_id);


--
-- TOC entry 4048 (class 2606 OID 18459)
-- Name: landed_cost_allocations landed_cost_allocations_pkey; Type: CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.landed_cost_allocations
    ADD CONSTRAINT landed_cost_allocations_pkey PRIMARY KEY (allocation_id);


--
-- TOC entry 4050 (class 2606 OID 18461)
-- Name: meter_readings meter_readings_pkey; Type: CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.meter_readings
    ADD CONSTRAINT meter_readings_pkey PRIMARY KEY (reading_id);


--
-- TOC entry 4086 (class 2606 OID 18463)
-- Name: nozzles nozzles_pkey; Type: CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.nozzles
    ADD CONSTRAINT nozzles_pkey PRIMARY KEY (nozzle_id);


--
-- TOC entry 4088 (class 2606 OID 18465)
-- Name: payment_methods payment_methods_method_name_key; Type: CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.payment_methods
    ADD CONSTRAINT payment_methods_method_name_key UNIQUE (method_name);


--
-- TOC entry 4090 (class 2606 OID 18467)
-- Name: payment_methods payment_methods_pkey; Type: CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.payment_methods
    ADD CONSTRAINT payment_methods_pkey PRIMARY KEY (payment_method_id);


--
-- TOC entry 4099 (class 2606 OID 18469)
-- Name: payments payments_pkey; Type: CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.payments
    ADD CONSTRAINT payments_pkey PRIMARY KEY (payment_id);


--
-- TOC entry 4103 (class 2606 OID 18471)
-- Name: products products_name_key; Type: CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.products
    ADD CONSTRAINT products_name_key UNIQUE (name);


--
-- TOC entry 4105 (class 2606 OID 18473)
-- Name: products products_pkey; Type: CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.products
    ADD CONSTRAINT products_pkey PRIMARY KEY (product_id);


--
-- TOC entry 4107 (class 2606 OID 18475)
-- Name: pump_tank pump_tank_pkey; Type: CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.pump_tank
    ADD CONSTRAINT pump_tank_pkey PRIMARY KEY (id);


--
-- TOC entry 4109 (class 2606 OID 18477)
-- Name: pumps pumps_pkey; Type: CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.pumps
    ADD CONSTRAINT pumps_pkey PRIMARY KEY (pump_id);


--
-- TOC entry 4111 (class 2606 OID 18479)
-- Name: pumps pumps_pump_name_key; Type: CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.pumps
    ADD CONSTRAINT pumps_pump_name_key UNIQUE (pump_name);


--
-- TOC entry 4113 (class 2606 OID 18481)
-- Name: pumps pumps_pump_number_key; Type: CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.pumps
    ADD CONSTRAINT pumps_pump_number_key UNIQUE (pump_number);


--
-- TOC entry 4116 (class 2606 OID 18483)
-- Name: purchase_attachments purchase_attachments_pkey; Type: CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.purchase_attachments
    ADD CONSTRAINT purchase_attachments_pkey PRIMARY KEY (attachment_id);


--
-- TOC entry 4122 (class 2606 OID 18485)
-- Name: purchase_lines purchase_lines_pkey; Type: CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.purchase_lines
    ADD CONSTRAINT purchase_lines_pkey PRIMARY KEY (line_id);


--
-- TOC entry 4127 (class 2606 OID 18487)
-- Name: purchase_receipt_lines purchase_receipt_lines_pkey; Type: CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.purchase_receipt_lines
    ADD CONSTRAINT purchase_receipt_lines_pkey PRIMARY KEY (receipt_line_id);


--
-- TOC entry 4130 (class 2606 OID 18489)
-- Name: purchase_receipts purchase_receipts_pkey; Type: CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.purchase_receipts
    ADD CONSTRAINT purchase_receipts_pkey PRIMARY KEY (receipt_id);


--
-- TOC entry 4078 (class 2606 OID 18491)
-- Name: sale_details sale_details_pkey; Type: CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.sale_details
    ADD CONSTRAINT sale_details_pkey PRIMARY KEY (sale_detail_id);


--
-- TOC entry 4073 (class 2606 OID 18493)
-- Name: sales sales_pkey; Type: CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.sales
    ADD CONSTRAINT sales_pkey PRIMARY KEY (sale_id);


--
-- TOC entry 4133 (class 2606 OID 18495)
-- Name: sector_drivers sector_drivers_pkey; Type: CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.sector_drivers
    ADD CONSTRAINT sector_drivers_pkey PRIMARY KEY (sector_id, driver_id, start_date);


--
-- TOC entry 4138 (class 2606 OID 18497)
-- Name: sectors sectors_pkey; Type: CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.sectors
    ADD CONSTRAINT sectors_pkey PRIMARY KEY (sector_id);


--
-- TOC entry 4141 (class 2606 OID 18499)
-- Name: settings settings_pkey; Type: CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.settings
    ADD CONSTRAINT settings_pkey PRIMARY KEY (setting_id);


--
-- TOC entry 4143 (class 2606 OID 18501)
-- Name: settings settings_ruc_key; Type: CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.settings
    ADD CONSTRAINT settings_ruc_key UNIQUE (ruc);


--
-- TOC entry 4145 (class 2606 OID 18503)
-- Name: shifts shifts_pkey; Type: CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.shifts
    ADD CONSTRAINT shifts_pkey PRIMARY KEY (id);


--
-- TOC entry 4150 (class 2606 OID 18505)
-- Name: stock_movements stock_movements_pkey; Type: CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.stock_movements
    ADD CONSTRAINT stock_movements_pkey PRIMARY KEY (stock_movement_id);


--
-- TOC entry 4152 (class 2606 OID 18507)
-- Name: suppliers suppliers_email_key; Type: CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.suppliers
    ADD CONSTRAINT suppliers_email_key UNIQUE (email);


--
-- TOC entry 4154 (class 2606 OID 18509)
-- Name: suppliers suppliers_pkey; Type: CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.suppliers
    ADD CONSTRAINT suppliers_pkey PRIMARY KEY (supplier_id);


--
-- TOC entry 4156 (class 2606 OID 18511)
-- Name: suppliers suppliers_ruc_key; Type: CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.suppliers
    ADD CONSTRAINT suppliers_ruc_key UNIQUE (ruc);


--
-- TOC entry 4158 (class 2606 OID 18513)
-- Name: tanks tanks_pkey; Type: CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.tanks
    ADD CONSTRAINT tanks_pkey PRIMARY KEY (tank_id);


--
-- TOC entry 4160 (class 2606 OID 18515)
-- Name: tanks tanks_tank_name_key; Type: CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.tanks
    ADD CONSTRAINT tanks_tank_name_key UNIQUE (tank_name);


--
-- TOC entry 3981 (class 2606 OID 18517)
-- Name: client_credit_limits uq_client_credit_limits; Type: CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.client_credit_limits
    ADD CONSTRAINT uq_client_credit_limits UNIQUE (client_id, period_kind, is_active);


--
-- TOC entry 4166 (class 2606 OID 18519)
-- Name: user_audit_logs user_audit_logs_pkey; Type: CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.user_audit_logs
    ADD CONSTRAINT user_audit_logs_pkey PRIMARY KEY (audit_id);


--
-- TOC entry 4172 (class 2606 OID 18521)
-- Name: users users_employee_id_key; Type: CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.users
    ADD CONSTRAINT users_employee_id_key UNIQUE (employee_id);


--
-- TOC entry 4174 (class 2606 OID 18523)
-- Name: users users_pkey; Type: CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.users
    ADD CONSTRAINT users_pkey PRIMARY KEY (user_id);


--
-- TOC entry 4176 (class 2606 OID 18525)
-- Name: users users_username_key; Type: CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.users
    ADD CONSTRAINT users_username_key UNIQUE (username);


--
-- TOC entry 3984 (class 1259 OID 18526)
-- Name: client_drivers_company_idx; Type: INDEX; Schema: public; Owner: postgres
--

CREATE INDEX client_drivers_company_idx ON public.client_drivers USING btree (company_id);


--
-- TOC entry 3989 (class 1259 OID 18527)
-- Name: client_drivers_dni_idx; Type: INDEX; Schema: public; Owner: postgres
--

CREATE INDEX client_drivers_dni_idx ON public.client_drivers USING btree (dni);


--
-- TOC entry 3990 (class 1259 OID 18528)
-- Name: client_drivers_license_idx; Type: INDEX; Schema: public; Owner: postgres
--

CREATE INDEX client_drivers_license_idx ON public.client_drivers USING btree (driver_license);


--
-- TOC entry 3993 (class 1259 OID 18529)
-- Name: client_drivers_plate_idx; Type: INDEX; Schema: public; Owner: postgres
--

CREATE INDEX client_drivers_plate_idx ON public.client_drivers USING btree (plate);


--
-- TOC entry 4006 (class 1259 OID 18530)
-- Name: credits_driver_id_idx; Type: INDEX; Schema: public; Owner: postgres
--

CREATE INDEX credits_driver_id_idx ON public.credits USING btree (driver_id);


--
-- TOC entry 3961 (class 1259 OID 18531)
-- Name: idx_ap_bills_status; Type: INDEX; Schema: public; Owner: postgres
--

CREATE INDEX idx_ap_bills_status ON public.ap_bills USING btree (status);


--
-- TOC entry 3962 (class 1259 OID 18532)
-- Name: idx_ap_bills_supplier; Type: INDEX; Schema: public; Owner: postgres
--

CREATE INDEX idx_ap_bills_supplier ON public.ap_bills USING btree (supplier_id);


--
-- TOC entry 3965 (class 1259 OID 18533)
-- Name: idx_ap_payments_bill; Type: INDEX; Schema: public; Owner: postgres
--

CREATE INDEX idx_ap_payments_bill ON public.ap_payments USING btree (bill_id);


--
-- TOC entry 3966 (class 1259 OID 18534)
-- Name: idx_ap_payments_dt; Type: INDEX; Schema: public; Owner: postgres
--

CREATE INDEX idx_ap_payments_dt ON public.ap_payments USING btree (paid_at);


--
-- TOC entry 4114 (class 1259 OID 18535)
-- Name: idx_attach_purchase; Type: INDEX; Schema: public; Owner: postgres
--

CREATE INDEX idx_attach_purchase ON public.purchase_attachments USING btree (purchase_id);


--
-- TOC entry 3973 (class 1259 OID 18536)
-- Name: idx_cash_box_day_date; Type: INDEX; Schema: public; Owner: postgres
--

CREATE INDEX idx_cash_box_day_date ON public.cash_box_sessions USING btree (day_date DESC);


--
-- TOC entry 3974 (class 1259 OID 18537)
-- Name: idx_cash_box_opened_at; Type: INDEX; Schema: public; Owner: postgres
--

CREATE INDEX idx_cash_box_opened_at ON public.cash_box_sessions USING btree (opened_at DESC);


--
-- TOC entry 4005 (class 1259 OID 18538)
-- Name: idx_clients_restrict_to_limited_products; Type: INDEX; Schema: public; Owner: postgres
--

CREATE INDEX idx_clients_restrict_to_limited_products ON public.clients USING btree (restrict_to_limited_products);


--
-- TOC entry 4180 (class 1259 OID 19912)
-- Name: idx_cpr_client; Type: INDEX; Schema: public; Owner: postgres
--

CREATE INDEX idx_cpr_client ON public.client_product_rules USING btree (client_id);


--
-- TOC entry 4181 (class 1259 OID 19913)
-- Name: idx_cpr_client_product; Type: INDEX; Schema: public; Owner: postgres
--

CREATE INDEX idx_cpr_client_product ON public.client_product_rules USING btree (client_id, product_id);


--
-- TOC entry 4009 (class 1259 OID 18539)
-- Name: idx_credits_client_driver; Type: INDEX; Schema: public; Owner: postgres
--

CREATE INDEX idx_credits_client_driver ON public.credits USING btree (client_id, company_driver_id);


--
-- TOC entry 4010 (class 1259 OID 18540)
-- Name: idx_credits_client_id; Type: INDEX; Schema: public; Owner: postgres
--

CREATE INDEX idx_credits_client_id ON public.credits USING btree (client_id);


--
-- TOC entry 4011 (class 1259 OID 18541)
-- Name: idx_credits_client_sector; Type: INDEX; Schema: public; Owner: postgres
--

CREATE INDEX idx_credits_client_sector ON public.credits USING btree (client_id, sector_id);


--
-- TOC entry 4012 (class 1259 OID 18542)
-- Name: idx_credits_due_date; Type: INDEX; Schema: public; Owner: postgres
--

CREATE INDEX idx_credits_due_date ON public.credits USING btree (due_date);


--
-- TOC entry 4013 (class 1259 OID 18543)
-- Name: idx_credits_due_status; Type: INDEX; Schema: public; Owner: postgres
--

CREATE INDEX idx_credits_due_status ON public.credits USING btree (due_date, status);


--
-- TOC entry 4014 (class 1259 OID 18544)
-- Name: idx_credits_sector_id; Type: INDEX; Schema: public; Owner: postgres
--

CREATE INDEX idx_credits_sector_id ON public.credits USING btree (sector_id);


--
-- TOC entry 4042 (class 1259 OID 18545)
-- Name: idx_lc_alloc_lines_alloc; Type: INDEX; Schema: public; Owner: postgres
--

CREATE INDEX idx_lc_alloc_lines_alloc ON public.landed_cost_allocation_lines USING btree (allocation_id);


--
-- TOC entry 4043 (class 1259 OID 18546)
-- Name: idx_lc_alloc_lines_line; Type: INDEX; Schema: public; Owner: postgres
--

CREATE INDEX idx_lc_alloc_lines_line ON public.landed_cost_allocation_lines USING btree (line_id);


--
-- TOC entry 4046 (class 1259 OID 18547)
-- Name: idx_lc_alloc_purchase; Type: INDEX; Schema: public; Owner: postgres
--

CREATE INDEX idx_lc_alloc_purchase ON public.landed_cost_allocations USING btree (purchase_id);


--
-- TOC entry 4074 (class 1259 OID 18548)
-- Name: idx_mv_emp_sales_daily_emp_day; Type: INDEX; Schema: public; Owner: postgres
--

CREATE INDEX idx_mv_emp_sales_daily_emp_day ON public.mv_employee_sales_daily USING btree (employee_id, day);


--
-- TOC entry 4079 (class 1259 OID 18549)
-- Name: idx_mv_prod_sales_by_shift; Type: INDEX; Schema: public; Owner: postgres
--

CREATE INDEX idx_mv_prod_sales_by_shift ON public.mv_product_sales_by_shift USING btree (product_id, shift);


--
-- TOC entry 4080 (class 1259 OID 18550)
-- Name: idx_mv_prod_sales_daily_prod_day; Type: INDEX; Schema: public; Owner: postgres
--

CREATE INDEX idx_mv_prod_sales_daily_prod_day ON public.mv_product_sales_daily USING btree (product_id, day);


--
-- TOC entry 4081 (class 1259 OID 18551)
-- Name: idx_mv_prod_sales_monthly_prod_month; Type: INDEX; Schema: public; Owner: postgres
--

CREATE INDEX idx_mv_prod_sales_monthly_prod_month ON public.mv_product_sales_monthly USING btree (product_id, month_start);


--
-- TOC entry 4082 (class 1259 OID 18552)
-- Name: idx_mv_prod_sales_weekly_prod_week; Type: INDEX; Schema: public; Owner: postgres
--

CREATE INDEX idx_mv_prod_sales_weekly_prod_week ON public.mv_product_sales_weekly USING btree (product_id, week_start);


--
-- TOC entry 4083 (class 1259 OID 18553)
-- Name: idx_mv_prod_sales_yearly_prod_year; Type: INDEX; Schema: public; Owner: postgres
--

CREATE INDEX idx_mv_prod_sales_yearly_prod_year ON public.mv_product_sales_yearly USING btree (product_id, year_start);


--
-- TOC entry 4084 (class 1259 OID 18554)
-- Name: idx_nozzles_dispenser_id; Type: INDEX; Schema: public; Owner: postgres
--

CREATE INDEX idx_nozzles_dispenser_id ON public.nozzles USING btree (dispenser_id);


--
-- TOC entry 4091 (class 1259 OID 18555)
-- Name: idx_payments_credit_id; Type: INDEX; Schema: public; Owner: postgres
--

CREATE INDEX idx_payments_credit_id ON public.payments USING btree (credit_id);


--
-- TOC entry 4092 (class 1259 OID 18556)
-- Name: idx_payments_payment_timestamp; Type: INDEX; Schema: public; Owner: postgres
--

CREATE INDEX idx_payments_payment_timestamp ON public.payments USING btree (payment_timestamp);


--
-- TOC entry 4093 (class 1259 OID 18557)
-- Name: idx_payments_timestamp; Type: INDEX; Schema: public; Owner: postgres
--

CREATE INDEX idx_payments_timestamp ON public.payments USING btree (payment_timestamp DESC);


--
-- TOC entry 4094 (class 1259 OID 18558)
-- Name: idx_payments_ts; Type: INDEX; Schema: public; Owner: postgres
--

CREATE INDEX idx_payments_ts ON public.payments USING btree (payment_timestamp DESC);


--
-- TOC entry 4117 (class 1259 OID 18559)
-- Name: idx_pl_issue_date; Type: INDEX; Schema: public; Owner: postgres
--

CREATE INDEX idx_pl_issue_date ON public.purchase_lines USING btree (issue_date) WHERE (line_type = 'HEADER'::public.purchase_line_type);


--
-- TOC entry 4118 (class 1259 OID 18560)
-- Name: idx_pl_purchase; Type: INDEX; Schema: public; Owner: postgres
--

CREATE INDEX idx_pl_purchase ON public.purchase_lines USING btree (purchase_id);


--
-- TOC entry 4119 (class 1259 OID 18561)
-- Name: idx_pl_supplier_issue; Type: INDEX; Schema: public; Owner: postgres
--

CREATE INDEX idx_pl_supplier_issue ON public.purchase_lines USING btree (supplier_id, issue_date) WHERE (line_type = 'HEADER'::public.purchase_line_type);


--
-- TOC entry 4120 (class 1259 OID 18562)
-- Name: idx_pl_type; Type: INDEX; Schema: public; Owner: postgres
--

CREATE INDEX idx_pl_type ON public.purchase_lines USING btree (line_type);


--
-- TOC entry 4124 (class 1259 OID 18563)
-- Name: idx_receipt_lines_line; Type: INDEX; Schema: public; Owner: postgres
--

CREATE INDEX idx_receipt_lines_line ON public.purchase_receipt_lines USING btree (line_id);


--
-- TOC entry 4125 (class 1259 OID 18564)
-- Name: idx_receipt_lines_receipt; Type: INDEX; Schema: public; Owner: postgres
--

CREATE INDEX idx_receipt_lines_receipt ON public.purchase_receipt_lines USING btree (receipt_id);


--
-- TOC entry 4128 (class 1259 OID 18565)
-- Name: idx_receipts_purchase; Type: INDEX; Schema: public; Owner: postgres
--

CREATE INDEX idx_receipts_purchase ON public.purchase_receipts USING btree (purchase_id);


--
-- TOC entry 4051 (class 1259 OID 18566)
-- Name: idx_sales_client; Type: INDEX; Schema: public; Owner: postgres
--

CREATE INDEX idx_sales_client ON public.sales USING btree (client_id);


--
-- TOC entry 4052 (class 1259 OID 18567)
-- Name: idx_sales_client_date; Type: INDEX; Schema: public; Owner: postgres
--

CREATE INDEX idx_sales_client_date ON public.sales USING btree (client_id, sale_timestamp);


--
-- TOC entry 4053 (class 1259 OID 18568)
-- Name: idx_sales_client_id; Type: INDEX; Schema: public; Owner: postgres
--

CREATE INDEX idx_sales_client_id ON public.sales USING btree (client_id);


--
-- TOC entry 4054 (class 1259 OID 18569)
-- Name: idx_sales_employee_id; Type: INDEX; Schema: public; Owner: postgres
--

CREATE INDEX idx_sales_employee_id ON public.sales USING btree (employee_id);


--
-- TOC entry 4055 (class 1259 OID 18570)
-- Name: idx_sales_employee_ts; Type: INDEX; Schema: public; Owner: postgres
--

CREATE INDEX idx_sales_employee_ts ON public.sales USING btree (employee_id, sale_timestamp);


--
-- TOC entry 4056 (class 1259 OID 18571)
-- Name: idx_sales_nozzle; Type: INDEX; Schema: public; Owner: postgres
--

CREATE INDEX idx_sales_nozzle ON public.sales USING btree (nozzle_id);


--
-- TOC entry 4057 (class 1259 OID 18572)
-- Name: idx_sales_nozzle_id; Type: INDEX; Schema: public; Owner: postgres
--

CREATE INDEX idx_sales_nozzle_id ON public.sales USING btree (nozzle_id);


--
-- TOC entry 4058 (class 1259 OID 18573)
-- Name: idx_sales_payment; Type: INDEX; Schema: public; Owner: postgres
--

CREATE INDEX idx_sales_payment ON public.sales USING btree (payment_method_id);


--
-- TOC entry 4059 (class 1259 OID 18574)
-- Name: idx_sales_payment_method_id; Type: INDEX; Schema: public; Owner: postgres
--

CREATE INDEX idx_sales_payment_method_id ON public.sales USING btree (payment_method_id);


--
-- TOC entry 4060 (class 1259 OID 18575)
-- Name: idx_sales_sale_timestamp; Type: INDEX; Schema: public; Owner: postgres
--

CREATE INDEX idx_sales_sale_timestamp ON public.sales USING btree (sale_timestamp);


--
-- TOC entry 4061 (class 1259 OID 18576)
-- Name: idx_sales_sector_id; Type: INDEX; Schema: public; Owner: postgres
--

CREATE INDEX idx_sales_sector_id ON public.sales USING btree (sector_id);


--
-- TOC entry 4062 (class 1259 OID 18577)
-- Name: idx_sales_timestamp; Type: INDEX; Schema: public; Owner: postgres
--

CREATE INDEX idx_sales_timestamp ON public.sales USING btree (sale_timestamp DESC);


--
-- TOC entry 4063 (class 1259 OID 18578)
-- Name: idx_sales_user; Type: INDEX; Schema: public; Owner: postgres
--

CREATE INDEX idx_sales_user ON public.sales USING btree (user_id);


--
-- TOC entry 4064 (class 1259 OID 18579)
-- Name: idx_sales_user_ts; Type: INDEX; Schema: public; Owner: postgres
--

CREATE INDEX idx_sales_user_ts ON public.sales USING btree (user_id, sale_timestamp);


--
-- TOC entry 4075 (class 1259 OID 18580)
-- Name: idx_sd_product; Type: INDEX; Schema: public; Owner: postgres
--

CREATE INDEX idx_sd_product ON public.sale_details USING btree (product_id);


--
-- TOC entry 4076 (class 1259 OID 18581)
-- Name: idx_sd_sale; Type: INDEX; Schema: public; Owner: postgres
--

CREATE INDEX idx_sd_sale ON public.sale_details USING btree (sale_id);


--
-- TOC entry 4146 (class 1259 OID 18582)
-- Name: idx_stock_movements_movement_timestamp; Type: INDEX; Schema: public; Owner: postgres
--

CREATE INDEX idx_stock_movements_movement_timestamp ON public.stock_movements USING btree (movement_timestamp);


--
-- TOC entry 4147 (class 1259 OID 18583)
-- Name: idx_stock_movements_product_id; Type: INDEX; Schema: public; Owner: postgres
--

CREATE INDEX idx_stock_movements_product_id ON public.stock_movements USING btree (product_id);


--
-- TOC entry 4148 (class 1259 OID 18584)
-- Name: idx_stock_movements_tank_id; Type: INDEX; Schema: public; Owner: postgres
--

CREATE INDEX idx_stock_movements_tank_id ON public.stock_movements USING btree (tank_id);


--
-- TOC entry 4161 (class 1259 OID 18585)
-- Name: idx_user_audit_logs_action; Type: INDEX; Schema: public; Owner: postgres
--

CREATE INDEX idx_user_audit_logs_action ON public.user_audit_logs USING btree (action);


--
-- TOC entry 4162 (class 1259 OID 18586)
-- Name: idx_user_audit_logs_performed_by; Type: INDEX; Schema: public; Owner: postgres
--

CREATE INDEX idx_user_audit_logs_performed_by ON public.user_audit_logs USING btree (performed_by);


--
-- TOC entry 4163 (class 1259 OID 18587)
-- Name: idx_user_audit_logs_target_user; Type: INDEX; Schema: public; Owner: postgres
--

CREATE INDEX idx_user_audit_logs_target_user ON public.user_audit_logs USING btree (target_user);


--
-- TOC entry 4164 (class 1259 OID 18588)
-- Name: idx_user_audit_logs_timestamp; Type: INDEX; Schema: public; Owner: postgres
--

CREATE INDEX idx_user_audit_logs_timestamp ON public.user_audit_logs USING btree ("timestamp");


--
-- TOC entry 4167 (class 1259 OID 18589)
-- Name: idx_users_is_active; Type: INDEX; Schema: public; Owner: postgres
--

CREATE INDEX idx_users_is_active ON public.users USING btree (is_active);


--
-- TOC entry 4168 (class 1259 OID 18590)
-- Name: idx_users_role; Type: INDEX; Schema: public; Owner: postgres
--

CREATE INDEX idx_users_role ON public.users USING btree (role);


--
-- TOC entry 4169 (class 1259 OID 18591)
-- Name: idx_users_role_active; Type: INDEX; Schema: public; Owner: postgres
--

CREATE INDEX idx_users_role_active ON public.users USING btree (role, is_active);


--
-- TOC entry 4170 (class 1259 OID 18592)
-- Name: idx_users_username; Type: INDEX; Schema: public; Owner: postgres
--

CREATE INDEX idx_users_username ON public.users USING btree (username);


--
-- TOC entry 3996 (class 1259 OID 18593)
-- Name: ix_cpg_limits_active; Type: INDEX; Schema: public; Owner: postgres
--

CREATE INDEX ix_cpg_limits_active ON public.client_product_gallon_limits USING btree (is_active);


--
-- TOC entry 3997 (class 1259 OID 18594)
-- Name: ix_cpg_limits_client_product; Type: INDEX; Schema: public; Owner: postgres
--

CREATE INDEX ix_cpg_limits_client_product ON public.client_product_gallon_limits USING btree (client_id, product_id);


--
-- TOC entry 4015 (class 1259 OID 18595)
-- Name: ix_credits_client; Type: INDEX; Schema: public; Owner: postgres
--

CREATE INDEX ix_credits_client ON public.credits USING btree (client_id);


--
-- TOC entry 4016 (class 1259 OID 18596)
-- Name: ix_credits_client_date; Type: INDEX; Schema: public; Owner: postgres
--

CREATE INDEX ix_credits_client_date ON public.credits USING btree (client_id, created_at);


--
-- TOC entry 4017 (class 1259 OID 18597)
-- Name: ix_credits_driver; Type: INDEX; Schema: public; Owner: postgres
--

CREATE INDEX ix_credits_driver ON public.credits USING btree (driver_id);


--
-- TOC entry 4018 (class 1259 OID 18598)
-- Name: ix_credits_sector; Type: INDEX; Schema: public; Owner: postgres
--

CREATE INDEX ix_credits_sector ON public.credits USING btree (sector_id);


--
-- TOC entry 4019 (class 1259 OID 18599)
-- Name: ix_credits_status_client; Type: INDEX; Schema: public; Owner: postgres
--

CREATE INDEX ix_credits_status_client ON public.credits USING btree (status, client_id);


--
-- TOC entry 4095 (class 1259 OID 18600)
-- Name: ix_payments_credit; Type: INDEX; Schema: public; Owner: postgres
--

CREATE INDEX ix_payments_credit ON public.payments USING btree (credit_id);


--
-- TOC entry 4096 (class 1259 OID 18601)
-- Name: ix_payments_date; Type: INDEX; Schema: public; Owner: postgres
--

CREATE INDEX ix_payments_date ON public.payments USING btree (payment_timestamp);


--
-- TOC entry 4097 (class 1259 OID 18602)
-- Name: ix_payments_user; Type: INDEX; Schema: public; Owner: postgres
--

CREATE INDEX ix_payments_user ON public.payments USING btree (user_id);


--
-- TOC entry 4065 (class 1259 OID 18603)
-- Name: ix_sales_client; Type: INDEX; Schema: public; Owner: postgres
--

CREATE INDEX ix_sales_client ON public.sales USING btree (client_id);


--
-- TOC entry 4066 (class 1259 OID 18604)
-- Name: ix_sales_client_date; Type: INDEX; Schema: public; Owner: postgres
--

CREATE INDEX ix_sales_client_date ON public.sales USING btree (client_id, sale_timestamp);


--
-- TOC entry 4067 (class 1259 OID 18605)
-- Name: ix_sales_date; Type: INDEX; Schema: public; Owner: postgres
--

CREATE INDEX ix_sales_date ON public.sales USING btree (sale_timestamp);


--
-- TOC entry 4068 (class 1259 OID 18606)
-- Name: ix_sales_driver; Type: INDEX; Schema: public; Owner: postgres
--

CREATE INDEX ix_sales_driver ON public.sales USING btree (driver_id);


--
-- TOC entry 4069 (class 1259 OID 18607)
-- Name: ix_sales_driver_date; Type: INDEX; Schema: public; Owner: postgres
--

CREATE INDEX ix_sales_driver_date ON public.sales USING btree (driver_id, sale_timestamp);


--
-- TOC entry 4070 (class 1259 OID 18608)
-- Name: ix_sales_sector; Type: INDEX; Schema: public; Owner: postgres
--

CREATE INDEX ix_sales_sector ON public.sales USING btree (sector_id);


--
-- TOC entry 4071 (class 1259 OID 18609)
-- Name: ix_sales_sector_date; Type: INDEX; Schema: public; Owner: postgres
--

CREATE INDEX ix_sales_sector_date ON public.sales USING btree (sector_id, sale_timestamp);


--
-- TOC entry 4131 (class 1259 OID 18610)
-- Name: ix_sector_drivers_driver; Type: INDEX; Schema: public; Owner: postgres
--

CREATE INDEX ix_sector_drivers_driver ON public.sector_drivers USING btree (driver_id);


--
-- TOC entry 4136 (class 1259 OID 18611)
-- Name: ix_sectors_client; Type: INDEX; Schema: public; Owner: postgres
--

CREATE INDEX ix_sectors_client ON public.sectors USING btree (client_id);


--
-- TOC entry 3998 (class 1259 OID 18612)
-- Name: uq_client_product_period_active; Type: INDEX; Schema: public; Owner: postgres
--

CREATE UNIQUE INDEX uq_client_product_period_active ON public.client_product_gallon_limits USING btree (client_id, product_id, period_kind) WHERE (is_active = true);


--
-- TOC entry 4134 (class 1259 OID 18613)
-- Name: uq_sector_driver_open; Type: INDEX; Schema: public; Owner: postgres
--

CREATE UNIQUE INDEX uq_sector_driver_open ON public.sector_drivers USING btree (sector_id, driver_id) WHERE (end_date IS NULL);


--
-- TOC entry 4135 (class 1259 OID 18614)
-- Name: uq_sector_drivers_open; Type: INDEX; Schema: public; Owner: postgres
--

CREATE UNIQUE INDEX uq_sector_drivers_open ON public.sector_drivers USING btree (sector_id, driver_id) WHERE (end_date IS NULL);


--
-- TOC entry 4177 (class 1259 OID 18615)
-- Name: users_username_lower_uidx; Type: INDEX; Schema: public; Owner: postgres
--

CREATE UNIQUE INDEX users_username_lower_uidx ON public.users USING btree (lower((username)::text));


--
-- TOC entry 3975 (class 1259 OID 18616)
-- Name: ux_cash_box_open_one_per_day; Type: INDEX; Schema: public; Owner: postgres
--

CREATE UNIQUE INDEX ux_cash_box_open_one_per_day ON public.cash_box_sessions USING btree (day_date) WHERE (is_closed = false);


--
-- TOC entry 4100 (class 1259 OID 18617)
-- Name: ux_payments_antidouble; Type: INDEX; Schema: public; Owner: postgres
--

CREATE UNIQUE INDEX ux_payments_antidouble ON public.payments USING btree (credit_id, user_id, amount, date_trunc('second'::text, payment_timestamp)) WHERE ((status)::text = 'completed'::text);


--
-- TOC entry 4101 (class 1259 OID 18618)
-- Name: ux_payments_request_key; Type: INDEX; Schema: public; Owner: postgres
--

CREATE UNIQUE INDEX ux_payments_request_key ON public.payments USING btree (request_key);


--
-- TOC entry 4123 (class 1259 OID 18619)
-- Name: ux_pl_doc_unique; Type: INDEX; Schema: public; Owner: postgres
--

CREATE UNIQUE INDEX ux_pl_doc_unique ON public.purchase_lines USING btree (supplier_id, doc_type_code, series, doc_number) WHERE (line_type = 'HEADER'::public.purchase_line_type);


--
-- TOC entry 4139 (class 1259 OID 18620)
-- Name: ux_sectors_client_name; Type: INDEX; Schema: public; Owner: postgres
--

CREATE UNIQUE INDEX ux_sectors_client_name ON public.sectors USING btree (client_id, lower(name));


--
-- TOC entry 4255 (class 2620 OID 18621)
-- Name: credits copy_driver_to_credit; Type: TRIGGER; Schema: public; Owner: postgres
--

CREATE TRIGGER copy_driver_to_credit BEFORE INSERT ON public.credits FOR EACH ROW EXECUTE FUNCTION public.trg_copy_driver_to_credit();


--
-- TOC entry 4256 (class 2620 OID 18622)
-- Name: credits set_driver_from_sale; Type: TRIGGER; Schema: public; Owner: postgres
--

CREATE TRIGGER set_driver_from_sale BEFORE INSERT ON public.credits FOR EACH ROW EXECUTE FUNCTION public.trg_credits_set_driver_from_sale();


--
-- TOC entry 4250 (class 2620 OID 18623)
-- Name: ap_payments t_ap_payments_aiud; Type: TRIGGER; Schema: public; Owner: postgres
--

CREATE TRIGGER t_ap_payments_aiud AFTER INSERT OR DELETE OR UPDATE ON public.ap_payments FOR EACH ROW EXECUTE FUNCTION public.trg_recalc_ap_after_change();


--
-- TOC entry 4270 (class 2620 OID 18624)
-- Name: purchase_attachments t_purchase_attachments_aiud; Type: TRIGGER; Schema: public; Owner: postgres
--

CREATE TRIGGER t_purchase_attachments_aiud AFTER INSERT OR DELETE ON public.purchase_attachments FOR EACH ROW EXECUTE FUNCTION public.trg_bump_attachment_count();


--
-- TOC entry 4271 (class 2620 OID 18625)
-- Name: purchase_lines t_purchase_header_create_bill; Type: TRIGGER; Schema: public; Owner: postgres
--

CREATE TRIGGER t_purchase_header_create_bill AFTER INSERT ON public.purchase_lines FOR EACH ROW EXECUTE FUNCTION public.trg_create_ap_bill_after_header();


--
-- TOC entry 4272 (class 2620 OID 18626)
-- Name: purchase_lines t_purchase_items_recalc; Type: TRIGGER; Schema: public; Owner: postgres
--

CREATE TRIGGER t_purchase_items_recalc AFTER INSERT OR DELETE OR UPDATE ON public.purchase_lines FOR EACH ROW EXECUTE FUNCTION public.trg_recalc_purchase_items_aiud();


--
-- TOC entry 4273 (class 2620 OID 18627)
-- Name: purchase_lines t_purchase_lines_updated_at; Type: TRIGGER; Schema: public; Owner: postgres
--

CREATE TRIGGER t_purchase_lines_updated_at BEFORE UPDATE ON public.purchase_lines FOR EACH ROW EXECUTE FUNCTION public.trg_set_updated_at();


--
-- TOC entry 4274 (class 2620 OID 18628)
-- Name: purchase_receipt_lines t_receipt_lines_aiud; Type: TRIGGER; Schema: public; Owner: postgres
--

CREATE TRIGGER t_receipt_lines_aiud AFTER INSERT OR DELETE OR UPDATE ON public.purchase_receipt_lines FOR EACH ROW EXECUTE FUNCTION public.trg_recalc_received_after_aiud();


--
-- TOC entry 4275 (class 2620 OID 18629)
-- Name: purchase_receipt_lines t_validate_receipt_qty_biud; Type: TRIGGER; Schema: public; Owner: postgres
--

CREATE TRIGGER t_validate_receipt_qty_biud BEFORE INSERT OR DELETE OR UPDATE ON public.purchase_receipt_lines FOR EACH ROW EXECUTE FUNCTION public.trg_validate_receipt_qty();


--
-- TOC entry 4251 (class 2620 OID 18630)
-- Name: client_drivers trg_client_drivers_check_company; Type: TRIGGER; Schema: public; Owner: postgres
--

CREATE TRIGGER trg_client_drivers_check_company BEFORE INSERT OR UPDATE OF company_id ON public.client_drivers FOR EACH ROW EXECUTE FUNCTION public.enforce_company_is_empresa();


--
-- TOC entry 4252 (class 2620 OID 18631)
-- Name: client_drivers trg_client_drivers_sector_company_check; Type: TRIGGER; Schema: public; Owner: postgres
--

CREATE TRIGGER trg_client_drivers_sector_company_check BEFORE INSERT OR UPDATE OF sector_id, company_id ON public.client_drivers FOR EACH ROW WHEN ((new.sector_id IS NOT NULL)) EXECUTE FUNCTION public.ensure_sector_driver_company_match();


--
-- TOC entry 4253 (class 2620 OID 18632)
-- Name: client_drivers trg_client_drivers_touch; Type: TRIGGER; Schema: public; Owner: postgres
--

CREATE TRIGGER trg_client_drivers_touch BEFORE UPDATE ON public.client_drivers FOR EACH ROW EXECUTE FUNCTION public.touch_updated_at();


--
-- TOC entry 4254 (class 2620 OID 18633)
-- Name: client_product_gallon_limits trg_cpg_limits_updated_at; Type: TRIGGER; Schema: public; Owner: postgres
--

CREATE TRIGGER trg_cpg_limits_updated_at BEFORE UPDATE ON public.client_product_gallon_limits FOR EACH ROW EXECUTE FUNCTION public.set_updated_at();


--
-- TOC entry 4257 (class 2620 OID 18634)
-- Name: credits trg_credit_driver_company; Type: TRIGGER; Schema: public; Owner: postgres
--

CREATE TRIGGER trg_credit_driver_company BEFORE INSERT OR UPDATE OF driver_id, client_id ON public.credits FOR EACH ROW EXECUTE FUNCTION public.enforce_credit_driver_company();


--
-- TOC entry 4265 (class 2620 OID 18635)
-- Name: sale_details trg_enforce_product_rules; Type: TRIGGER; Schema: public; Owner: postgres
--

CREATE TRIGGER trg_enforce_product_rules BEFORE INSERT OR UPDATE ON public.sale_details FOR EACH ROW EXECUTE FUNCTION public.fn_enforce_product_rules_on_sale_details();

ALTER TABLE public.sale_details DISABLE TRIGGER trg_enforce_product_rules;


--
-- TOC entry 4279 (class 2620 OID 18636)
-- Name: users trg_enforce_username_lower; Type: TRIGGER; Schema: public; Owner: postgres
--

CREATE TRIGGER trg_enforce_username_lower BEFORE INSERT OR UPDATE ON public.users FOR EACH ROW EXECUTE FUNCTION public.enforce_username_lower();


--
-- TOC entry 4280 (class 2620 OID 18637)
-- Name: users trg_guard_last_admin_del; Type: TRIGGER; Schema: public; Owner: postgres
--

CREATE TRIGGER trg_guard_last_admin_del BEFORE DELETE ON public.users FOR EACH ROW EXECUTE FUNCTION public.guard_last_active_admin();


--
-- TOC entry 4281 (class 2620 OID 18638)
-- Name: users trg_guard_last_admin_upd; Type: TRIGGER; Schema: public; Owner: postgres
--

CREATE TRIGGER trg_guard_last_admin_upd BEFORE UPDATE ON public.users FOR EACH ROW EXECUTE FUNCTION public.guard_last_active_admin();


--
-- TOC entry 4268 (class 2620 OID 18639)
-- Name: payments trg_payments_apply; Type: TRIGGER; Schema: public; Owner: postgres
--

CREATE TRIGGER trg_payments_apply AFTER INSERT ON public.payments FOR EACH ROW EXECUTE FUNCTION public.fn_payments_apply_to_credit();

ALTER TABLE public.payments DISABLE TRIGGER trg_payments_apply;


--
-- TOC entry 4269 (class 2620 OID 18640)
-- Name: payments trg_payments_credit_guard; Type: TRIGGER; Schema: public; Owner: postgres
--

CREATE TRIGGER trg_payments_credit_guard AFTER INSERT ON public.payments FOR EACH ROW EXECUTE FUNCTION public.enforce_credit_payment_limits();

ALTER TABLE public.payments DISABLE TRIGGER trg_payments_credit_guard;


--
-- TOC entry 4266 (class 2620 OID 18641)
-- Name: sale_details trg_sale_details_client_product_gallon_guard; Type: TRIGGER; Schema: public; Owner: postgres
--

CREATE TRIGGER trg_sale_details_client_product_gallon_guard AFTER INSERT ON public.sale_details FOR EACH ROW EXECUTE FUNCTION public.enforce_client_product_gallon_limit();

ALTER TABLE public.sale_details DISABLE TRIGGER trg_sale_details_client_product_gallon_guard;


--
-- TOC entry 4267 (class 2620 OID 18642)
-- Name: sale_details trg_sale_details_credit_gallon_guard; Type: TRIGGER; Schema: public; Owner: postgres
--

CREATE TRIGGER trg_sale_details_credit_gallon_guard AFTER INSERT ON public.sale_details FOR EACH ROW EXECUTE FUNCTION public.enforce_credit_gallon_limit();

ALTER TABLE public.sale_details DISABLE TRIGGER trg_sale_details_credit_gallon_guard;


--
-- TOC entry 4258 (class 2620 OID 18643)
-- Name: sales trg_sales_check_driver_company; Type: TRIGGER; Schema: public; Owner: postgres
--

CREATE TRIGGER trg_sales_check_driver_company BEFORE INSERT OR UPDATE OF client_id, driver_id ON public.sales FOR EACH ROW EXECUTE FUNCTION public.enforce_sale_driver_company();


--
-- TOC entry 4259 (class 2620 OID 18644)
-- Name: sales trg_sales_require_sector; Type: TRIGGER; Schema: public; Owner: postgres
--

CREATE TRIGGER trg_sales_require_sector BEFORE INSERT OR UPDATE ON public.sales FOR EACH ROW EXECUTE FUNCTION public.fn_sales_require_sector_when_client_has_sectors();

ALTER TABLE public.sales DISABLE TRIGGER trg_sales_require_sector;


--
-- TOC entry 4260 (class 2620 OID 18645)
-- Name: sales trg_sales_sector_client; Type: TRIGGER; Schema: public; Owner: postgres
--

CREATE TRIGGER trg_sales_sector_client BEFORE INSERT OR UPDATE OF client_id, sector_id ON public.sales FOR EACH ROW EXECUTE FUNCTION public.ensure_sector_matches_sale_client();

ALTER TABLE public.sales DISABLE TRIGGER trg_sales_sector_client;


--
-- TOC entry 4261 (class 2620 OID 18646)
-- Name: sales trg_sales_set_employee_from_user; Type: TRIGGER; Schema: public; Owner: postgres
--

CREATE TRIGGER trg_sales_set_employee_from_user BEFORE INSERT ON public.sales FOR EACH ROW EXECUTE FUNCTION public.sales_set_employee_from_user();


--
-- TOC entry 4262 (class 2620 OID 18647)
-- Name: sales trg_sales_validate_relations; Type: TRIGGER; Schema: public; Owner: postgres
--

CREATE TRIGGER trg_sales_validate_relations BEFORE INSERT OR UPDATE ON public.sales FOR EACH ROW EXECUTE FUNCTION public.fn_sales_validate_relations();


--
-- TOC entry 4263 (class 2620 OID 18648)
-- Name: sales trg_sales_validate_sector; Type: TRIGGER; Schema: public; Owner: postgres
--

CREATE TRIGGER trg_sales_validate_sector BEFORE INSERT OR UPDATE ON public.sales FOR EACH ROW WHEN ((new.sector_id IS NOT NULL)) EXECUTE FUNCTION public.ensure_sector_matches_sale_client();

ALTER TABLE public.sales DISABLE TRIGGER trg_sales_validate_sector;


--
-- TOC entry 4276 (class 2620 OID 18649)
-- Name: sector_drivers trg_sector_driver_company; Type: TRIGGER; Schema: public; Owner: postgres
--

CREATE TRIGGER trg_sector_driver_company BEFORE INSERT OR UPDATE ON public.sector_drivers FOR EACH ROW EXECUTE FUNCTION public.ensure_sector_driver_company_match();


--
-- TOC entry 4277 (class 2620 OID 18650)
-- Name: sector_drivers trg_sector_drivers_company; Type: TRIGGER; Schema: public; Owner: postgres
--

CREATE TRIGGER trg_sector_drivers_company BEFORE INSERT OR UPDATE OF sector_id, driver_id, start_date, end_date ON public.sector_drivers FOR EACH ROW EXECUTE FUNCTION public.ensure_sector_driver_company_match();


--
-- TOC entry 4278 (class 2620 OID 18651)
-- Name: sectors trg_sectors_biu_touch; Type: TRIGGER; Schema: public; Owner: postgres
--

CREATE TRIGGER trg_sectors_biu_touch BEFORE INSERT OR UPDATE ON public.sectors FOR EACH ROW EXECUTE FUNCTION public.trg_sectors_touch_updated_at();


--
-- TOC entry 4264 (class 2620 OID 18652)
-- Name: sales trg_sync_sales_user_employee; Type: TRIGGER; Schema: public; Owner: postgres
--

CREATE TRIGGER trg_sync_sales_user_employee BEFORE INSERT OR UPDATE ON public.sales FOR EACH ROW EXECUTE FUNCTION public.sync_sales_user_employee();


--
-- TOC entry 4282 (class 2620 OID 18653)
-- Name: users trigger_validate_role_hierarchy; Type: TRIGGER; Schema: public; Owner: postgres
--

CREATE TRIGGER trigger_validate_role_hierarchy BEFORE INSERT OR UPDATE ON public.users FOR EACH ROW EXECUTE FUNCTION public.validate_role_hierarchy();


--
-- TOC entry 4183 (class 2606 OID 18654)
-- Name: cash_registers cash_registers_closed_by_fkey; Type: FK CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.cash_registers
    ADD CONSTRAINT cash_registers_closed_by_fkey FOREIGN KEY (closed_by) REFERENCES public.users(user_id);


--
-- TOC entry 4184 (class 2606 OID 18659)
-- Name: cash_registers cash_registers_opened_by_fkey; Type: FK CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.cash_registers
    ADD CONSTRAINT cash_registers_opened_by_fkey FOREIGN KEY (opened_by) REFERENCES public.users(user_id);


--
-- TOC entry 4185 (class 2606 OID 18664)
-- Name: cash_registers cash_registers_shift_id_fkey; Type: FK CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.cash_registers
    ADD CONSTRAINT cash_registers_shift_id_fkey FOREIGN KEY (shift_id) REFERENCES public.shifts(id);


--
-- TOC entry 4186 (class 2606 OID 18669)
-- Name: client_credit_limits client_credit_limits_client_id_fkey; Type: FK CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.client_credit_limits
    ADD CONSTRAINT client_credit_limits_client_id_fkey FOREIGN KEY (client_id) REFERENCES public.clients(client_id);


--
-- TOC entry 4187 (class 2606 OID 18674)
-- Name: client_drivers client_drivers_company_fk; Type: FK CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.client_drivers
    ADD CONSTRAINT client_drivers_company_fk FOREIGN KEY (company_id) REFERENCES public.clients(client_id) ON DELETE CASCADE;


--
-- TOC entry 4188 (class 2606 OID 18679)
-- Name: client_drivers client_drivers_sector_id_fkey; Type: FK CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.client_drivers
    ADD CONSTRAINT client_drivers_sector_id_fkey FOREIGN KEY (sector_id) REFERENCES public.sectors(sector_id);


--
-- TOC entry 4189 (class 2606 OID 18684)
-- Name: client_product_gallon_limits client_product_gallon_limits_client_id_fkey; Type: FK CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.client_product_gallon_limits
    ADD CONSTRAINT client_product_gallon_limits_client_id_fkey FOREIGN KEY (client_id) REFERENCES public.clients(client_id);


--
-- TOC entry 4190 (class 2606 OID 18689)
-- Name: client_product_gallon_limits client_product_gallon_limits_product_id_fkey; Type: FK CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.client_product_gallon_limits
    ADD CONSTRAINT client_product_gallon_limits_product_id_fkey FOREIGN KEY (product_id) REFERENCES public.products(product_id);


--
-- TOC entry 4248 (class 2606 OID 19902)
-- Name: client_product_rules client_product_rules_client_id_fkey; Type: FK CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.client_product_rules
    ADD CONSTRAINT client_product_rules_client_id_fkey FOREIGN KEY (client_id) REFERENCES public.clients(client_id) ON DELETE CASCADE;


--
-- TOC entry 4249 (class 2606 OID 19907)
-- Name: client_product_rules client_product_rules_product_id_fkey; Type: FK CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.client_product_rules
    ADD CONSTRAINT client_product_rules_product_id_fkey FOREIGN KEY (product_id) REFERENCES public.products(product_id) ON DELETE CASCADE;


--
-- TOC entry 4191 (class 2606 OID 18694)
-- Name: credits credits_client_id_fkey; Type: FK CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.credits
    ADD CONSTRAINT credits_client_id_fkey FOREIGN KEY (client_id) REFERENCES public.clients(client_id);


--
-- TOC entry 4192 (class 2606 OID 18699)
-- Name: credits credits_driver_fk; Type: FK CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.credits
    ADD CONSTRAINT credits_driver_fk FOREIGN KEY (driver_id) REFERENCES public.client_drivers(driver_id) ON DELETE SET NULL;


--
-- TOC entry 4193 (class 2606 OID 18704)
-- Name: credits credits_sale_id_fkey; Type: FK CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.credits
    ADD CONSTRAINT credits_sale_id_fkey FOREIGN KEY (sale_id) REFERENCES public.sales(sale_id);


--
-- TOC entry 4199 (class 2606 OID 18709)
-- Name: deliveries deliveries_supplier_id_fkey; Type: FK CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.deliveries
    ADD CONSTRAINT deliveries_supplier_id_fkey FOREIGN KEY (supplier_id) REFERENCES public.suppliers(supplier_id);


--
-- TOC entry 4200 (class 2606 OID 18714)
-- Name: deliveries deliveries_user_id_fkey; Type: FK CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.deliveries
    ADD CONSTRAINT deliveries_user_id_fkey FOREIGN KEY (user_id) REFERENCES public.users(user_id);


--
-- TOC entry 4201 (class 2606 OID 18719)
-- Name: delivery_details delivery_details_delivery_id_fkey; Type: FK CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.delivery_details
    ADD CONSTRAINT delivery_details_delivery_id_fkey FOREIGN KEY (delivery_id) REFERENCES public.deliveries(delivery_id);


--
-- TOC entry 4202 (class 2606 OID 18724)
-- Name: delivery_details delivery_details_product_id_fkey; Type: FK CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.delivery_details
    ADD CONSTRAINT delivery_details_product_id_fkey FOREIGN KEY (product_id) REFERENCES public.products(product_id);


--
-- TOC entry 4203 (class 2606 OID 18729)
-- Name: delivery_details delivery_details_tank_id_fkey; Type: FK CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.delivery_details
    ADD CONSTRAINT delivery_details_tank_id_fkey FOREIGN KEY (tank_id) REFERENCES public.tanks(tank_id);


--
-- TOC entry 4204 (class 2606 OID 18734)
-- Name: expenses expenses_category_id_fkey; Type: FK CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.expenses
    ADD CONSTRAINT expenses_category_id_fkey FOREIGN KEY (category_id) REFERENCES public.expense_categories(category_id);


--
-- TOC entry 4205 (class 2606 OID 18739)
-- Name: expenses expenses_payment_method_id_fkey; Type: FK CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.expenses
    ADD CONSTRAINT expenses_payment_method_id_fkey FOREIGN KEY (payment_method_id) REFERENCES public.payment_methods(payment_method_id);


--
-- TOC entry 4206 (class 2606 OID 18744)
-- Name: expenses expenses_user_id_fkey; Type: FK CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.expenses
    ADD CONSTRAINT expenses_user_id_fkey FOREIGN KEY (user_id) REFERENCES public.users(user_id);


--
-- TOC entry 4182 (class 2606 OID 18749)
-- Name: backup_history fk_backup_history_user; Type: FK CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.backup_history
    ADD CONSTRAINT fk_backup_history_user FOREIGN KEY (user_id) REFERENCES public.users(user_id) ON DELETE CASCADE;


--
-- TOC entry 4194 (class 2606 OID 18754)
-- Name: credits fk_credits_client; Type: FK CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.credits
    ADD CONSTRAINT fk_credits_client FOREIGN KEY (client_id) REFERENCES public.clients(client_id);


--
-- TOC entry 4195 (class 2606 OID 18759)
-- Name: credits fk_credits_company_driver; Type: FK CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.credits
    ADD CONSTRAINT fk_credits_company_driver FOREIGN KEY (company_driver_id) REFERENCES public.client_drivers(driver_id) ON DELETE SET NULL;


--
-- TOC entry 4196 (class 2606 OID 18764)
-- Name: credits fk_credits_driver; Type: FK CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.credits
    ADD CONSTRAINT fk_credits_driver FOREIGN KEY (driver_id) REFERENCES public.client_drivers(driver_id);


--
-- TOC entry 4197 (class 2606 OID 18769)
-- Name: credits fk_credits_sector; Type: FK CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.credits
    ADD CONSTRAINT fk_credits_sector FOREIGN KEY (sector_id) REFERENCES public.sectors(sector_id);


--
-- TOC entry 4198 (class 2606 OID 18774)
-- Name: credits fk_credits_sector_id; Type: FK CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.credits
    ADD CONSTRAINT fk_credits_sector_id FOREIGN KEY (sector_id) REFERENCES public.sectors(sector_id) ON DELETE SET NULL;


--
-- TOC entry 4223 (class 2606 OID 18779)
-- Name: nozzles fk_nozzles_dispensers; Type: FK CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.nozzles
    ADD CONSTRAINT fk_nozzles_dispensers FOREIGN KEY (dispenser_id) REFERENCES public.dispensers(dispenser_id);


--
-- TOC entry 4231 (class 2606 OID 18784)
-- Name: pump_tank fk_pump; Type: FK CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.pump_tank
    ADD CONSTRAINT fk_pump FOREIGN KEY (pump_id) REFERENCES public.pumps(pump_id) ON DELETE CASCADE;


--
-- TOC entry 4210 (class 2606 OID 18789)
-- Name: sales fk_sales_client; Type: FK CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.sales
    ADD CONSTRAINT fk_sales_client FOREIGN KEY (client_id) REFERENCES public.clients(client_id);


--
-- TOC entry 4211 (class 2606 OID 18794)
-- Name: sales fk_sales_driver; Type: FK CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.sales
    ADD CONSTRAINT fk_sales_driver FOREIGN KEY (driver_id) REFERENCES public.client_drivers(driver_id);


--
-- TOC entry 4212 (class 2606 OID 18799)
-- Name: sales fk_sales_sector; Type: FK CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.sales
    ADD CONSTRAINT fk_sales_sector FOREIGN KEY (sector_id) REFERENCES public.sectors(sector_id);


--
-- TOC entry 4213 (class 2606 OID 18804)
-- Name: sales fk_sales_sector_id; Type: FK CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.sales
    ADD CONSTRAINT fk_sales_sector_id FOREIGN KEY (sector_id) REFERENCES public.sectors(sector_id) ON DELETE SET NULL;


--
-- TOC entry 4232 (class 2606 OID 18809)
-- Name: pump_tank fk_tank; Type: FK CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.pump_tank
    ADD CONSTRAINT fk_tank FOREIGN KEY (tank_id) REFERENCES public.tanks(tank_id) ON DELETE CASCADE;


--
-- TOC entry 4207 (class 2606 OID 18814)
-- Name: landed_cost_allocation_lines landed_cost_allocation_lines_allocation_id_fkey; Type: FK CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.landed_cost_allocation_lines
    ADD CONSTRAINT landed_cost_allocation_lines_allocation_id_fkey FOREIGN KEY (allocation_id) REFERENCES public.landed_cost_allocations(allocation_id) ON DELETE CASCADE;


--
-- TOC entry 4208 (class 2606 OID 18819)
-- Name: meter_readings meter_readings_nozzle_id_fkey; Type: FK CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.meter_readings
    ADD CONSTRAINT meter_readings_nozzle_id_fkey FOREIGN KEY (nozzle_id) REFERENCES public.nozzles(nozzle_id) ON DELETE CASCADE;


--
-- TOC entry 4209 (class 2606 OID 18824)
-- Name: meter_readings meter_readings_user_id_fkey; Type: FK CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.meter_readings
    ADD CONSTRAINT meter_readings_user_id_fkey FOREIGN KEY (user_id) REFERENCES public.users(user_id) ON DELETE SET NULL;


--
-- TOC entry 4224 (class 2606 OID 18829)
-- Name: nozzles nozzles_product_id_fkey; Type: FK CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.nozzles
    ADD CONSTRAINT nozzles_product_id_fkey FOREIGN KEY (product_id) REFERENCES public.products(product_id);


--
-- TOC entry 4225 (class 2606 OID 18834)
-- Name: nozzles nozzles_pump_id_fkey; Type: FK CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.nozzles
    ADD CONSTRAINT nozzles_pump_id_fkey FOREIGN KEY (pump_id) REFERENCES public.pumps(pump_id);


--
-- TOC entry 4226 (class 2606 OID 18839)
-- Name: nozzles nozzles_tank_id_fkey; Type: FK CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.nozzles
    ADD CONSTRAINT nozzles_tank_id_fkey FOREIGN KEY (tank_id) REFERENCES public.tanks(tank_id);


--
-- TOC entry 4227 (class 2606 OID 18844)
-- Name: payments payments_credit_id_fkey; Type: FK CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.payments
    ADD CONSTRAINT payments_credit_id_fkey FOREIGN KEY (credit_id) REFERENCES public.credits(credit_id);


--
-- TOC entry 4228 (class 2606 OID 18849)
-- Name: payments payments_payment_method_id_fkey; Type: FK CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.payments
    ADD CONSTRAINT payments_payment_method_id_fkey FOREIGN KEY (payment_method_id) REFERENCES public.payment_methods(payment_method_id);


--
-- TOC entry 4229 (class 2606 OID 18854)
-- Name: payments payments_sale_id_fkey; Type: FK CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.payments
    ADD CONSTRAINT payments_sale_id_fkey FOREIGN KEY (sale_id) REFERENCES public.sales(sale_id);


--
-- TOC entry 4230 (class 2606 OID 18859)
-- Name: payments payments_user_id_fkey; Type: FK CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.payments
    ADD CONSTRAINT payments_user_id_fkey FOREIGN KEY (user_id) REFERENCES public.users(user_id);


--
-- TOC entry 4233 (class 2606 OID 18864)
-- Name: purchase_receipt_lines purchase_receipt_lines_receipt_id_fkey; Type: FK CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.purchase_receipt_lines
    ADD CONSTRAINT purchase_receipt_lines_receipt_id_fkey FOREIGN KEY (receipt_id) REFERENCES public.purchase_receipts(receipt_id) ON DELETE CASCADE;


--
-- TOC entry 4221 (class 2606 OID 18869)
-- Name: sale_details sale_details_product_id_fkey; Type: FK CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.sale_details
    ADD CONSTRAINT sale_details_product_id_fkey FOREIGN KEY (product_id) REFERENCES public.products(product_id);


--
-- TOC entry 4222 (class 2606 OID 18874)
-- Name: sale_details sale_details_sale_id_fkey; Type: FK CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.sale_details
    ADD CONSTRAINT sale_details_sale_id_fkey FOREIGN KEY (sale_id) REFERENCES public.sales(sale_id);


--
-- TOC entry 4214 (class 2606 OID 18879)
-- Name: sales sales_client_id_fkey; Type: FK CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.sales
    ADD CONSTRAINT sales_client_id_fkey FOREIGN KEY (client_id) REFERENCES public.clients(client_id);


--
-- TOC entry 4215 (class 2606 OID 18884)
-- Name: sales sales_driver_fk; Type: FK CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.sales
    ADD CONSTRAINT sales_driver_fk FOREIGN KEY (driver_id) REFERENCES public.client_drivers(driver_id) ON DELETE SET NULL;


--
-- TOC entry 4216 (class 2606 OID 18889)
-- Name: sales sales_employee_id_fkey; Type: FK CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.sales
    ADD CONSTRAINT sales_employee_id_fkey FOREIGN KEY (employee_id) REFERENCES public.employees(employee_id);


--
-- TOC entry 4217 (class 2606 OID 18894)
-- Name: sales sales_nozzle_id_fkey; Type: FK CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.sales
    ADD CONSTRAINT sales_nozzle_id_fkey FOREIGN KEY (nozzle_id) REFERENCES public.nozzles(nozzle_id);


--
-- TOC entry 4218 (class 2606 OID 18899)
-- Name: sales sales_payment_method_id_fkey; Type: FK CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.sales
    ADD CONSTRAINT sales_payment_method_id_fkey FOREIGN KEY (payment_method_id) REFERENCES public.payment_methods(payment_method_id);


--
-- TOC entry 4219 (class 2606 OID 18904)
-- Name: sales sales_sector_id_fkey; Type: FK CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.sales
    ADD CONSTRAINT sales_sector_id_fkey FOREIGN KEY (sector_id) REFERENCES public.sectors(sector_id);


--
-- TOC entry 4220 (class 2606 OID 18909)
-- Name: sales sales_user_id_fkey; Type: FK CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.sales
    ADD CONSTRAINT sales_user_id_fkey FOREIGN KEY (user_id) REFERENCES public.users(user_id);


--
-- TOC entry 4234 (class 2606 OID 18914)
-- Name: sector_drivers sector_drivers_driver_id_fkey; Type: FK CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.sector_drivers
    ADD CONSTRAINT sector_drivers_driver_id_fkey FOREIGN KEY (driver_id) REFERENCES public.client_drivers(driver_id) ON DELETE CASCADE;


--
-- TOC entry 4235 (class 2606 OID 18919)
-- Name: sector_drivers sector_drivers_sector_id_fkey; Type: FK CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.sector_drivers
    ADD CONSTRAINT sector_drivers_sector_id_fkey FOREIGN KEY (sector_id) REFERENCES public.sectors(sector_id) ON DELETE CASCADE;


--
-- TOC entry 4236 (class 2606 OID 18924)
-- Name: sectors sectors_client_id_fkey; Type: FK CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.sectors
    ADD CONSTRAINT sectors_client_id_fkey FOREIGN KEY (client_id) REFERENCES public.clients(client_id) ON DELETE CASCADE;


--
-- TOC entry 4237 (class 2606 OID 18929)
-- Name: shifts shifts_closed_by_fkey; Type: FK CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.shifts
    ADD CONSTRAINT shifts_closed_by_fkey FOREIGN KEY (closed_by) REFERENCES public.users(user_id);


--
-- TOC entry 4238 (class 2606 OID 18934)
-- Name: shifts shifts_opened_by_fkey; Type: FK CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.shifts
    ADD CONSTRAINT shifts_opened_by_fkey FOREIGN KEY (opened_by) REFERENCES public.users(user_id);


--
-- TOC entry 4239 (class 2606 OID 18939)
-- Name: stock_movements stock_movements_delivery_detail_id_fkey; Type: FK CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.stock_movements
    ADD CONSTRAINT stock_movements_delivery_detail_id_fkey FOREIGN KEY (delivery_detail_id) REFERENCES public.delivery_details(delivery_detail_id);


--
-- TOC entry 4240 (class 2606 OID 18944)
-- Name: stock_movements stock_movements_product_id_fkey; Type: FK CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.stock_movements
    ADD CONSTRAINT stock_movements_product_id_fkey FOREIGN KEY (product_id) REFERENCES public.products(product_id);


--
-- TOC entry 4241 (class 2606 OID 18949)
-- Name: stock_movements stock_movements_sale_detail_id_fkey; Type: FK CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.stock_movements
    ADD CONSTRAINT stock_movements_sale_detail_id_fkey FOREIGN KEY (sale_detail_id) REFERENCES public.sale_details(sale_detail_id);


--
-- TOC entry 4242 (class 2606 OID 18954)
-- Name: stock_movements stock_movements_tank_id_fkey; Type: FK CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.stock_movements
    ADD CONSTRAINT stock_movements_tank_id_fkey FOREIGN KEY (tank_id) REFERENCES public.tanks(tank_id);


--
-- TOC entry 4243 (class 2606 OID 18959)
-- Name: stock_movements stock_movements_user_id_fkey; Type: FK CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.stock_movements
    ADD CONSTRAINT stock_movements_user_id_fkey FOREIGN KEY (user_id) REFERENCES public.users(user_id);


--
-- TOC entry 4244 (class 2606 OID 18964)
-- Name: tanks tanks_product_id_fkey; Type: FK CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.tanks
    ADD CONSTRAINT tanks_product_id_fkey FOREIGN KEY (product_id) REFERENCES public.products(product_id);


--
-- TOC entry 4245 (class 2606 OID 18969)
-- Name: user_audit_logs user_audit_logs_performed_by_fkey; Type: FK CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.user_audit_logs
    ADD CONSTRAINT user_audit_logs_performed_by_fkey FOREIGN KEY (performed_by) REFERENCES public.users(user_id);


--
-- TOC entry 4246 (class 2606 OID 18974)
-- Name: user_audit_logs user_audit_logs_target_user_fkey; Type: FK CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.user_audit_logs
    ADD CONSTRAINT user_audit_logs_target_user_fkey FOREIGN KEY (target_user) REFERENCES public.users(user_id);


--
-- TOC entry 4247 (class 2606 OID 18979)
-- Name: users users_employee_id_fkey; Type: FK CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.users
    ADD CONSTRAINT users_employee_id_fkey FOREIGN KEY (employee_id) REFERENCES public.employees(employee_id);


--
-- TOC entry 4539 (class 0 OID 0)
-- Dependencies: 6
-- Name: SCHEMA public; Type: ACL; Schema: -; Owner: postgres
--

REVOKE USAGE ON SCHEMA public FROM PUBLIC;
GRANT ALL ON SCHEMA public TO PUBLIC;


--
-- TOC entry 4485 (class 0 OID 18095)
-- Dependencies: 254 4535
-- Name: mv_employee_sales_daily; Type: MATERIALIZED VIEW DATA; Schema: public; Owner: postgres
--

REFRESH MATERIALIZED VIEW public.mv_employee_sales_daily;


--
-- TOC entry 4487 (class 0 OID 18108)
-- Dependencies: 256 4535
-- Name: mv_product_sales_by_shift; Type: MATERIALIZED VIEW DATA; Schema: public; Owner: postgres
--

REFRESH MATERIALIZED VIEW public.mv_product_sales_by_shift;


--
-- TOC entry 4488 (class 0 OID 18115)
-- Dependencies: 257 4535
-- Name: mv_product_sales_daily; Type: MATERIALIZED VIEW DATA; Schema: public; Owner: postgres
--

REFRESH MATERIALIZED VIEW public.mv_product_sales_daily;


--
-- TOC entry 4489 (class 0 OID 18122)
-- Dependencies: 258 4535
-- Name: mv_product_sales_monthly; Type: MATERIALIZED VIEW DATA; Schema: public; Owner: postgres
--

REFRESH MATERIALIZED VIEW public.mv_product_sales_monthly;


--
-- TOC entry 4490 (class 0 OID 18129)
-- Dependencies: 259 4535
-- Name: mv_product_sales_weekly; Type: MATERIALIZED VIEW DATA; Schema: public; Owner: postgres
--

REFRESH MATERIALIZED VIEW public.mv_product_sales_weekly;


--
-- TOC entry 4491 (class 0 OID 18136)
-- Dependencies: 260 4535
-- Name: mv_product_sales_yearly; Type: MATERIALIZED VIEW DATA; Schema: public; Owner: postgres
--

REFRESH MATERIALIZED VIEW public.mv_product_sales_yearly;


--
-- TOC entry 4492 (class 0 OID 18143)
-- Dependencies: 261 4535
-- Name: mv_user_sales_daily; Type: MATERIALIZED VIEW DATA; Schema: public; Owner: postgres
--

REFRESH MATERIALIZED VIEW public.mv_user_sales_daily;


-- Completed on 2025-11-11 12:05:15 -05

--
-- PostgreSQL database dump complete
--

\unrestrict zRf0ejhvhm92zEgwh5VWba3JEmlCRGB8hU9aM1cBJuXoCngChqBjukrUvbtQ0qY

